{"version":3,"sources":["block-types/types.js","block-categories/categories.js","contexts/EventsContext.js","editor/format/formatHelpers.js","editor/useCases.js","block-patterns/statement-patterns.js","hooks/utils/useListener.js","block-patterns/operator-patterns.js","compilers/utils/nodeIdentifierRef.js","blocks/State.js","hooks/utils/useControlValue.js","hooks/useReactTooltip.js","utils/makeObservable.js","compilers/MotokoCompiler.js","hooks/utils/useLocalStorage.js","block-patterns/member-patterns.js","editor/blocks.js","blocks/NewArray.js","block-patterns/literal-patterns.js","hooks/utils/useObservableState.js","compilers/Compiler.js","utils/bindNodeInput.js","hooks/persistent/useThemeState.js","utils/isEmbedded.js","utils/getEmbedConfig.js","block-patterns/code-patterns.js","components/rete/controls/CodeControlHandle.js","block-patterns/search-patterns.js","compilers/utils/compileGlobalMotoko.js","hooks/useThemes.js","editor/themes.js","config/configureMonaco.js","components/monaco/CodeEditor.js","editor/format/prettyPrintMotoko.js","components/common/Loading.js","components/common/CopyToClipboardButton.js","components/rete/controls/OutputControlHandle.js","block-patterns/compile-patterns.js","components/rete/controls/SelectControlHandle.js","block-patterns/control-patterns.js","editor sync","blocks/Function.js","blocks/MainParameter.js","examples/examples.js","blocks sync /.js$","blocks/Actor.js","blocks/ActorClass.js","blocks/Add.js","blocks/And.js","blocks/ArrayAppend.js","blocks/ArrayAppended.js","blocks/ArrayFilter.js","blocks/ArrayGet.js","blocks/ArrayMap.js","blocks/ArrayPrepend.js","blocks/ArrayPut.js","blocks/Await.js","blocks/Class.js","blocks/CodeReference.js","blocks/CodeType.js","blocks/CodeValue.js","blocks/CollectionGet.js","blocks/CollectionPut.js","blocks/CollectionSize.js","blocks/CompareEqual.js","blocks/CompareGreater.js","blocks/CompareGreaterEqual.js","blocks/CompareLess.js","blocks/CompareLessEqual.js","blocks/CompareNotEqual.js","blocks/CompileMotoko.js","blocks/CompileType.js","blocks/Conditional.js","blocks/ConditionalValue.js","blocks/Divide.js","blocks/DivideInt.js","blocks/FunctionCall.js","blocks/LiteralBool.js","blocks/LiteralCustomType.js","blocks/LiteralFloat.js","blocks/LiteralIdentifier.js","blocks/LiteralInt.js","blocks/LiteralNat.js","blocks/LiteralPair.js","blocks/LiteralPairType.js","blocks/LiteralText.js","blocks/LiteralTuple.js","blocks/LiteralTupleType.js","blocks/LiteralType.js","blocks/LoopForIntRange.js","blocks/LoopWhile.js","blocks/MainActor.js","blocks/MainParameterRead.js","blocks/MapGet.js","blocks/MapPut.js","blocks/MapRemove.js","blocks/Multiply.js","blocks/NewHashMap.js","blocks/Not.js","blocks/Null.js","blocks/Object.js","blocks/Optional.js","blocks/OptionalUnwrap.js","blocks/Or.js","blocks/Parameter.js","blocks/ReferenceImport.js","blocks/ReferencePathName.js","blocks/Return.js","blocks/SplitPair.js","blocks/StateRead.js","blocks/StateUpdate.js","blocks/Subtract.js","blocks/TextConcat.js","blocks/TextSize.js","blocks/TypeMember.js","blocks/TypeMemberReference.js","blocks/ValueCall.js","blocks/Variable.js","components/global/GlobalTooltip.js","assets/icons/gradient.svg","components/common/menus/TopMenu.js","components/common/menus/MenuItem.js","components/common/menus/MenuButton.js","components/common/FileDropZone.js","contexts/LoadFileContext.js","components/common/MenuModalOption.js","components/editor/LoadProjectModal.js","assets/icons/download.svg","assets/icons/file-plus.svg","assets/icons/folder.svg","assets/icons/folder-wide.svg","assets/icons/folder-open.svg","assets/icons/save.svg","assets/icons/crosshair.svg","assets/icons/learning.svg","assets/icons/settings.svg","components/common/Icon.js","components/common/menus/FloatingMenu.js","hooks/persistent/useLearningModeState.js","hooks/persistent/useThemePartsState.js","hooks/persistent/useAutosaveState.js","components/common/MenuModal.js","editor/shortcutKeys.js","utils/getBlockLabel.js","components/editor/KeyBindingDetail.js","components/editor/SettingsModal.js","hooks/persistent/useOutputPanelState.js","observables/contextMenuStore.js","tutorials/utils/getTutorialNode.js","tutorials/steps/createNodeStep.js","tutorials/utils/tutorialStyles.js","observables/editorStateStore.js","observables/editorSelectionStore.js","tutorials/definitions/helloWorldTutorial.js","tutorials/tutorials.js","observables/editorStore.js","hooks/persistent/useTutorialProgressState.js","hooks/useNodeEditor.js","hooks/useTutorialVariables.js","hooks/utils/useObjectObservable.js","components/editor/TutorialCard.js","tutorials/utils/getTutorialStep.js","hooks/persistent/useFamiliarityState.js","components/editor/TutorialsModal.js","components/editor/EditorMenu.js","hooks/utils/useTimeout.js","components/common/ExternalLink.js","components/editor/OutputPanel.js","hooks/persistent/useFullscreenPanelState.js","components/rete/controls/TextControlHandle.js","utils/getDefaultLabel.js","components/common/inputs/TypeSelect.js","utils/getNodeLabel.js","editor/controls/BaseControl.js","components/rete/controls/NumberControlHandle.js","components/rete/controls/CheckboxControlHandle.js","components/rete/controls/NodeControlHandle.js","components/rete/controls/TypeControlHandle.js","editor/controls/PropControl.js","utils/flattenUniqueTypes.js","editor/sockets/PropSocket.js","editor/sockets/PropOutputSocket.js","utils/getPropLabel.js","editor/components/BlockComponent.js","contexts/ConnectionAwareListContext.js","compilers/NodeCompiler.js","compilers/TypeCompiler.js","compilers/ControlCompiler.js","editor/BlocksNodeEditor.js","components/rete/nodes/parts/DynamicTitle.js","components/rete/sockets/SocketHandle.js","components/rete/nodes/parts/ShortcutButton.js","components/rete/nodes/parts/PropField.js","components/rete/nodes/views/DefaultNodeView.js","components/rete/nodes/NodeHandle.js","plugins/rete-blocks-contextmenu-plugin/components/ContextMenu.js","plugins/rete-blocks-contextmenu-plugin/contexts/MenuContext.js","plugins/rete-blocks-contextmenu-plugin/components/MenuIcon.js","plugins/rete-blocks-contextmenu-plugin/components/MenuAction.js","utils/jsonCopy.js","plugins/rete-blocks-contextmenu-plugin/components/menus/SelectionMenu.js","plugins/rete-blocks-contextmenu-plugin/components/MenuComponent.js","plugins/rete-blocks-contextmenu-plugin/components/MenuSearch.js","plugins/rete-blocks-contextmenu-plugin/components/menus/PlacementMenu.js","plugins/rete-blocks-contextmenu-plugin/hooks/useEditorComponents.js","plugins/rete-blocks-contextmenu-plugin/index.js","plugins/rete-connection-drop-plugin/index.js","plugins/rete-connection-opacity-plugin/index.js","plugins/rete-vertical-sort-plugin/index.js","plugins/rete-drag-button-plugin/index.js","observables/createNodeStore.js","plugins/rete-blocks-history-plugin/index.js","editor/createEditor.js","components/rete/EditorWrapper.js","components/editor/Editor.js","components/editor/EditorPage.js","hooks/utils/useRedraw.js","components/TabLayout.js","components/global/GlobalTheme.js","observables/keyDownStore.js","observables/keyUpStore.js","components/global/GlobalObservables.js","components/MobilePage.js","components/App.js","index.js","components/rete/nodes/views/CommentNodeView.js","blocks/Comment.js","components/rete/nodes/views/RegionNodeView.js","blocks/CommentRegion.js"],"names":["Type","name","parent","generics","data","meta","this","map","type","getType","t","toJSON","otherMeta","buildType","Object","assign","abstract","some","isAbstract","value","defaultValue","other","length","every","i","equals","alwaysSubtype","arbitraryGenerics","isSubtype","getSharedType","toTypeString","call","g","join","TYPE_MAP","Map","window","anyType","createType","category","reversed","anyReversedType","typeType","controlType","fromJSON","nodeType","info","block","JSON","stringify","valueType","toMotoko","customType","referenceType","identifierType","validation","pattern","custom","MOTOKO_KEYWORDS","includes","defaultInput","prop","node","nodeIdentifierRef","key","effectType","memberType","singleOutput","containerType","paramType","boolType","textType","minLength","maxLength","floatType","isNaN","intType","step","natType","min","principalType","tupleType","unitType","withMeta","Error","objectType","genericNames","functionType","optionalType","nullType","collectionType","arrayType","item","mutableArrayType","mapType","asyncType","baseType","set","getGenericType","parentData","parentMeta","arguments","has","get","a","b","Category","root","CATEGORY_MAP","createCategory","getCategory","defaultCategory","stateCategory","color","icon","FaDatabase","priority","functionCategory","FaCubes","paramCategory","FaLongArrowAltRight","typeCategory","FaTextHeight","collectionCategory","FaTh","compilerCategory","FaCode","expressionCategory","FaEject","operatorCategory","FaFilter","actorCategory","FaFont","effectCategory","FaStream","literalCategory","FaPlusCircle","decompositionCategory","FaNetworkWired","commentCategory","FaCommentAlt","EDITOR_CHANGE_EVENT","EDITOR_SAVE_EVENT","PROJECT_EXPORT_EVENT","PROJECT_LOAD_EVENT","PROJECT_CLEAR_EVENT","ERROR_EVENT","events","EventEmitter","setMaxListeners","on","console","error","EVENTS","React","createContext","prepare","string","undefined","formatParentheses","startsWith","endsWith","s","substring","formatCurlyBraces","formatStatementBlock","formatMembers","members","formatStatements","statement","after","FOR_DEBUGGING","FOR_LEARNING_MOTOKO","FOR_BUILDING_API","FOR_STORING_DATA","FOR_REUSABLE_LOGIC","FOR_ORGANIZATION","FOR_DOCUMENTATION","FOR_CONFIGURATION","FOR_CUSTOM_LOGIC","FOR_ERROR_HANDLING","defaultType","of","statementBlock","compileFn","beforeProp","inferType","args","compiler","getBlock","inputs","filter","getInput","props","result","topLeft","topRight","optional","outputs","endStatementBlock","statementProp","useListener","target","event","listener","options","useEffect","domTarget","addEventListener","removeEventListener","off","unaryOperatorBlock","symbol","evaluate","title","input","binaryOperatorBlock","Array","isArray","inputType","resultType","left","right","arithmeticOperatorBlock","numberComparisonOperatorBlock","component","id","String","stateReadIcon","FaAngleRight","stateWriteIcon","FaAngleDoubleRight","memberBlock","useCases","global","computeTitle","editor","computeMemberName","compilers","motoko","getTypeString","shortcuts","nodeKey","request","initialValue","controls","advanced","stable","modifiers","m","useControlValue","control","getValue","useState","updateVisualValue","useContext","EventsContext","emit","setValue","useCallback","timeout","useReactTooltip","setTimeout","ReactTooltip","rebuild","ObservableValue","_value","_listeners","newValue","forEach","fn","listenerFn","push","unsubscribe","makeObservable","importRef","resolveImportRefs","code","imports","replace","match","path","lastIndexOf","hasOwnProperty","entries","MotokoCompiler","r","postCompile","warn","Compiler","storage","isEmbedded","localStorage","observableMap","makeLocalStorageObservable","observable","parse","subscribe","useLocalStorage","useObservableState","storedValue","setStoredValue","valueToStore","Function","visibilityControlProp","stringSelectProp","memberProp","require","context","fs","base","scanSubDirectories","regularExpression","files","readDirectory","directory","readdirSync","file","fullPath","resolve","statSync","isDirectory","test","Module","keys","__dirname","allBlocks","blockNames","Set","blockContext","addProps","propList","basename","default","values","find","addProp","advancedProp","output","add","BLOCK_MAP","arrayImportRef","getOutput","mutable","multi","itemType","items","literalBlock","stringifier","setValueState","UndefinedInputError","compileKey","silent","Rete","Node","nodes","getNode","_output","connections","c","_compileConnection","_input","_control","_compileControl","_prop","getInputArgs","defaultCompile","err","trigger","cached","defineProperty","connection","from","to","bindNodeInput","ref","stopPropagation","defaultTheme","THEMES","useThemeState","themes","useThemes","getQueryConfig","setId","theme","self","top","e","config","location","search","getEmbedConfig","replaceRegex","parseCodeBlockInputs","expression","CodeControlHandle","bindInput","style","height","onChange","findNodeSearchOptions","text","componentName","flatMap","compileGlobalMotoko","memberNodes","io","socket","findType","sort","position","configNodes","actorName","pascalCase","projectName","actorClassPart","compileGlobalParameter","actorPart","prefixes","actorCode","prettyPrintMotoko","parts","monaco","styledComponents","configureMonaco","defineTheme","nightOwlTheme","languages","register","setLanguageConfiguration","comments","lineComment","blockComment","brackets","autoClosingPairs","open","close","setMonarchTokensProvider","defaultToken","tokenPostfix","keywords","accessmodifiers","typeKeywords","operators","symbols","escapes","tokenizer","cases","include","token","bracket","next","comment","whitespace","CodeEditor","readOnly","others","defaultLanguage","beforeMount","tabSize","minimap","enabled","wordWrap","scrollBeyondLastLine","fontSize","indent","trim","depth","lines","split","repeat","Loading","promise","loading","children","status","setStatus","setResult","Promise","then","catch","CopyToClipboardButton","tooltipRef","size","buttonRef","copied","setCopied","Button","variant","className","onClick","show","OutputControlHandle","query","findValue","valuePromise","setValuePromise","compileBlock","compilerKey","displayFn","queryFor","inputKey","controlProps","SelectControlHandle","findLabel","invalid","validate","classNames","option","label","charAt","toUpperCase","controlDefault","updateNode","webpackEmptyContext","req","module","exports","defaultReturnType","getFunctionReturnType","visibility","params","body","returnType","fromOutput","hasCaller","returnString","typeString","examples","getExampleProjects","webpackContext","webpackContextResolve","__webpack_require__","o","hidden","FaRegCaretSquareRight","array","FaLayerGroup","_","index","fromType","toType","fromTypeString","FaRegCaretSquareLeft","thisName","width","collection","FaSitemap","condition","trueCase","falseCase","falsePart","intImportRef","FaPlayCircle","functionNode","paramNames","n","customSearch","toLowerCase","FaPencilAlt","reference","FaItalic","slice","types","iterImportRef","max","inclusive","loop","configNode","FaCompress","hashMapImportRef","keyType","keyImportRef","valueTypeString","valueCase","nullCase","valuePart","nullPart","FaCaretLeft","stateNode","typeInput","typeNode","log","FaRegPlayCircle","callable","StyledReactTooltip","styled","GlobalTooltip","backgroundColor","place","delayShow","multiline","_linearGradient","_excluded","_extends","source","prototype","apply","_objectWithoutProperties","excluded","sourceKeys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgGradient","_ref","svgRef","titleId","x2","y2","offset","stopColor","ForwardRef","MenuContainer","div","HiddenGradient","Gradient","TopMenu","Provider","verticalAlign","ItemContainer","MenuItem","tooltip","StyledMenuItem","MenuButton","FileDropZone","onFile","onFileContent","onDrop","reader","FileReader","onload","readAsText","useDropzone","maxFiles","getRootProps","getInputProps","isDragActive","Container","MenuModalOption","description","StyledFileDropZone","LoadProjectModal","loadFile","LoadFileContext","accept","DROP_ZONE_EXTENSIONS","example","_g","SvgDownload","viewBox","xmlns","xmlnsXlink","xmlSpace","fillRule","clipRule","strokeLinejoin","strokeMiterlimit","d","_path","SvgFilePlus","SvgFolder","SvgFolderWide","transform","x","y","fill","SvgFolderOpen","SvgSave","SvgCrosshair","SvgLearning","_path2","SvgSettings","defaultFill","createIcon","SvgComponent","widthRatio","DownloadIcon","Download","FilePlusIcon","FilePlus","FolderWideIcon","Folder","FolderWide","FolderOpenIcon","FolderOpen","SaveIcon","Save","CrosshairIcon","Crosshair","LearningIcon","Learning","SettingsIcon","Settings","ContainerDiv","bottom","css","FloatingMenu","useLearningModeState","useThemePartsState","useAutosaveState","MenuModal","SHORTCUT_KEYS","k","v","getBlockLabel","capitalCase","BlockShortcutContainer","ShortcutContainer","KeyContainer","KeyboardShortcut","binding","KeyBindingDetail","settingInputs","select","toggle","checked","NestedContainer","Setting","extras","SettingInput","fontWeight","extra","SettingsModal","setTheme","themeParts","setThemeParts","autosave","setAutosave","learningMode","setLearningMode","settings","part","sentenceCase","setting","OUTPUT_PANEL_STATE","useOutputPanelState","CONTEXT_MENU_STORE","getTutorialNode","createNodeStep","isComplete","progress","setupNode","highlightStyle","animation","keyframes","animationStyle","getNodeSelector","selector","highlightNode","highlightNodeSocket","highlightContextMenuComponent","blockName","EDITOR_STATE_STORE","EDITOR_SELECTION_STORE","functionNodeId","returnNodeId","textNodeId","getFunctionNode","getReturnNode","getTextNode","helloWorldTutorial","setupVariables","contextMenu","editorState","editorSelection","outputPanel","steps","render","conn","removeConnection","textNode","TUTORIALS","EDITOR_STORE","useTutorialProgressState","defaultTutorial","defaultState","tutorial","state","setState","useNodeEditor","useMemo","freeze","setProgress","useTutorialVariables","object","callbacks","callback","useObjectObservable","StyledLearningIcon","StyledCard","Card","StyledCardHeader","Header","GlobalStyle","createGlobalStyle","tutorialCss","stepCss","HelperCard","iconTooltip","hideCloseButton","Body","TutorialProgressCard","onComplete","variables","getTutorialStep","ButtonGroup","onMouseDown","rendered","TutorialCard","familiarity","setFamiliarity","resetTutorial","onAccept","onDecline","tutorials","TutorialsModal","currentTutorial","selected","transition","borderStyle","borderColor","borderWidth","borderLeftColor","BlocksLogo","img","ProjectNameInput","saveAnimation","StyledSaveIcon","StyledZoomIcon","EditorMenu","setName","saveAnimating","setSaveAnimating","zoomAnimating","setZoomAnimating","openMenu","setOpenMenu","setOutputPanel","project","clearTimeout","useTimeout","href","rel","src","process","alt","draggable","placeholder","updateName","onKeyDown","onAnimationEnd","AreaPlugin","zoomAt","Modal","onShow","hide","onHide","ExternalLink","textDecoration","OutputContainer","closed","fullscreen","ClipboardButton","outputPanelId","OutputPanel","panel","setPanel","setFullscreen","setOutput","onCopy","TextControlHandle","autoComplete","autoCorrect","getDefaultLabel","TypeSelect","constraintType","splice","getNodeLabel","simplified","controlTypes","number","checkbox","setNodes","blockFilter","maxWidth","BaseControl","getData","getDefaultValue","putData","PropControl","flattenUniqueTypes","generic","PropSocket","relevant","otherType","Socket","PropOutputSocket","typeCompiler","nodeId","nodeName","_isTypeOfType","getPropLabel","BlockComponent","getEditorNode","isPropOutput","addPropInput","addPropOutput","isOutput","Input","shouldPropHaveControl","addControl","addInput","Output","addOutput","Component","NodeCompiler","TypeCompiler","ControlCompiler","BlocksNodeEditor","projectDescription","bind","json","version","language","beforeImport","hadError","all","jsonNode","getComponent","build","addNode","jsonOutput","jsonConnection","targetOutput","otherNode","targetInput","connect","afterImport","createNode","view","area","mouse","update","NodeEditor","DynamicTitle","fallback","setTitle","SocketHandle","propKey","innerRef","setRelevant","requested","setRequested","connectionAwareList","ConnectionAwareListContext","socketType","multiple","multipleConnections","updateRequested","findProp","starting","connectionIO","outputType","el","ShortcutButton","shortcut","button","components","createNodeAtCursor","newNode","_drag","down","fromIO","toIO","cursor","createElement","PropField","hideLeft","hideRight","bindSocket","bindControl","showControl","leftSocket","rightSocket","controlField","paramCase","DefaultNodeView","nodeHandle","getBindControl","background","NodeHandle","NodeView","ContextMenu","styleProp","handleCloseMenu","bindScreen","bindContainer","moveIntoWindow","getBoundingClientRect","innerHeight","onresize","pointerEvents","keyCode","MenuContext","MenuIcon","MenuAction","onAction","userSelect","jsonCopy","cloneSelected","newNodeMap","list","original","clone","remove","SelectionMenu","each","removeNode","MenuComponent","specialTitle","FaRegStickyNote","opacity","MenuSearch","focus","handleKeyDown","autoFocus","deepCopy","obj","PlacementMenu","searchText","setSearchText","setIndex","menu","sortFn","hash","deprecated","compare","localeCompare","useEditorComponents","findRelevantComponents","lower","Math","handleSearchAction","handleCreateOption","compatibleWith","menuItems","ContextMenuPlugin","install","mouseEvent","offsetX","offsetY","display","preventDefault","ctrlKey","contains","selectNode","clientX","clientY","document","container","appendChild","menuContext","ReactDOM","connectionMouseMoved","removingConnection","prevConnections","ConnectionDropPlugin","ConnectionOpacityPlugin","minDistance","opacityFalloff","querySelectorAll","pathElement","distance","sqrt","sortConnections","VerticalSortPlugin","ioMap","DragButtonPlugin","CREATE_NODE_STORE","UndoRedoHistory","delay","undoHistory","redoHistory","current","_timeout","_resetCurrent","shift","_applyCurrent","pop","HistoryPlugin","history","metaKey","shiftKey","findCategory","inputTags","EditorWrapper","onSetup","onSave","_editor","clear","destroy","element","editorName","use","ReactRenderPlugin","ConnectionPlugin","AutoArrangePlugin","classList","chrome","zoom","snap","dynamic","editorButton","updateSelection","previous","mouseMoved","querySelector","createEditor","EDITOR","activeElement","handleConnectionEnd","startIO","endIO","currentIO","loadState","resize","EditorContainer","EditorControls","hideMenu","Editor","loadBlocksFile","content","noClick","STORAGE_EDITOR_STATE","DEFAULT_STATE","embedded","nextEditorState","EditorPage","redraw","useRedraw","menuParam","FileSaver","saveAs","Blob","onEditorSetup","stateString","onEditorChange","onEditorSave","message","postMessage","TabLayout","GlobalTheme","KEY_DOWN_STORE","KEY_UP_STORE","GlobalObservables","MobilePanel","MobilePage","App","toast","StrictMode","marginTop","getElementById","StyledTextArea","TextareaAutosize","textArea","setText","setWidth","onMouseUp","offsetWidth","rows","maxRows","ResizeArea","FaSquareFull","setHeight","parentElement","zIndex","clientWidth","clientHeight"],"mappings":"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","file":"static/js/main.3a66b80e.chunk.js","sourcesContent":["import nodeIdentifierRef from '../compilers/utils/nodeIdentifierRef';\r\nimport {MOTOKO_KEYWORDS} from '../config/configureMonaco';\r\n\r\nclass Type {\r\n    constructor(name, parent, generics, data = {}, meta = {}) {\r\n        this.name = name;\r\n        this.parent = parent;\r\n        this.generics = generics.map(type => getType(type));\r\n        this.data = data;\r\n        this.meta = meta;\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            name: this.name,\r\n            generics: this.generics.map(t => t.toJSON()),\r\n        };\r\n    }\r\n\r\n    of(...generics) {\r\n        return getType(this, generics);\r\n    }\r\n\r\n    withMeta(meta) {\r\n        let {name, ...otherMeta} = meta;\r\n        let type = buildType(name || this.name, this, this.generics);\r\n        Object.assign(type.meta, otherMeta);\r\n        return type;\r\n    }\r\n\r\n    isAbstract() {\r\n        return this.data.abstract || this.generics.some(type => type.isAbstract());\r\n    }\r\n\r\n    getDefaultValue() {\r\n        let value = this.data.defaultValue;\r\n        return typeof value === 'function' ? value(this) : value;\r\n    }\r\n\r\n    equals(other) {\r\n        return this.name === other.name && this.generics.length === other.generics.length && this.generics.every((t, i) => t.equals(other.generics[i]));\r\n    }\r\n\r\n    // TODO: rename to something like `isAssignableFrom`\r\n    isSubtype(other) {\r\n        if(!other) {\r\n            return false;\r\n        }\r\n        if(this.data.alwaysSubtype === other) {\r\n            return true;///\r\n        }\r\n        if(this.data.arbitraryGenerics && other.parent && this.name === other.parent.name) {\r\n            // e.g. `Tuple : Tuple<A, B, C>`\r\n            return true;\r\n        }\r\n        if(this.name === other.name) {\r\n            return this.generics.length === other.generics.length && this.generics.every((t, i) => t.isSubtype(other.generics[i]));\r\n        }\r\n        return !!other.parent && this.isSubtype(other.parent);\r\n    }\r\n\r\n    getSharedType(other) {\r\n        if(!other) {\r\n            return;\r\n        }\r\n        if(this === other) {\r\n            return this;\r\n        }\r\n        if(this.isSubtype(other)) {\r\n            return this;\r\n        }\r\n        if(other.isSubtype(this)) {\r\n            return other;\r\n        }\r\n        if(this.parent) {\r\n            return this.parent.getSharedType(other);\r\n        }\r\n    }\r\n\r\n    toTypeString() {\r\n        return this.data.toTypeString?.call(this) ?? this.name + (this.generics.length ? '<' + this.generics.map(g => g.toTypeString()).join(', ') + '>' : '');\r\n    }\r\n\r\n    toString() {\r\n        return `Type(${this.toTypeString()})`;\r\n    }\r\n}\r\n\r\nexport const TYPE_MAP = new Map();\r\n\r\nwindow.TYPE_MAP = TYPE_MAP; // Browser debug\r\n\r\nexport const anyType = createType('Any', {\r\n    abstract: true,\r\n    category: 'default',\r\n    reversed: false,\r\n});\r\nexport const anyReversedType = createType('AnyReversed', {\r\n    abstract: true,\r\n    category: 'default',\r\n    // parent: anyType,\r\n    reversed: true,\r\n});\r\n\r\nexport const typeType = createType('Type', {\r\n    parent: anyType,\r\n    category: 'types',\r\n    controlType: 'type',\r\n    defaultValue: type => type.generics[0],\r\n    generics: [anyType],\r\n    fromJSON(value) {\r\n        return getType(value);\r\n    },\r\n});\r\nexport const nodeType = createType('Node', {\r\n    info: 'A specific node in the editor',\r\n    parent: anyType,\r\n    category: 'nodes',\r\n    controlType: 'node',\r\n    toTypeString() {\r\n        return this.meta.block ? `Node{block=${JSON.stringify(this.meta.block)}}` : 'Node';\r\n    },\r\n});\r\n\r\n// High-level type categories\r\nexport const valueType = createType('Value', {\r\n    abstract: true,\r\n    parent: anyType,\r\n    category: 'values',\r\n    toMotoko() {\r\n        if(this === valueType) {\r\n            return 'Any';\r\n        }\r\n    },\r\n});\r\nexport const customType = createType('Custom', {\r\n    info: 'A custom user-defined value',\r\n    // abstract: true, // TEMP\r\n    parent: valueType,\r\n    arbitraryGenerics: true,\r\n    // toMotoko() {\r\n    //     console.log(this)///\r\n    //     return this.meta.motoko || '$Custom$';\r\n    // },\r\n});\r\nexport const referenceType = createType('Reference', {\r\n    info: 'A programmatic path to a value, type, function, actor, class, object, or module',\r\n    parent: anyType,\r\n    category: 'references',\r\n});\r\nexport const identifierType = createType('Identifier', {\r\n    info: 'A name consisting of letters and underscores',\r\n    parent: referenceType,\r\n    controlType: 'text',\r\n    // defaultValue: '',\r\n    validation: {\r\n        pattern: /^[a-zA-Z][a-zA-Z0-9_]*$/,\r\n        custom: value => !MOTOKO_KEYWORDS.includes(value),\r\n    },\r\n    defaultInput(prop, node) {\r\n        // Create placeholder identifier\r\n        return nodeIdentifierRef(node, prop.key);\r\n    },\r\n});\r\nexport const effectType = createType('Effect', {\r\n    info: 'A statement which runs after calling a function',\r\n    parent: anyReversedType,\r\n    category: 'effects',\r\n    generics: [valueType],\r\n    toMotoko([value]) {\r\n        return value;\r\n    },\r\n});\r\nexport const memberType = createType('Member', {\r\n    info: 'Something defined within a container (actor, object, class, or module)',\r\n    parent: anyReversedType,\r\n    singleOutput: true,\r\n    category: 'members',\r\n});\r\nexport const containerType = createType('Container', {\r\n    info: 'An actor, object, class, or module',\r\n    parent: memberType,\r\n    singleOutput: true,\r\n    category: 'containers',\r\n});\r\nexport const moduleType = createType('Module', {\r\n    info: 'A group of related containers (actors, objects, classes, and/or modules)',\r\n    parent: memberType,\r\n    singleOutput: true,\r\n    category: 'modules',\r\n});\r\nexport const paramType = createType('Parameter', {\r\n    info: 'An input to a function, class, or actor',\r\n    parent: anyReversedType,\r\n    category: 'parameters',\r\n});\r\n\r\n// Value types\r\nexport const boolType = createType('Bool', {\r\n    info: 'A logical value representing \"true\" or \"false\"',\r\n    parent: valueType,\r\n    controlType: 'checkbox',\r\n    defaultValue: false,\r\n});\r\nexport const charType = createType('Char', {\r\n    info: 'A single character of text',\r\n    parent: valueType,\r\n    controlType: 'text',\r\n    validation: {\r\n        minLength: 1,\r\n        maxLength: 1,\r\n    },\r\n});\r\nexport const textType = createType('Text', {\r\n    info: 'A sequence of letters, numbers, emojis, and other characters',\r\n    parent: valueType,\r\n    controlType: 'text',\r\n    defaultValue: '',\r\n});\r\nexport const floatType = createType('Float', {\r\n    info: 'A decimal number (-0.1, 123, 1.0e5)',\r\n    parent: valueType,\r\n    controlType: 'text',\r\n    validation: {\r\n        custom: value => !isNaN(+value),\r\n    },\r\n    defaultValue: 0,\r\n});\r\nexport const intType = createType('Int', {\r\n    info: 'A numeric integer (..., -2, -1, 0, 1, 2, ...)',\r\n    parent: floatType,\r\n    category: 'integers',\r\n    controlType: 'number',\r\n    validation: {\r\n        step: 1,\r\n    },\r\n});\r\nexport const natType = createType('Nat', {\r\n    info: 'A natural number (0, 1, 2, ...)',\r\n    parent: floatType,\r\n    category: 'naturals',\r\n    validation: {\r\n        step: 1,\r\n        min: 0,\r\n    },\r\n});\r\nexport const blobType = createType('Blob', {\r\n    info: 'Immutable binary data (similar to an HTML5 blob)',\r\n    parent: valueType,\r\n});\r\nexport const principalType = createType('Principal', {\r\n    info: 'A wallet or smart contract address',\r\n    parent: valueType,\r\n    category: 'principals',\r\n});\r\nexport const errorType = createType('Error', {\r\n    info: 'An error value for custom exception handling',\r\n    parent: valueType,\r\n});\r\nexport const tupleType = createType('Tuple', {\r\n    info: 'A combination of multiple values in a specific order',\r\n    abstract: true,\r\n    arbitraryGenerics: true,\r\n    parent: valueType,\r\n    category: 'tuples',\r\n    // controlType: ,\r\n    toTypeString() {\r\n        return this === tupleType ? this.name : `(${this.generics.map(t => t.toTypeString()).join(', ')})`;\r\n    },\r\n});\r\n// export const unitType = createType('Unit', {\r\n//     parent: tupleType,\r\n// });\r\nexport const unitType = createType('Unit', tupleType.withMeta({\r\n    info: 'A type with only one possible value, equivalent to an empty tuple',\r\n}));\r\nif(tupleType === unitType) throw new Error(); // TODO: move to tests\r\nexport const objectType = createType('Object', {\r\n    info: 'An object which can include values, functions, types, or other members',\r\n    abstract: true,\r\n    arbitraryGenerics: true,\r\n    parent: valueType,\r\n    category: 'objects',\r\n    // controlType: ,\r\n    toTypeString() {\r\n        return `(${this.generics.map((t, i) => `${this.genericNames[i]}: ${t.toTypeString()}`).join(', ')})`;\r\n    },\r\n});\r\nexport const functionType = createType('Function', {\r\n    info: 'A callable sequence of events which optionally returns a value',\r\n    parent: valueType,\r\n    generics: [valueType, valueType],\r\n    genericNames: ['input', 'output'],\r\n    category: 'functions',\r\n    toTypeString() {\r\n        return `${this.generics[0].toTypeString()} -> ${this.generics[1].toTypeString()}`;\r\n    },\r\n});\r\nexport const optionalType = createType('Optional', {\r\n    info: 'A value which has the possibility of being null',\r\n    parent: valueType,\r\n    generics: [valueType],\r\n    category: 'optionals',\r\n    toMotoko([value]) {\r\n        return `?${value}`;\r\n    },\r\n});\r\nexport const nullType = createType('Null', {\r\n    info: 'An \"Optional\" value representing nothing',\r\n    parent: valueType,\r\n    alwaysSubtype: optionalType,\r\n});\r\nexport const collectionType = createType('Collection', {\r\n    info: 'A compound data structure such as an Array or Map',\r\n    abstract: true,\r\n    parent: valueType,\r\n    category: 'collections',\r\n});\r\nexport const arrayType = createType('Array', {\r\n    info: 'An ordered sequence of values with a specific type',\r\n    parent: collectionType,\r\n    generics: [valueType],\r\n    genericNames: ['item'],\r\n    toMotoko([item]) {\r\n        return `[${item}]`;\r\n    },\r\n});\r\nexport const mutableArrayType = createType('MutableArray', {\r\n    parent: arrayType,\r\n    generics: [valueType],\r\n    genericNames: ['item'],\r\n    toMotoko([item]) {\r\n        return `[var ${item}]`;\r\n    },\r\n});\r\nexport const mapType = createType('Map', {\r\n    info: 'A lookup or dictionary from one set of values to another',\r\n    parent: collectionType,\r\n    generics: [valueType, valueType],\r\n    genericNames: ['key', 'value'],\r\n    toMotoko([key, value]) {\r\n        return `HashMap.HashMap<${key}, ${value}>`; // TODO: import reference\r\n    },\r\n});\r\nexport const asyncType = createType('Future', {\r\n    info: 'An asynchronous value or process',\r\n    parent: valueType,\r\n    generics: [valueType],\r\n    category: 'futures',\r\n    toMotoko([value]) {\r\n        return `async ${value}`;\r\n    },\r\n});\r\n// export const andType = createType('And', {\r\n//     parent: valueType,\r\n//     generics: [valueType, valueType],\r\n//     toMotoko([a, b]) {\r\n//         return `(${a} and ${b})`;\r\n//     },\r\n// });\r\n\r\n// // Fixed-size int values\r\n// export const int64Type = createType('Int64', {\r\n//     parent: intType,\r\n//     validation: getIntValidation(64),\r\n// });\r\n// export const int32Type = createType('Int32', {\r\n//     parent: int64Type,\r\n//     validation: getIntValidation(32),\r\n// });\r\n// export const int16Type = createType('Int16', {\r\n//     parent: int32Type,\r\n//     validation: getIntValidation(16),\r\n// });\r\n// export const int8Type = createType('Int8', {\r\n//     parent: int16Type,\r\n//     validation: getIntValidation(8),\r\n// });\r\n//\r\n// // Fixed-size nat values\r\n// export const nat64Type = createType('Nat64', {\r\n//     parent: natType,\r\n//     validation: getNatValidation(64),\r\n// });\r\n// export const nat32Type = createType('Nat32', {\r\n//     parent: nat64Type,\r\n//     validation: getNatValidation(32),\r\n// });\r\n// export const nat16Type = createType('Nat16', {\r\n//     parent: nat32Type,\r\n//     validation: getNatValidation(16),\r\n// });\r\n// export const nat8Type = createType('Nat8', {\r\n//     parent: nat16Type,\r\n//     validation: getNatValidation(8),\r\n// });\r\n\r\n// function getNatValidation(n) {\r\n//     return {\r\n//         ...natType.data.validation,\r\n//         max: 2 ** n - 1,\r\n//     };\r\n// }\r\n//\r\n// function getIntValidation(n) {\r\n//     let x = 2 ** (n - 1);\r\n//     return {\r\n//         ...intType.data.validation,\r\n//         min: -x,\r\n//         max: x - 1,\r\n//     };\r\n// }\r\n\r\n// Create a global type\r\nfunction createType(name, data) {\r\n    let type;\r\n    if(data instanceof Type) {\r\n        type = data;\r\n        type.name = name;\r\n    }\r\n    else {\r\n        let {parent} = data;\r\n        let {generics = [], meta = {}, ...other} = data;\r\n        type = buildType(name, parent, generics, other, meta);\r\n        type.data.baseType = type;///\r\n    }\r\n    TYPE_MAP.set(name, type);\r\n    return type;\r\n}\r\n\r\n// Get or create a generic version of the given type\r\nfunction getGenericType(parent, generics) {\r\n    if(typeof parent === 'string') {\r\n        parent = getType(parent);\r\n    }\r\n    if((!generics || !generics.length || generics === parent.generics) && !parent.data.arbitraryGenerics) {\r\n        return getType(parent);\r\n    }\r\n    let type = buildType(parent.name, parent, generics);\r\n    if(!parent.isSubtype(type)) {\r\n        throw new Error(`Generics not assignable to ${parent.toTypeString()} from ${type.toTypeString()}`);\r\n    }\r\n    return type;\r\n}\r\n\r\n// Instantiate a new type\r\nfunction buildType(name, parent, generics, data = {}, meta = {}) {\r\n    // Special cases for data inheritance\r\n    let {\r\n        abstract,\r\n        arbitraryGenerics,\r\n        ...parentData\r\n    } = parent ? parent.data : {};\r\n    let parentMeta = parent ? parent.meta : {};\r\n    return new Type(\r\n        name,\r\n        parent || null,\r\n        generics || (parent ? parent.generics : []),\r\n        {...parentData, ...data},\r\n        {...parentMeta, ...meta},\r\n    );\r\n}\r\n\r\n// Get or create a type\r\nexport function getType(name, generics) {\r\n    if(arguments.length > 1) {\r\n        return getGenericType(name, generics);\r\n    }\r\n    if(name instanceof Type) {\r\n        return name;\r\n    }\r\n    if(typeof name === 'object') {\r\n        return getGenericType(name.name, (name.generics || []).map(t => getType(t)));\r\n    }\r\n    if(!name) {\r\n        throw new Error(`Invalid type: ${name}`);\r\n    }\r\n    if(!TYPE_MAP.has(name)) {\r\n        throw new Error(`Unknown type: ${name}`);\r\n    }\r\n    return TYPE_MAP.get(name);\r\n}\r\n\r\nexport function getSharedType(...types) {\r\n    let a = types[0];\r\n    for(let i = 1; i < types.length; i++) {\r\n        let b = types[i];\r\n        if(!a) {\r\n            a = b;\r\n        }\r\n        else if(b) {\r\n            a = a.getSharedType(b);\r\n        }\r\n    }\r\n    return a;\r\n}","import {\r\n    FaCode,\r\n    FaCommentAlt,\r\n    FaCubes,\r\n    FaDatabase,\r\n    FaEject,\r\n    FaFilter,\r\n    FaFont,\r\n    FaLongArrowAltRight,\r\n    FaNetworkWired,\r\n    FaPlusCircle,\r\n    FaStream,\r\n    FaTextHeight,\r\n    FaTh,\r\n} from 'react-icons/fa';\r\n\r\nclass Category {\r\n    constructor(name, parent, data = {}) {\r\n        this.name = name;\r\n        this.parent = parent;\r\n        this.root = parent ? parent.root : this;\r\n        this.data = data;\r\n    }\r\n}\r\n\r\nconst CATEGORY_MAP = new Map();\r\n\r\nfunction createCategory(data) {\r\n    let {name, parent, ...other} = data;\r\n    let category = new Category(name, parent, parent ? {...parent.data, ...other} : other);\r\n    CATEGORY_MAP.set(category.name, category);\r\n    return category;\r\n}\r\n\r\nexport function getCategory(name) {\r\n    if(name instanceof Category) {\r\n        return name;\r\n    }\r\n    if(!CATEGORY_MAP.has(name)) {\r\n        throw new Error(`Could not find category with name: ${name}`);\r\n    }\r\n    return CATEGORY_MAP.get(name);\r\n}\r\n\r\n\r\nexport const defaultCategory = createCategory('Default', {});\r\nexport const stateCategory = createCategory({\r\n    name: 'State',\r\n    color: '#3fd',\r\n    icon: FaDatabase,\r\n    priority: 10,\r\n});\r\nexport const functionCategory = createCategory({\r\n    name: 'Function',\r\n    color: '#fd3',\r\n    icon: FaCubes,\r\n    priority: 20,\r\n});\r\nexport const paramCategory = createCategory({\r\n    name: 'Param',\r\n    color: '#a8f',\r\n    icon: FaLongArrowAltRight,\r\n    priority: 3,\r\n});\r\nexport const typeCategory = createCategory({\r\n    name: 'Type',\r\n    color: '#2af',\r\n    icon: FaTextHeight,\r\n});\r\nexport const collectionCategory = createCategory({\r\n    name: 'Collection',\r\n    color: '#1c5',\r\n    icon: FaTh,\r\n});\r\nexport const compilerCategory = createCategory({\r\n    name: 'Compiler',\r\n    color: '#f5a',\r\n    icon: FaCode,\r\n});\r\nexport const expressionCategory = createCategory({\r\n    name: 'Expression',\r\n    color: '#aaa',\r\n    icon: FaEject,\r\n});\r\nexport const operatorCategory = createCategory({\r\n    name: 'Operator',\r\n    // color: '#57f',\r\n    icon: FaFilter,\r\n});\r\nexport const actorCategory = createCategory({\r\n    name: 'Actor',\r\n    color: '#fa8',\r\n    icon: FaFont,\r\n});\r\nexport const effectCategory = createCategory({\r\n    name: 'Effect',\r\n    // color: '#57f',\r\n    icon: FaStream,\r\n    priority: 5,\r\n});\r\nexport const literalCategory = createCategory({\r\n    name: 'Literal',\r\n    // color: '#8fa',\r\n    icon: FaPlusCircle,\r\n    priority: 6,\r\n});\r\nexport const decompositionCategory = createCategory({\r\n    name: 'Decomposition',\r\n    // color: '#ccc',\r\n    icon: FaNetworkWired,\r\n});\r\nexport const commentCategory = createCategory({\r\n    name: 'Comment',\r\n    // color: '#ccc',\r\n    icon: FaCommentAlt,\r\n    priority: -1,\r\n});\r\n","import React from 'react';\r\nimport EventEmitter from 'events';\r\n\r\nexport const EDITOR_CHANGE_EVENT = 'editor-change';\r\nexport const EDITOR_SAVE_EVENT = 'editor-save';\r\nexport const PROJECT_EXPORT_EVENT = 'project-export';\r\nexport const PROJECT_LOAD_EVENT = 'project-load';\r\nexport const PROJECT_CLEAR_EVENT = 'project-clear';\r\nexport const ERROR_EVENT = 'error';\r\n\r\n// TODO: fix HMR memory leak\r\n\r\nconst events = new EventEmitter();\r\nevents.setMaxListeners(1000);\r\nevents.on(ERROR_EVENT, console.error);\r\n\r\n// Browser debug\r\nwindow.EVENTS = events;\r\n\r\nexport default React.createContext(events);\r\n","function prepare(string) {\r\n    return string === '' || string === null || string === undefined ? '' : string;\r\n}\r\n\r\nexport function formatParentheses(string) {\r\n    string = prepare(string);\r\n    // Remove trivial double parentheses\r\n    if(string.startsWith('(') && string.endsWith(')')) {\r\n        const s = string.substring(1, string.length - 1);\r\n        if(!s.includes('(') && !s.includes(')')) {\r\n            string = s;\r\n        }\r\n    }\r\n    return `(${string})`;\r\n}\r\n\r\nexport function formatCurlyBraces(string) {\r\n    string = prepare(string);\r\n    return `{\\n${string}\\n}`;\r\n}\r\n\r\nexport function formatStatementBlock(string) {\r\n    string = prepare(string);\r\n    return `${formatCurlyBraces(string)};`;\r\n}\r\n\r\nexport function formatMembers(members) {\r\n    if(!members) {\r\n        return '';\r\n    }\r\n    return `${members.join('\\n\\n')}`;\r\n}\r\n\r\nexport function formatStatements(statement, after) {\r\n    if(!statement) {\r\n        return after;\r\n    }\r\n    return after ? `${statement}\\n${after}` : statement;\r\n}","export const FOR_DEBUGGING = 'debugging';\r\nexport const FOR_LEARNING_MOTOKO = 'learning Motoko';\r\nexport const FOR_BUILDING_API = 'building an API';\r\nexport const FOR_STORING_DATA = 'storing data';\r\nexport const FOR_REUSABLE_LOGIC = 'writing reusable logic';\r\nexport const FOR_ORGANIZATION = 'project organization';\r\nexport const FOR_DOCUMENTATION = 'documentation';\r\nexport const FOR_CONFIGURATION = 'configuration';\r\nexport const FOR_CUSTOM_LOGIC = 'custom logic';\r\nexport const FOR_ERROR_HANDLING = 'error handling';","import {effectType, getSharedType, unitType} from '../block-types/types';\r\nimport {effectCategory} from '../block-categories/categories';\r\nimport {formatStatements} from '../editor/format/formatHelpers';\r\n\r\nconst defaultType = effectType.of(unitType);\r\n\r\nexport function statementBlock(block, compileFn) {\r\n    const beforeProp = {\r\n        key: 'before',\r\n        type: effectType,\r\n        inferType(/*{after}*/args, node, compiler) {\r\n            // return after || defaultType;\r\n\r\n            let block = compiler.getBlock(node);\r\n            return getSharedType(...block.inputs\r\n                .filter(prop => effectType.isSubtype(prop.type))\r\n                .map(prop => compiler.getInput(node, prop.key))) || defaultType;\r\n        },\r\n        toMotoko(props, ...args) {\r\n            let result = compileFn(props, ...args);\r\n            if(result === undefined) {\r\n                return;\r\n            }\r\n            let {after} = props;\r\n            return formatStatements(result, after);//`${result}${after ? ' ' + after : ''}`;\r\n        },\r\n    };\r\n    // for(let [key, fn] of Object.entries(compileObject)) {\r\n    //     beforeProp[key] = typeof fn === 'function' ? function(props, ...args) {\r\n    //         let result = fn(props, ...args);\r\n    //         if(result === undefined) {\r\n    //             return;\r\n    //         }\r\n    //         let {after} = props;\r\n    //         return `${result}${after ? ' ' + after : ''}`;\r\n    //     } : fn;\r\n    // }\r\n\r\n    return {\r\n        category: effectCategory,\r\n        topLeft: 'before',\r\n        topRight: 'after',\r\n        ...block,\r\n        inputs: [\r\n            ...block.inputs || [], {\r\n                key: 'after',\r\n                type: effectType,\r\n                optional: true,\r\n                // multi: true,\r\n            },\r\n        ],\r\n        outputs: [\r\n            ...block.outputs || [],\r\n            beforeProp,\r\n        ],\r\n    };\r\n}\r\n\r\nexport function endStatementBlock(block, statementProp) {\r\n    return {\r\n        category: effectCategory,\r\n        topLeft: 'statement',\r\n        ...block,\r\n        outputs: [...block.outputs || [], {\r\n            key: 'statement',\r\n            type: effectType,\r\n            ...statementProp,\r\n        }],\r\n    };\r\n}\r\n","import {useEffect} from 'react';\r\n\r\nexport default function useListener(target, event, listener, options) {\r\n    useEffect(() => {\r\n        if(!target) {\r\n            return;\r\n        }\r\n        const domTarget = 'addEventListener' in target;\r\n        if(domTarget) {\r\n            target.addEventListener(event, listener, options);\r\n        }\r\n        else {\r\n            target.on(event, listener, options);\r\n        }\r\n        return () => {\r\n            if(domTarget) {\r\n                target.removeEventListener(event, listener);\r\n            }\r\n            else {\r\n                target.off(event, listener);\r\n            }\r\n        };\r\n    }, [target, event, listener, options]);\r\n    return listener;\r\n}","import {boolType, floatType, getType} from '../block-types/types';\r\nimport {operatorCategory} from '../block-categories/categories';\r\nimport {formatParentheses} from '../editor/format/formatHelpers';\r\n\r\nexport function unaryOperatorBlock(type, symbol, evaluate) {\r\n    type = getType(type);\r\n    return {\r\n        topRight: 'result',\r\n        title: `(${symbol} a)`,\r\n        category: operatorCategory,\r\n        inputs: [{\r\n            key: 'input',\r\n            title: 'a',\r\n            type,\r\n        }],\r\n        outputs: [{\r\n            key: 'result',\r\n            type,\r\n            toMotoko({input}) {\r\n                return `${symbol}(${input})`;\r\n            },\r\n            // inferType({input}) {\r\n            //     return input;\r\n            // },\r\n        }],\r\n    };\r\n}\r\n\r\nexport function binaryOperatorBlock(type, symbol, evaluate) {\r\n    let [inputType, resultType] = Array.isArray(type) ? type : [type, type];\r\n\r\n    inputType = getType(inputType);\r\n    resultType = getType(resultType);\r\n\r\n    return {\r\n        title: `(a ${symbol} b)`,\r\n        category: operatorCategory,\r\n        topRight: 'result',\r\n        inputs: [{\r\n            key: 'left',\r\n            title: 'a',\r\n            type: inputType,\r\n        }, {\r\n            key: 'right',\r\n            title: 'b',\r\n            type: inputType,\r\n        }],\r\n        outputs: [{\r\n            key: 'result',\r\n            type: resultType,\r\n            toMotoko({left, right}) {\r\n                return formatParentheses(`${left} ${symbol} ${right}`);\r\n            },\r\n            // inferType({left, right}) {\r\n            //     return left.getSharedType(right);\r\n            // },\r\n        }],\r\n    };\r\n}\r\n\r\nexport function arithmeticOperatorBlock(...args) {\r\n    return binaryOperatorBlock(floatType, ...args);\r\n}\r\n\r\nexport function numberComparisonOperatorBlock(...args) {\r\n    return binaryOperatorBlock([floatType, boolType], ...args);\r\n}","export default function nodeIdentifierRef(node, key) {\r\n    // TODO: ensure `id` is a valid identifier\r\n    const type = node.component?.name || 'node';\r\n    const id = typeof node === 'number' || typeof node === 'string' ? String(node) : node.id;\r\n    return `${type}__${id}${key ? '_' + key : ''}`;\r\n}\r\n","import {boolType, unitType, valueType} from '../block-types/types';\r\nimport {computeMemberName, memberBlock} from '../block-patterns/member-patterns';\r\nimport {stateCategory} from '../block-categories/categories';\r\nimport {FaAngleDoubleRight, FaAngleRight} from 'react-icons/fa';\r\nimport {FOR_BUILDING_API, FOR_STORING_DATA} from '../editor/useCases';\r\n\r\nexport const stateReadIcon = FaAngleRight;\r\nexport const stateWriteIcon = FaAngleDoubleRight;\r\n\r\nconst block = memberBlock({\r\n    info: 'A persistent smart contract variable',\r\n    useCases: [FOR_BUILDING_API, FOR_STORING_DATA],\r\n    topRight: 'value',\r\n    category: stateCategory,\r\n    global: true,\r\n    computeTitle(node, editor) {\r\n        let name = computeMemberName(node, editor);\r\n        // let name = editor.compilers.motoko.getInput(node, 'name');\r\n        let type = editor.compilers.type.getInput(node, 'initialValue') || unitType;\r\n        return name && `${name} : ${editor.compilers.motoko.getTypeString(type)}`;\r\n    },\r\n    shortcuts: [{\r\n        block: 'StateRead',\r\n        nodeKey: 'stateNode',\r\n    }, {\r\n        block: 'StateUpdate',\r\n        nodeKey: 'stateNode',\r\n    }],\r\n    inputs: [{\r\n        //     key: 'type',\r\n        //     type: 'Type',\r\n        // }, {\r\n        key: 'initialValue',\r\n        type: valueType,\r\n        optional: true,\r\n        request: true,\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: valueType,\r\n        toMotoko({name}) {\r\n            return name;\r\n        },\r\n        inferType({initialValue}) {\r\n            return initialValue;\r\n        },\r\n    }],\r\n    controls: [{\r\n        key: 'stable',\r\n        type: boolType,\r\n        advanced: true,\r\n    }, {\r\n        key: 'readonly',\r\n        type: 'Bool',\r\n        advanced: true,\r\n    }],\r\n}, {\r\n    toMotoko({stable, name, initialValue}, node, compiler) {\r\n        let readonly = false;/// TODO: infer and/or adjust shortcuts\r\n        let modifiers = [!!stable && 'stable'].filter(m => m).join(' '); //TODO: combine into single control\r\n        let type = compiler.editor.compilers.type.getInput(node, 'initialValue');\r\n\r\n        initialValue = initialValue || '()';\r\n\r\n        return `${modifiers && modifiers + ' '}${readonly ? 'let' : 'var'} ${name}${type ? ` : ${compiler.getTypeString(type)}` : ''} = ${initialValue};`;\r\n    },\r\n});\r\nexport default block;\r\n","import {useCallback, useContext, useState} from 'react';\r\nimport useListener from './useListener';\r\nimport EventsContext, {EDITOR_CHANGE_EVENT} from '../../contexts/EventsContext';\r\n\r\nexport default function useControlValue(control) {\r\n    const value = control.getValue();\r\n    const [, updateVisualValue] = useState(value); // updateVisualValue(..): redraw component if value changed\r\n\r\n    const events = useContext(EventsContext);\r\n    useListener(events, EDITOR_CHANGE_EVENT, () => {\r\n        updateVisualValue(control.getValue());\r\n    });\r\n\r\n    useListener(control.events, 'update', () => {\r\n        events.emit(EDITOR_CHANGE_EVENT, control.editor, control);\r\n    });\r\n\r\n    const setValue = useCallback(value => control.setValue(value), [control]);\r\n\r\n    return [value, setValue];\r\n}\r\n","import ReactTooltip from 'react-tooltip';\r\n\r\nlet timeout;\r\n\r\n// Rebuild react-tooltip\r\nexport default function useReactTooltip() {\r\n    if(timeout === undefined) {\r\n        timeout = setTimeout(() => {\r\n            timeout = undefined;\r\n            ReactTooltip.rebuild();\r\n        });\r\n    }\r\n    return ReactTooltip;\r\n}\r\n","// Lightweight observable value implementation\r\n// Derived from: https://stackoverflow.com/a/62002044\r\n\r\nclass ObservableValue {\r\n    constructor(value) {\r\n        this._value = value;\r\n        this._listeners = [];\r\n    }\r\n\r\n    get() {\r\n        return this._value;\r\n    }\r\n\r\n    set(newValue) {\r\n        if(this._value === newValue) {\r\n            return;\r\n        }\r\n        this._value = newValue;\r\n        this._listeners.forEach(fn => fn(this._value));\r\n    }\r\n\r\n    subscribe(listenerFn) {\r\n        this._listeners.push(listenerFn);\r\n        return () => this.unsubscribe(listenerFn);\r\n    }\r\n\r\n    unsubscribe(listenerFn) {\r\n        this._listeners = this._listeners.filter(fn => fn !== listenerFn);\r\n    }\r\n}\r\n\r\nexport default function makeObservable(value) {\r\n    return new ObservableValue(value);\r\n}","import Compiler from './Compiler';\r\nimport {identifierType, typeType} from '../block-types/types';\r\nimport nodeIdentifierRef from './utils/nodeIdentifierRef';\r\n\r\nexport function importRef(name) {\r\n    return `$import$\"${name}\"`;\r\n}\r\n\r\nexport function resolveImportRefs(code) {\r\n    if(!code) {\r\n        return [[], ''];\r\n    }\r\n    code = String(code);\r\n\r\n    const imports = {};\r\n    code = code.replace(/\\$import\\$\"([^\"]*)\"/g, (match, path) => {\r\n        const id = path.includes('/') ? path.substring(path.lastIndexOf('/') + 1) : path;\r\n        if(imports.hasOwnProperty(id) && imports[id] !== path) {\r\n            throw new Error(`Conflicting import paths: \"${path}\" != \"${imports[id]}\"`);\r\n        }\r\n        imports[id] = path;\r\n        return id;\r\n    });\r\n    let prefixes = Object.entries(imports).map(([id, path]) => `import ${id} \"${path}\";`);\r\n    return [prefixes, code];\r\n}\r\n\r\nexport default class MotokoCompiler extends Compiler {\r\n    constructor(editor) {\r\n        super(editor, 'toMotoko');\r\n    }\r\n\r\n    defaultCompile(prop, node) {\r\n        // TODO: refactor these special cases\r\n\r\n        if(identifierType.isSubtype(prop.type)) {\r\n            // console.log(node.name)///\r\n            return nodeIdentifierRef(node, prop.key);\r\n        }\r\n\r\n        if(typeType.isSubtype(prop.type)) {\r\n            let type = prop.type.generics[0];\r\n            if(type && !type.isAbstract()) {\r\n                return this.getTypeString();\r\n            }\r\n        }\r\n    }\r\n\r\n    postCompile(result, node, key) {\r\n        if(typeof result === 'string' || typeof result === 'number' || typeof result === 'boolean' || result === null || result === undefined) {\r\n            return result;\r\n        }\r\n        if(Array.isArray(result)) {\r\n            return result.map(r => this.postCompile(r, node, key)).filter(s => s).join(' ');\r\n        }\r\n        console.warn('Unexpected Motoko expression:', result);\r\n        return String(result);\r\n    }\r\n}","import isEmbedded from '../../utils/isEmbedded';\r\nimport useObservableState from './useObservableState';\r\nimport makeObservable from '../../utils/makeObservable';\r\nimport {useCallback} from 'react';\r\n\r\n// Derived from: https://usehooks.com/useLocalStorage/\r\n\r\nconst storage = isEmbedded() ? {} : window.localStorage;\r\n\r\nconst observableMap = new Map();\r\n\r\nexport function makeLocalStorageObservable(key, defaultValue) {\r\n    if(observableMap.has(key)) {\r\n        throw new Error(`Local storage observable already exists for key: ${key}`);\r\n    }\r\n    let observable;\r\n    try {\r\n        const item = storage[key];\r\n        observable = makeObservable(item ? JSON.parse(item) : defaultValue);\r\n    }\r\n    catch(error) {\r\n        console.error(error);\r\n        observable = makeObservable(defaultValue);\r\n    }\r\n    observableMap.set(key, observable);\r\n    observable.subscribe(value => {\r\n        if(value !== undefined) {\r\n            storage[key] = JSON.stringify(value);\r\n        }\r\n        else {\r\n            delete storage[key];\r\n        }\r\n    });\r\n    return observable;\r\n}\r\n\r\nexport default function useLocalStorage(key, defaultValue) {\r\n\r\n    // Find or create global observable value for key\r\n    const observable = observableMap.get(key) || makeLocalStorageObservable(key, defaultValue);\r\n\r\n    const [storedValue, setStoredValue] = useObservableState(observable);\r\n\r\n    const setValue = useCallback(value => {\r\n        try {\r\n            const valueToStore = value instanceof Function ? value(storedValue) : value;\r\n            setStoredValue(valueToStore);\r\n        }\r\n        catch(error) {\r\n            console.error(error);\r\n        }\r\n    }, [storedValue, setStoredValue]);\r\n\r\n    return [\r\n        storedValue,\r\n        setValue,\r\n        // observable,\r\n    ];\r\n}","import {identifierType, memberType} from '../block-types/types';\r\nimport {stringSelectProp} from './control-patterns';\r\n\r\n\r\nexport function computeMemberName(node, editor) {\r\n    return editor.compilers.motoko.getInput(node, 'name');\r\n\r\n    // let name = editor.compilers.motoko.getInput(node, 'name');\r\n    // if(!name) {\r\n    //     return;\r\n    // }\r\n    // if(!parentNode) {\r\n    //     return name;\r\n    // }\r\n    // let actorName = editor.compilers.motoko.getInput(parentNode, 'name');\r\n    // return actorName?`${actorName}.${name}`:name;\r\n}\r\n\r\nexport function visibilityControlProp() {\r\n    return stringSelectProp({\r\n        key: 'visibility',\r\n        advanced: true,\r\n        // optional: true,\r\n    }, ['public', 'private', 'system']);\r\n}\r\n\r\nexport function memberBlock(block, memberProp) {\r\n    return {\r\n        topLeft: 'member',\r\n        ...block,\r\n        inputs: [\r\n            {\r\n                key: 'name',\r\n                type: identifierType,\r\n            },\r\n            ...block.inputs || [],\r\n        ],\r\n        outputs: [\r\n            {\r\n                key: 'member',\r\n                type: memberType,\r\n                ...memberProp,\r\n            },\r\n            ...block.outputs || [],\r\n        ],\r\n    };\r\n}","import {basename} from 'path';\r\nimport {getType} from '../block-types/types';\r\nimport {defaultCategory, getCategory} from '../block-categories/categories';\r\nimport {advancedProp} from '../block-patterns/control-patterns';\r\n\r\n// Temp: `/utils/jest/requireContextTransform`\r\n// noinspection JSUnresolvedVariable\r\nif(typeof require.context === 'undefined') {\r\n    const fs = require('fs');\r\n    const path = require('path');\r\n\r\n    // noinspection JSUndefinedPropertyAssignment\r\n    require.context = (base = '.', scanSubDirectories = false, regularExpression = /\\.js$/) => {\r\n        const files = {};\r\n\r\n        const readDirectory = (directory) => {\r\n            fs.readdirSync(directory).forEach((file) => {\r\n                const fullPath = path.resolve(directory, file);\r\n                if(fs.statSync(fullPath).isDirectory()) {\r\n                    if(scanSubDirectories) {\r\n                        readDirectory(fullPath);\r\n                    }\r\n                }\r\n                else if(regularExpression.test(fullPath)) {\r\n                    files[fullPath] = true;\r\n                }\r\n            });\r\n        };\r\n\r\n        const Module = (file) => {\r\n            return require(file);\r\n        };\r\n        Module.keys = () => Object.keys(files);\r\n\r\n        readDirectory(path.resolve(__dirname, base));\r\n        return Module;\r\n    };\r\n}\r\n\r\nconst allBlocks = [];\r\nconst blockNames = new Set();\r\n\r\n// noinspection JSUnresolvedFunction\r\nconst blockContext = require.context('../blocks', true, /\\.js$/);\r\nblockContext.keys().forEach(path => {\r\n    let name = basename(path, '.js');\r\n    let block = blockContext(path).default;\r\n    block = {...block}; // HMR fix\r\n    if(block) {\r\n        block.name = name;\r\n        block.info = !block.info || block.info.endsWith('.') ? block.info : `${block.info}.`;\r\n        if(blockNames.has(name)) {\r\n            console.error(`Duplicate block name: ${name}`);\r\n            return;\r\n        }\r\n        block.category = block.category ? getCategory(block.category) : defaultCategory;\r\n        block.props = block.props || {};\r\n        for(let [key, prop] of Object.entries(block.props)) {\r\n            if(prop.key && prop.key !== key) {\r\n                throw new Error(`Prop key mismatch: ${key} != ${prop.key}`);\r\n            }\r\n            prop.key = key;\r\n        }\r\n\r\n        // `outputs` prioritized over `inputs`\r\n        addProps(block, block.outputs, 'output');\r\n        addProps(block, block.inputs, 'input');\r\n        addProps(block, block.controls, 'control');\r\n\r\n        // TODO: refactor to a distant land\r\n        if(!('editor:advanced' in block.props) && Object.values(block.props).find(prop => prop.advanced)) {\r\n            addProp(block, advancedProp(), 'control');\r\n        }\r\n\r\n        // Rearrange block inputs/outputs/controls\r\n        block.inputs = [];\r\n        block.outputs = [];\r\n        block.controls = [];\r\n\r\n        for(let [key, prop] of Object.entries(block.props)) {\r\n            prop.key = key;\r\n            // `output` prioritized over `input`\r\n            if(prop.output) {\r\n                if(!block.outputs.includes(prop)) {\r\n                    block.outputs.push(prop);\r\n                }\r\n            }\r\n            else if(prop.input) {\r\n                if(!block.inputs.includes(prop)) {\r\n                    block.inputs.push(prop);\r\n                }\r\n            }\r\n            else if(prop.control) {\r\n                if(!block.controls.includes(prop)) {\r\n                    block.controls.push(prop);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Type deserialization\r\n        for(let prop of Object.values(block.props)) {\r\n            if(!prop.type && (prop.input || prop.output) && prop.control) {\r\n                throw new Error(`Type not found for ${block.name} : ${prop.key}`);\r\n            }\r\n            if(prop.type) {\r\n                prop.type = getType(prop.type);\r\n            }\r\n        }\r\n\r\n        blockNames.add(block.name);\r\n        allBlocks.push(block);\r\n    }\r\n});\r\n\r\nfunction addProps(block, propList, type) {\r\n    if(propList) {\r\n        for(let prop of propList) {\r\n            if(prop.key && block.props[prop.key] === prop) {\r\n                continue;\r\n            }\r\n            if(block.props.hasOwnProperty(prop.key)) {\r\n                throw new Error(`Duplicate prop in ${block.name}: ${prop.key}`);\r\n            }\r\n            prop[type] = prop[type] || true;\r\n            block.props[prop.key] = prop;\r\n        }\r\n    }\r\n}\r\n\r\nfunction addProp(block, prop, type) {\r\n    if(prop.key && block.props[prop.key] === prop) {\r\n        return;\r\n    }\r\n    if(block.props.hasOwnProperty(prop.key)) {\r\n        throw new Error(`Duplicate prop in ${block.name}: ${prop.key}`);\r\n    }\r\n    prop[type] = prop[type] || true;\r\n    block.props[prop.key] = prop;\r\n}\r\n\r\n\r\nexport const BLOCK_MAP = new Map(allBlocks.map(block => [block.name, block]));\r\n\r\nwindow.BLOCK_MAP = BLOCK_MAP; // Browser debugging\r\n\r\n// Post-initialization\r\nfor(let block of BLOCK_MAP.values()) {\r\n    if(block.shortcuts) {\r\n        block.shortcuts.forEach(s => {\r\n            if(!s.block) {\r\n                throw new Error(`Shortcut in ${block.name} requires a \\`block\\` attribute`);\r\n            }\r\n            s.block = getBlock(s.block);\r\n        });\r\n    }\r\n    else {\r\n        block.shortcuts = [];\r\n    }\r\n}\r\n\r\nexport function getBlock(name) {\r\n    if(!name) {\r\n        throw new Error(`Block cannot be ${name}`);\r\n    }\r\n    if(typeof name === 'string') {\r\n        if(!BLOCK_MAP.has(name)) {\r\n            throw new Error(`Block does not exist: ${name}`);\r\n        }\r\n        return BLOCK_MAP.get(name);\r\n    }\r\n    return name;\r\n}","import {arrayType, boolType, mutableArrayType, typeType, valueType} from '../block-types/types';\r\nimport {importRef} from '../compilers/MotokoCompiler';\r\nimport {collectionCategory} from '../block-categories/categories';\r\nimport {FOR_STORING_DATA} from '../editor/useCases';\r\n\r\nexport const arrayImportRef = importRef('mo:base/Array');\r\n\r\nconst block = {\r\n    title: 'Create Array',\r\n    useCases: [FOR_STORING_DATA],\r\n    category: collectionCategory,\r\n    icon: collectionCategory.data.icon,\r\n    topRight: 'value',\r\n    computeTitle(node, editor) {\r\n        let type = editor.compilers.type.getOutput(node, 'value');\r\n        let mutable = editor.compilers.motoko.getOutput(node, 'mutable'); // TODO: control compiler?\r\n        return type && `new Array [ ${mutable ? 'var ' : ''}${editor.compilers.motoko.getTypeString(type.generics[0])} ]`;\r\n    },\r\n    inputs: [{\r\n        key: 'itemType',\r\n        type: typeType.of(valueType),\r\n    }, {\r\n        key: 'items',\r\n        type: valueType,\r\n        multi: true,\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: arrayType,\r\n        inferType({itemType}, node, compiler) {\r\n            let mutable = compiler.editor.compilers.motoko.getInput(node, 'mutable'); // TODO: simplify\r\n            return (mutable ? mutableArrayType : arrayType).of(itemType);\r\n        },\r\n        toMotoko({mutable, items}) {\r\n            return `[${mutable ? (items.length ? 'var ' : 'var') : ''}${items.join(', ')}]`;\r\n        },\r\n    }],\r\n    controls: [{\r\n        key: 'mutable',\r\n        type: boolType,\r\n    }],\r\n};\r\nexport default block;\r\n","import {literalCategory} from '../block-categories/categories';\r\n\r\nexport function literalBlock(block, type, stringifier) {\r\n    return {\r\n        info: type.data.info,\r\n        category: literalCategory,\r\n        topRight: 'value',\r\n        ...block,\r\n        outputs: [...block.outputs || [], {\r\n            key: 'value',\r\n            type,\r\n            control: true,\r\n            toMotoko({value}) {\r\n                if(value === undefined) {\r\n                    return;\r\n                }\r\n                return String(stringifier ? stringifier(value) : value);\r\n            },\r\n        }],\r\n    };\r\n}","import {useCallback, useEffect, useState} from 'react';\r\n\r\nexport default function useObservableState(observable) {\r\n    const [value, setValueState] = useState(observable.get());\r\n\r\n    // // Subscribe immediately\r\n    // const unsubscribe = useMemo(() => observable.subscribe(setValueState), [observable]);\r\n    //\r\n    // // Unsubscribe on cleanup\r\n    // useEffect(() => unsubscribe, [unsubscribe]);\r\n\r\n    useEffect(() => observable.subscribe(setValueState), [observable]);\r\n\r\n    const setValue = useCallback(value => observable.set(value), [observable]);\r\n\r\n    return [value, setValue];\r\n}\r\n","import {getBlock} from '../editor/blocks';\r\nimport Rete from 'rete';\r\nimport {getType} from '../block-types/types';\r\n\r\nexport class UndefinedInputError extends Error {\r\n    constructor(block, key) {\r\n        super(`${block.name}.${key}`);\r\n    }\r\n}\r\n\r\nexport default class Compiler {\r\n    constructor(editor, compileKey) {\r\n        this.editor = editor;\r\n        this.compileKey = compileKey;\r\n    }\r\n\r\n    // Default output value if `[compileKey]` does not exist on block property\r\n    defaultCompile(prop, node) {\r\n    }\r\n\r\n    // Post-process results from either `prop[compileKey]` or `defaultCompile(..)`\r\n    postCompile(result, node, key) {\r\n        return result;\r\n    }\r\n\r\n    getNode(node, silent = false) {\r\n        if(node instanceof Rete.Node) {\r\n            return node;\r\n        }\r\n        if(!node) {\r\n            throw new Error(`Node cannot be ${JSON.stringify(node)}`);\r\n        }\r\n        let id = String(typeof node === 'string' || typeof node === 'number' ? node : node.id);\r\n        node = this.editor.nodes.find(node => String(node.id) === id);\r\n        if(!node && !silent) {\r\n            throw new Error(`Node does not exist: ${id}`);\r\n        }\r\n        return node;\r\n    }\r\n\r\n    getBlock(node) {\r\n        node = this.getNode(node);\r\n        return getBlock(node.name);\r\n    }\r\n\r\n    getInput(node, key) {\r\n        node = this.getNode(node, true);\r\n        if(!node) {\r\n            return;\r\n        }\r\n        let block = this.getBlock(node);\r\n        if(!block.props.hasOwnProperty(key)) {\r\n            throw new Error(`Prop not found on ${node.name}: ${key}`);\r\n        }\r\n        let prop = block.props[key];\r\n        if(prop.input) {\r\n            if(!prop.type.data.reversed) {\r\n                let input = this._input(node, key);\r\n                if(prop.multi) {\r\n                    return input.connections.map(c => this._compileConnection(c, c.input, c.output, 'outputs'));\r\n                }\r\n                if(input.connections.length) {\r\n                    let c = input.connections[0];\r\n                    return this._compileConnection(c, c.input, c.output, 'outputs');\r\n                }\r\n                if(input.control) {\r\n                    return input.control.getValue();\r\n                    // return this._compileControl(input.control, key);///!!!\r\n                }\r\n            }\r\n            else {\r\n                let output = this._output(node, key);\r\n                if(prop.multi) {\r\n                    return output.connections.map(c => this._compileConnection(c, c.output, c.input, 'inputs'));\r\n                }\r\n                if(output.connections.length) {\r\n                    let c = output.connections[0];\r\n                    return this._compileConnection(c, c.output, c.input, 'inputs');\r\n                }\r\n            }\r\n        }\r\n\r\n        if(prop.control) {\r\n            let control = this._control(node, key);\r\n            return this._compileControl(control, key);\r\n        }\r\n    }\r\n\r\n    getOutput(node, key) {\r\n        node = this.getNode(node, true);\r\n        if(!node) {\r\n            return;\r\n        }\r\n        let prop = this._prop(node, key);\r\n        try {\r\n            let args = this.getInputArgs(node);\r\n            if(!args) {\r\n                return;\r\n            }\r\n            let result;\r\n            if(prop[this.compileKey]) {\r\n                result = prop[this.compileKey](args, node, this);\r\n            }\r\n            else {\r\n                result = this.defaultCompile(prop, node);\r\n            }\r\n            return this.postCompile(result, node, key);\r\n        }\r\n        catch(err) {\r\n            if(err instanceof UndefinedInputError) {\r\n                return;\r\n            }\r\n            console.error(`[${node.name}.${key}]`, err);\r\n            this.editor.trigger('warn', `[${node.name}.${key}] ${err}`);\r\n        }\r\n    }\r\n\r\n    getInputArgs(node) {\r\n        node = this.getNode(node, true);\r\n        let args = {};\r\n        if(!node) {\r\n            return args;\r\n        }\r\n        let block = this.getBlock(node);\r\n        // if(block.__inputArgs?.[this.compileKey]) {\r\n        //     for(let key in block.__inputCache[this.compileKey]) {\r\n        //         delete block.__inputCache[this.compileKey][key];\r\n        //     }// TODO: proper cache invalidation\r\n        //     return block.__inputArgs[this.compileKey];\r\n        // }\r\n        for(let prop of Object.values(block.props)) {\r\n            if(prop.input || prop.control) {\r\n                // let value = this.getInput(node, prop.key);\r\n                // if(value === undefined && !prop.optional) {\r\n                //     this.editor.trigger('warn', `Missing input on ${block.name}: ${prop.key}`);\r\n                //     return;\r\n                // }\r\n                // args[prop.key] = value;\r\n\r\n                let cached = false;\r\n                let cachedValue;\r\n\r\n                Object.defineProperty(args, prop.key, {\r\n                    get: () => {\r\n                        // let cache = block.__inputCache[this.compileKey];\r\n                        // if(cache.hasOwnProperty(prop.key)) {\r\n                        //     return cache[prop.key];\r\n                        // }\r\n                        if(cached) {\r\n                            return cachedValue;\r\n                        }\r\n                        let value = this.getInput(node, prop.key);\r\n                        if(value === undefined && !prop.optional) {\r\n                            value = prop.type?.data.defaultInput?.(prop, node);\r\n                            if(value === undefined && !prop.optional) {\r\n                                throw new UndefinedInputError(block, prop.key);\r\n                            }\r\n                        }\r\n                        // cache[prop.key] = value;\r\n                        cached = true;\r\n                        return value;\r\n                    },\r\n                });\r\n            }\r\n        }\r\n        if(process.env.NODE_ENV !== 'production') {\r\n            // Throw error on missing key\r\n            let target = args;\r\n            args = new Proxy({}, {\r\n                get: (_, key) => {\r\n                    if(!target.hasOwnProperty(key)) {\r\n                        throw new Error(`Unknown input: ${block.name}.${key}`);\r\n                    }\r\n                    return target[key];\r\n                },\r\n            });\r\n        }\r\n        // TODO: refactor caching\r\n        // [block.__inputArgs || (block.__inputArgs = {})][this.compileKey] = args;\r\n        // [block.__inputCache || (block.__inputCache = {})][this.compileKey] = {};\r\n        // this.editor.on('process', ()=>{\r\n        //     for(let key in block.__inputCache) {\r\n        //         delete block.__inputCache[key];\r\n        //     }\r\n        // })///\r\n        return args;\r\n    }\r\n\r\n    // getControl(node, key) {\r\n    //     node = this.getNode(node);\r\n    //     return this._control(node, key).getValue();\r\n    // }\r\n\r\n    getTypeString(type) {\r\n        // console.log('/////', type);///\r\n        type = getType(type);\r\n        return type?.data[this.compileKey]?.(type.generics.map(t => this.getTypeString(t)), this) || type.toTypeString();\r\n    }\r\n\r\n    inferType(node, key) {\r\n        return this.editor.compilers.type.getInput(node, key);\r\n    }\r\n\r\n    _compileConnection(connection, from, to) {\r\n        // let prop = this._prop(to.node, to.key);\r\n        // if(!prop[this.compileKey]) {\r\n        //     throw new Error(`Cannot compile property of ${from.node.name} with key: ${prop.key}`);\r\n        // }\r\n        return this.getOutput(to.node, to.key);\r\n    }\r\n\r\n    _compileControl(control, key) {\r\n        return this.postCompile(control.getValue(), control.getNode(), key);\r\n    }\r\n\r\n    _prop(node, key) {\r\n        let block = this.getBlock(node);\r\n        if(!block.props.hasOwnProperty(key)) {\r\n            throw new Error(`Prop does not exist in ${node.name}: ${key}`);\r\n        }\r\n        return block.props[key];\r\n    }\r\n\r\n    _input(node, key) {\r\n        if(!node.inputs.has(key)) {\r\n            throw new Error(`Input not found on ${node.name}: ${key}`);\r\n        }\r\n        return node.inputs.get(key);\r\n    }\r\n\r\n    _output(node, key) {\r\n        if(!node.outputs.has(key)) {\r\n            throw new Error(`Output not found on ${node.name}: ${key}`);\r\n        }\r\n        return node.outputs.get(key);\r\n    }\r\n\r\n    _control(node, key) {\r\n        if(!node.controls.has(key)) {\r\n            throw new Error(`Control not found on ${node.name}: ${key}`);\r\n        }\r\n        return node.controls.get(key);\r\n    }\r\n}","// Enable selecting input fields without dragging node\r\nexport const bindNodeInput = ref => ref && ref.addEventListener('pointerdown', event => event.stopPropagation());\r\n","import useLocalStorage from '../utils/useLocalStorage';\r\nimport useThemes from '../useThemes';\r\nimport getQueryConfig from '../../utils/getEmbedConfig';\r\nimport {useCallback} from 'react';\r\nimport {THEMES} from '../../editor/themes';\r\n\r\nconst defaultTheme = THEMES[0];\r\n\r\nexport default function useThemeState() {\r\n    const themes = useThemes();\r\n    const [id, setId] = useLocalStorage('blocks.theme', getQueryConfig('theme', defaultTheme.id));\r\n\r\n    return [\r\n        themes.find(theme => theme.id === id) || defaultTheme,\r\n        useCallback(id => setId(id), [setId]),\r\n    ];\r\n}\r\n","// Derived from: https://stackoverflow.com/questions/326069/how-to-identify-if-a-webpage-is-being-loaded-inside-an-iframe-or-directly-into-t\r\n\r\nexport default function isEmbedded() {\r\n    try {\r\n        return window.self !== window.top;\r\n    }\r\n    catch(e) {\r\n        return true;\r\n    }\r\n}\r\n","import {parse} from 'querystring';\r\nimport isEmbedded from './isEmbedded';\r\n\r\nconst config = isEmbedded() ? parse(window.location.search.substring(1)) : {};\r\n\r\nexport default function getEmbedConfig(key, defaultValue) {\r\n    return config.hasOwnProperty(key) ? config[key] : defaultValue;\r\n}\r\n","let replaceRegex = /{([0-9]+)}/g;\r\n\r\nexport function parseCodeBlockInputs(inputs, expression) {\r\n    return (expression || '').replace(replaceRegex, (match, i) => {\r\n        i = +i;\r\n        return i >= 0 && i < inputs.length ? inputs[i] : match;\r\n    });\r\n}\r\n","import React from 'react';\r\nimport useControlValue from '../../../hooks/utils/useControlValue';\r\nimport CodeEditor from '../../monaco/CodeEditor';\r\n\r\n\r\nexport default function CodeControlHandle({control, bindInput}) {\r\n    let [value, setValue] = useControlValue(control);\r\n\r\n    return (\r\n        <div ref={bindInput} style={{height: 150}}>\r\n            <CodeEditor value={value} onChange={setValue}/>\r\n        </div>\r\n    );\r\n}\r\n","export function findNodeSearchOptions(text, editor, componentName, nodeKey) {\r\n    return editor.nodes.flatMap(node => {\r\n        if(node.name === componentName) {\r\n            const title = editor.compilers.motoko.getInput(node, 'name');\r\n            if(title && title.startsWith(text)) {\r\n                return [{\r\n                    title,\r\n                    data: {\r\n                        [nodeKey]: node.id,\r\n                    },\r\n                }];\r\n            }\r\n        }\r\n        return [];\r\n    });\r\n}\r\n","import {memberType} from '../../block-types/types';\r\nimport {resolveImportRefs} from '../MotokoCompiler';\r\nimport prettyPrintMotoko from '../../editor/format/prettyPrintMotoko';\r\nimport {formatParentheses} from '../../editor/format/formatHelpers';\r\nimport {pascalCase} from 'change-case';\r\nimport {compileGlobalParameter} from '../../blocks/MainParameter';\r\n\r\nexport function globalInstallRef(editor) {\r\n    return 'install';\r\n}\r\n\r\nexport function globalObjectRef(editor) {\r\n    return 'this';\r\n}\r\n\r\nconst defaultActorName = 'Main';\r\n\r\nexport default function compileGlobalMotoko(editor) {\r\n\r\n    const memberNodes = editor.nodes\r\n        .filter(node => {\r\n            const io = node.inputs.get('member');\r\n            if(!io || io.connections.length) {\r\n                return false;\r\n            }\r\n            const type = /* reversed */ io.socket.findType?.();\r\n            return type && memberType.isSubtype(type);\r\n        })\r\n        .sort((a, b) => a.position[1] - b.position[1]);\r\n\r\n    const configNodes = editor.nodes\r\n        .filter(node => node.name === 'GlobalParameter');\r\n\r\n    const actorName = pascalCase(editor.projectName) || defaultActorName;\r\n\r\n    const actorClassPart = /*configNodes.length && */`${formatParentheses(configNodes.map(node => {\r\n        // return editor.compilers.motoko.getOutput(node, 'param');\r\n        return compileGlobalParameter(node, editor.compilers.motoko);\r\n    }).join(', '))} = ${globalObjectRef(editor)}`;\r\n\r\n    const actorPart = `shared ${formatParentheses(globalInstallRef(editor))} actor ${actorClassPart ? `class ${actorName}${actorClassPart}` : actorName}`;\r\n\r\n    const [prefixes, actorCode] = resolveImportRefs(`${actorPart} {${memberNodes.map(node => {\r\n        const result = editor.compilers.motoko.getOutput(node, 'member');\r\n        return result ? `\\n  ${result}` : '';\r\n    }).join('\\n')}\\n}`);\r\n\r\n    return prettyPrintMotoko(`${prefixes.length ? prefixes.join('\\n') + '\\n\\n' : ''}${actorCode}`);\r\n}\r\n","import {THEMES} from '../editor/themes';\r\n\r\nexport default function useThemes() {\r\n    return THEMES; // In the future, we could make it possible to import additional themes\r\n}\r\n","export const THEMES = [{\r\n    id: 'dark',\r\n    name: 'Dark',\r\n    parts: ['monospace-labels', 'vibrant-borders'],\r\n    monaco: 'night-owl',\r\n    styledComponents: {},\r\n}, {\r\n//     id: 'light',\r\n//     name: 'Light',\r\n//     parts: ['monospace-labels'],\r\n//     monaco: 'light',\r\n//     styledComponents: {},\r\n// }, {\r\n//     id: 'light-dark',\r\n//     name: 'Light-Dark',\r\n//     parts: ['monospace-labels'],\r\n//     monaco: 'vs-dark',\r\n//     styledComponents: {},\r\n// }, {\r\n    id: 'grey',\r\n    name: 'Blueprint',\r\n    parts: ['monospace-labels'],\r\n    monaco: 'vs-dark',\r\n    styledComponents: {},\r\n}];","import nightOwlTheme from 'monaco-themes/themes/Night Owl.json';\r\n\r\n// Derived from: https://github.com/dfinity/motoko-playground/blob/main/src/config/monacoConfig.js\r\n\r\nexport const MOTOKO_KEYWORDS = [\r\n    'actor', 'and', 'async', 'assert', 'await', 'break', 'case', 'catch', 'class',\r\n    'continue', 'debug', 'else', 'false', 'for', 'func', 'if', 'in', 'import',\r\n    'module', 'not', 'null', 'object', 'or', 'label', 'let', 'loop', 'private',\r\n    'public', 'return', 'shared', 'try', 'throw', 'debug_show', 'query', 'switch',\r\n    'true', 'type', 'var', 'while', 'stable', 'flexible', 'system',\r\n];\r\n\r\nexport const configureMonaco = (monaco) => {\r\n    monaco.editor.defineTheme('night-owl', nightOwlTheme);\r\n\r\n    monaco.languages.register({id: 'motoko'});\r\n    monaco.languages.setLanguageConfiguration('motoko', {\r\n        comments: {\r\n            lineComment: '//',\r\n            blockComment: ['/*', '*/'],\r\n        },\r\n        brackets: [\r\n            ['{', '}'],\r\n            ['[', ']'],\r\n            ['(', ')'],\r\n        ],\r\n        autoClosingPairs: [\r\n            {open: '{', close: '}'},\r\n            {open: '[', close: ']'},\r\n            {open: '(', close: ')'},\r\n            {open: '\"', close: '\"'},\r\n            {open: '<', close: '>'},\r\n        ],\r\n    });\r\n    monaco.languages.setMonarchTokensProvider('motoko', {\r\n        defaultToken: '',\r\n        tokenPostfix: '.mo',\r\n        // prettier-ignore\r\n        keywords: MOTOKO_KEYWORDS,\r\n        accessmodifiers: ['public', 'private', 'shared'],\r\n        // prettier-ignore\r\n        typeKeywords: [\r\n            'Any', 'None', 'Null', 'Bool', 'Int', 'Int8', 'Int16', 'Int32', 'Int64', 'Nat',\r\n            'Nat8', 'Nat16', 'Nat32', 'Nat64', 'Word8', 'Word16', 'Word32', 'Word64', 'Float',\r\n            'Char', 'Text', 'Blob', 'Error', 'Principal',\r\n        ],\r\n        // prettier-ignore\r\n        operators: [\r\n            '=', '<', '>', ':', '<:', '?', '+', '-', '*', '/', '%', '**', '&', '|', '^', '<<', '>>',\r\n            '#', '==', '!=', '>=', '<=', ':=', '+=', '-=', '*=', '/=', '%=', '**=', '&=', '|=',\r\n            '^=', '<<=', '>>=', '#=', '->',\r\n        ],\r\n        symbols: /[=(){}[\\].,:;@#_&\\-<>`?!+*\\\\/]/,\r\n        // C# style strings\r\n        escapes:\r\n            /\\\\(?:[abfnrtv\\\\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,\r\n        tokenizer: {\r\n            root: [\r\n                // identifiers and keywords\r\n                [\r\n                    /[a-zA-Z_$][\\w$]*/,\r\n                    {\r\n                        cases: {\r\n                            '@typeKeywords': 'keyword.type',\r\n                            '@keywords': 'keyword',\r\n                            '@default': 'identifier',\r\n                        },\r\n                    },\r\n                ],\r\n                // whitespace\r\n                {include: '@whitespace'},\r\n\r\n                // delimiters and operators\r\n                [/[{}()[\\]]/, '@brackets'],\r\n                [/[<>](?!@symbols)/, '@brackets'],\r\n                [/@symbols/, {cases: {'@operators': 'operator', '@default': ''}}],\r\n                // numbers\r\n                [/\\d*\\.\\d+([eE][-+]?\\d+)?/, 'number.float'],\r\n                [/0[xX][0-9a-fA-F_]+/, 'number.hex'],\r\n                [/[0-9_]+/, 'number'],\r\n\r\n                // delimiter: after number because of .\\d floats\r\n                [/[;,.]/, 'delimiter'],\r\n\r\n                // strings\r\n                [/\"([^\"\\\\]|\\\\.)*$/, 'string.invalid'], // non-teminated string\r\n                [/\"/, {token: 'string.quote', bracket: '@open', next: '@string'}],\r\n\r\n                // characters\r\n                [/'[^\\\\']'/, 'string'],\r\n                [/(')(@escapes)(')/, ['string', 'string.escape', 'string']],\r\n                [/'/, 'string.invalid'],\r\n            ],\r\n\r\n            comment: [\r\n                [/[^/*]+/, 'comment'],\r\n                [/\\/\\*/, 'comment', '@push'], // nested comment\r\n                ['\\\\*/', 'comment', '@pop'],\r\n                [/[/*]/, 'comment'],\r\n            ],\r\n\r\n            string: [\r\n                [/[^\\\\\"]+/, 'string'],\r\n                [/@escapes/, 'string.escape'],\r\n                [/\\\\./, 'string.escape.invalid'],\r\n                [/\"/, {token: 'string.quote', bracket: '@close', next: '@pop'}],\r\n            ],\r\n\r\n            whitespace: [\r\n                [/[ \\t\\r\\n]+/, 'white'],\r\n                [/\\/\\*/, 'comment', '@comment'],\r\n                [/\\/\\/.*$/, 'comment'],\r\n            ],\r\n        },\r\n    });\r\n};","import MonacoEditor from '@monaco-editor/react';\r\nimport {configureMonaco} from '../../config/configureMonaco';\r\nimport useThemeState from '../../hooks/persistent/useThemeState';\r\n\r\nexport default function CodeEditor({value, onChange, readOnly, ...others}) {\r\n    // const monaco = useMonaco();\r\n    const [theme] = useThemeState();\r\n\r\n    const onEditorChange = (newValue) => {\r\n        onChange?.(newValue);\r\n    };\r\n\r\n    return (\r\n        <MonacoEditor\r\n            // width=\"30vh\"\r\n            // height=\"40vh\"\r\n            theme={theme.monaco || 'vs-dark'}\r\n            defaultLanguage=\"motoko\"\r\n            beforeMount={configureMonaco}\r\n            // onMount={(editor, monaco) => {\r\n            //     setTimeout(() => {\r\n            //         console.log(editor.getAction('editor.action.formatDocument').run());\r\n            //\r\n            //         // console.log(editor.trigger('actor{public func test() : Text {}}', 'editor.action.formatDocument'));\r\n            //     },500);\r\n            // }}\r\n            value={value}\r\n            // path={fileName}\r\n            onChange={onEditorChange}\r\n            options={{\r\n                tabSize: 2,\r\n                minimap: {enabled: false},\r\n                wordWrap: 'off',\r\n                // wrappingIndent: 'indent',\r\n                scrollBeyondLastLine: false,\r\n                fontSize: 16,\r\n                readOnly,\r\n            }}\r\n            {...others}\r\n        />\r\n    );\r\n}","export default function prettyPrintMotoko(text, indent = '\\t') {\r\n    if(!text.trim()) {\r\n        return '';\r\n    }\r\n\r\n    let depth = 0;\r\n\r\n    const lines = text.split('\\n')\r\n        .map(s => s.trim())\r\n        // .flatMap(s => {\r\n        //     s = replaceSyntax(s, '{ ', '{\\n');\r\n        //     s = replaceSyntax(s, ' }', '\\n}');\r\n        //     s = replaceSyntax(s, '; ', ';\\n');\r\n        //     return text.split('\\n');\r\n        // })\r\n        .map(s => {\r\n            s = s.trim();\r\n            if(s.startsWith('}') && depth > 0) {\r\n                depth--;\r\n            }\r\n            s = indent.repeat(depth) + s;\r\n            if(s.endsWith('{')) {\r\n                depth++;\r\n            }\r\n            return s;\r\n        });\r\n\r\n    return lines.join('\\n');\r\n}","import {useContext, useEffect, useState} from 'react';\r\nimport EventsContext, {ERROR_EVENT} from '../../contexts/EventsContext';\r\n\r\nexport default function Loading({promise, loading, error, children}) {\r\n    let [status, setStatus] = useState('loading');\r\n    let [result, setResult] = useState();\r\n\r\n    let events = useContext(EventsContext);\r\n\r\n    useEffect(() => {\r\n        Promise.resolve(promise)\r\n            .then(result => {\r\n                setStatus('success');\r\n                setResult(result);\r\n            })\r\n            .catch(err => {\r\n                setStatus('error');\r\n                setResult(err);\r\n                if(!error) {\r\n                    events.emit(ERROR_EVENT, err);\r\n                }\r\n            });\r\n    }, [promise, error, events]);\r\n\r\n    if(status === 'loading') {\r\n        return loading?.() ?? null;\r\n    }\r\n    if(status === 'error') {\r\n        return error?.(result) ?? null;\r\n    }\r\n    return children?.(result) ?? null;\r\n}","import {Button} from 'react-bootstrap';\r\nimport {FaCopy} from 'react-icons/fa';\r\nimport {CopyToClipboard} from 'react-copy-to-clipboard/lib/Component';\r\nimport React, {useState} from 'react';\r\nimport ReactTooltip from 'react-tooltip';\r\nimport useReactTooltip from '../../hooks/useReactTooltip';\r\n\r\nexport default function CopyToClipboardButton({text, size, buttonRef, ...others}) {\r\n\r\n    const [copied, setCopied] = useState();\r\n\r\n    let tooltipRef;\r\n    const showTooltip = () => {\r\n        setCopied(true);\r\n        ReactTooltip.show(tooltipRef);\r\n        setTimeout(() => /*ReactTooltip.hide(tooltipRef)&*/setCopied(false), 1000);\r\n    };\r\n\r\n    useReactTooltip();\r\n\r\n    return (\r\n        <CopyToClipboard text={text} /* onCopy={() => setCopied(true)} */ >\r\n            <Button\r\n                ref={buttonRef}\r\n                size={size || 'sm'}\r\n                variant=\"outline-light\"\r\n                className=\"d-flex py-2\"\r\n                data-tip={copied ? undefined : 'Copy to Clipboard'}\r\n                onClick={showTooltip}>\r\n                <span ref={ref => tooltipRef = ref} data-tip=\"Copied!\"/>\r\n                <FaCopy/>\r\n            </Button>\r\n        </CopyToClipboard>\r\n    );\r\n}","import React, {useContext, useState} from 'react';\r\nimport EventsContext, {EDITOR_CHANGE_EVENT} from '../../../contexts/EventsContext';\r\nimport useListener from '../../../hooks/utils/useListener';\r\nimport Loading from '../../common/Loading';\r\nimport CopyToClipboardButton from '../../common/CopyToClipboardButton';\r\n\r\nexport default function OutputControlHandle({control, bindInput, query}) {\r\n\r\n    const findValue = async () => {\r\n        try {\r\n            return await query(control, control.getNode(), control.editor);\r\n        }\r\n        catch(err) {\r\n            console.warn(err);\r\n            return `<${err}>`;\r\n        }\r\n    };\r\n\r\n    const [valuePromise, setValuePromise] = useState(findValue);\r\n    // const [copied, setCopied] = useState();\r\n\r\n    const events = useContext(EventsContext);\r\n\r\n    useListener(events, EDITOR_CHANGE_EVENT, () => {\r\n        setValuePromise(findValue());\r\n    });\r\n\r\n    // let tooltipRef;\r\n    // const showTooltip = () => {\r\n    //     setCopied(true);\r\n    //     ReactTooltip.show(tooltipRef);\r\n    //     setTimeout(() => /*ReactTooltip.hide(tooltipRef)&*/setCopied(false), 1000);\r\n    // };\r\n\r\n    // useReactTooltip();\r\n\r\n    return (\r\n        <Loading promise={valuePromise}>\r\n            {value => (value ?? null) && (\r\n                <div className=\"d-flex\">\r\n                    <input\r\n                        type=\"text\"\r\n                        className=\"w-100 small\"\r\n                        readOnly\r\n                        ref={bindInput}\r\n                        value={value || ''}\r\n                    />\r\n                    <CopyToClipboardButton text={value} /* onCopy={() => setCopied(true)} */ >\r\n                        {/*<Button*/}\r\n                        {/*    ref={bindInput}*/}\r\n                        {/*    size=\"sm\"*/}\r\n                        {/*    variant=\"outline-light\"*/}\r\n                        {/*    data-tip={copied ? undefined : 'Copy to Clipboard'}*/}\r\n                        {/*    onClick={showTooltip}>*/}\r\n                        {/*    <span ref={ref => tooltipRef = ref} data-tip=\"Copied!\"/>*/}\r\n                        {/*    <FaCopy/>*/}\r\n                        {/*</Button>*/}\r\n                    </CopyToClipboardButton>\r\n                </div>\r\n            )}\r\n        </Loading>\r\n    );\r\n}\r\n","import {anyReversedType, anyType} from '../block-types/types';\r\nimport OutputControlHandle from '../components/rete/controls/OutputControlHandle';\r\nimport {compilerCategory} from '../block-categories/categories';\r\nimport {resolveImportRefs} from '../compilers/MotokoCompiler';\r\nimport prettyPrintMotoko from '../editor/format/prettyPrintMotoko';\r\n\r\nexport function compileBlock(compilerKey, block, displayFn) {\r\n    function queryFor(inputKey) {\r\n        return (control, node, editor) => {\r\n            let value = editor.compilers[compilerKey].getInput(node, inputKey);\r\n            let string = displayFn ? displayFn(value) : value;\r\n            const [prefixes, code] = resolveImportRefs(string);\r\n            return prettyPrintMotoko([...prefixes, code].join(' '));\r\n        };\r\n    }\r\n\r\n    return {\r\n        category: compilerCategory,\r\n        icon: compilerCategory.data.icon,\r\n        topLeft: 'input',\r\n        topRight: 'reversed',\r\n        ...block,\r\n        inputs: [{\r\n            key: 'input',\r\n            title: 'Input',\r\n            type: anyType,\r\n            optional: true,\r\n        }, {\r\n            key: 'reversed',\r\n            title: 'Input',\r\n            type: anyReversedType,\r\n            optional: true,\r\n        }],\r\n        controls: [{\r\n            key: 'reversedDisplay',\r\n            title: 'Display',\r\n            config: {\r\n                controlType: OutputControlHandle,\r\n                controlProps: {\r\n                    query: queryFor('reversed'),\r\n                },\r\n            },\r\n        }, {\r\n            key: 'display',\r\n            config: {\r\n                controlType: OutputControlHandle,\r\n                controlProps: {\r\n                    query: queryFor('input'),\r\n                },\r\n            },\r\n        }],\r\n    };\r\n}\r\n","import React from 'react';\r\nimport useControlValue from '../../../hooks/utils/useControlValue';\r\nimport classNames from 'classnames';\r\n\r\n\r\nexport default function SelectControlHandle({control, bindInput, options, findLabel}) {\r\n    let [value, setValue] = useControlValue(control);\r\n\r\n    if(value === undefined && !options.includes(value)) {\r\n        value = options[0];\r\n        setValue(value);\r\n    }\r\n\r\n    let invalid = !control.validate(value) || !options.includes(value);\r\n\r\n    return (\r\n        <select\r\n            className={classNames(invalid && 'invalid')}\r\n            ref={bindInput}\r\n            value={value}\r\n            onChange={event => setValue(event.target.value || undefined)}>\r\n            {options.map((option, i) => (\r\n                <option key={i} label={findLabel?.(option, i) ?? option} value={option}/>\r\n            ))}\r\n        </select>\r\n    );\r\n}\r\n","import SelectControlHandle from '../components/rete/controls/SelectControlHandle';\r\nimport {boolType} from '../block-types/types';\r\n\r\nexport function stringSelectProp(prop, options) {\r\n    options = prop.optional ? [undefined, ...options] : options;\r\n    return {\r\n        ...prop,\r\n        config: {\r\n            ...prop.config || {},\r\n            controlType: SelectControlHandle,\r\n            controlProps: {\r\n                options,\r\n                findLabel: (option) => option ? option.charAt(0).toUpperCase() + option.substring(1) : '--',\r\n            },\r\n            controlDefault: options[0],\r\n        },\r\n    };\r\n}\r\n\r\nexport function advancedProp() {\r\n    return {\r\n        key: 'editor:advanced',\r\n        title: 'Advanced',\r\n        type: boolType,\r\n        config: {\r\n            onChange(control) {\r\n                control.editor.updateNode(control.getNode());\r\n            },\r\n        },\r\n    };\r\n}","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 84;","import {\r\n    asyncType,\r\n    boolType,\r\n    effectType,\r\n    functionType,\r\n    paramType,\r\n    principalType,\r\n    tupleType,\r\n    unitType,\r\n} from '../block-types/types';\r\nimport {computeMemberName, memberBlock, visibilityControlProp} from '../block-patterns/member-patterns';\r\nimport {functionCategory} from '../block-categories/categories';\r\nimport nodeIdentifierRef from '../compilers/utils/nodeIdentifierRef';\r\nimport {FOR_BUILDING_API, FOR_REUSABLE_LOGIC} from '../editor/useCases';\r\nimport {formatParentheses, formatStatementBlock} from '../editor/format/formatHelpers';\r\n\r\nconst defaultReturnType = unitType;\r\n\r\nexport function getFunctionReturnType(node, editor) {\r\n    let type = editor.compilers.type.getInput(node, 'body')?.generics[0] || defaultReturnType;\r\n    let query = editor.compilers.control.getInput(node, 'query');\r\n    let visibility = editor.compilers.control.getInput(node, 'visibility');\r\n    if(query || visibility === 'public') {\r\n        type = asyncType.of(type);\r\n    }\r\n    return type;\r\n}\r\n\r\nconst block = memberBlock({\r\n    info: 'Evaluate based on given input parameters',\r\n    useCases: [FOR_BUILDING_API, FOR_REUSABLE_LOGIC],\r\n    category: functionCategory,\r\n    topRight: 'body',\r\n    global: true,\r\n    computeTitle(node, editor) {\r\n        let name = computeMemberName(node, editor);\r\n        // return name;/////\r\n        let {params, body} = editor.compilers.motoko.getInputArgs(node);\r\n        let returnType = getFunctionReturnType(node, editor);\r\n        if(!name && !params.length && !body) {\r\n            return;\r\n        }\r\n        return `${name || ''}(${params.join(', ')})${returnType ? ' : ' + editor.compilers.motoko.getTypeString(returnType) : ''}`;\r\n    },\r\n    shortcuts: [{\r\n        block: 'FunctionCall',\r\n        nodeKey: 'functionNode',\r\n    }, {\r\n        block: 'Return',\r\n        connections: [{\r\n            fromOutput: true,\r\n            from: 'body',\r\n            to: 'statement',\r\n        }],\r\n    }],\r\n    inputs: [{\r\n        key: 'params',\r\n        title: 'Parameters',\r\n        type: paramType,\r\n        multi: true,\r\n    }, {\r\n        key: 'body',\r\n        type: effectType,\r\n        optional: true,\r\n        request: true,\r\n    }],\r\n    outputs: [{\r\n        key: 'caller',\r\n        type: principalType,\r\n        advanced: true,\r\n        toMotoko(args, node, compiler) {\r\n            return `${nodeIdentifierRef(node)}.caller`;\r\n        },\r\n    }, {\r\n        key: 'function',\r\n        type: functionType,\r\n        advanced: true,\r\n        inferType({params}, node, compiler) {\r\n            const returnType = getFunctionReturnType(node, compiler.editor);\r\n            return functionType.of(tupleType.of(...params), returnType);\r\n        },\r\n        toMotoko({name}) {\r\n            return name;\r\n        },\r\n    }],\r\n    controls: [\r\n        visibilityControlProp(),\r\n        {\r\n            key: 'query',\r\n            type: boolType,\r\n            advanced: true,\r\n        },\r\n    ],\r\n}, {\r\n    toMotoko({name, visibility, query, params, body}, node, compiler) {\r\n        let hasCaller = node.outputs.get('caller').connections.length;\r\n\r\n        let shared = !!hasCaller;\r\n        let modifiers = [visibility !== 'system' && visibility, shared && 'shared'].filter(m => m).join(' ');\r\n\r\n        let returnType = getFunctionReturnType(node, compiler.editor);\r\n        let returnString = compiler.getTypeString(returnType);\r\n        return [\r\n            modifiers,\r\n            hasCaller ? nodeIdentifierRef(node) : '',\r\n            query ? 'query' : '',\r\n            `func ${name || ''}${formatParentheses(params.join(', '))}${returnString !== '()' ? ` : ${returnString}` : ''}`,\r\n            formatStatementBlock(body || ''),\r\n        ];\r\n    },\r\n});\r\nexport default block;\r\n","import {identifierType, typeType, valueType} from '../block-types/types';\r\nimport {paramCategory} from '../block-categories/categories';\r\nimport {FOR_CONFIGURATION} from '../editor/useCases';\r\n\r\nexport function compileGlobalParameter(node, compiler) {\r\n    let {name, type} = compiler.getInputArgs(node);\r\n    let typeString = compiler.getTypeString(type) || 'Any';\r\n    return `${name} : ${typeString}`;\r\n}\r\n\r\nconst block = {\r\n    title: 'Config',\r\n    info: 'A top-level input parameter to the smart contract',\r\n    useCases: [FOR_CONFIGURATION],\r\n    topRight: 'value',\r\n    category: paramCategory,\r\n    global: true,\r\n    computeTitle(node, editor) {\r\n        let name = editor.compilers.motoko.getInput(node, 'name');\r\n        let type = editor.compilers.type.getInput(node, 'type');\r\n        return name && `${name} : ${type ? editor.compilers.motoko.getTypeString(type) : 'Any'}`;\r\n    },\r\n    shortcuts: [{\r\n        block: 'MainParameterRead',\r\n        nodeKey: 'configNode',\r\n    }],\r\n    inputs: [{\r\n        key: 'name',\r\n        type: identifierType,\r\n    }, {\r\n        key: 'type',\r\n        type: typeType.of(valueType),\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: valueType,\r\n        toMotoko({name}) {\r\n            return name;\r\n        },\r\n        inferType({type}) {\r\n            return type;\r\n        },\r\n    }],\r\n};\r\nexport default block;","const examples = [\r\n    require('./files/Echo.blocks.json'),\r\n    require('./files/Counter.blocks.json'),\r\n    require('./files/Calculator.blocks.json'),\r\n    // require('./files/WhoAmI.blocks.json'),\r\n    require('./files/PhoneBook.blocks.json'),\r\n    require('./files/ToDoList.blocks.json'),\r\n];\r\n\r\nmodule.exports = {\r\n    getExampleProjects() {\r\n        return examples;\r\n    },\r\n};","var map = {\n\t\"./Actor.js\": 133,\n\t\"./ActorClass.js\": 134,\n\t\"./Add.js\": 135,\n\t\"./And.js\": 136,\n\t\"./ArrayAppend.js\": 137,\n\t\"./ArrayAppended.js\": 138,\n\t\"./ArrayFilter.js\": 139,\n\t\"./ArrayGet.js\": 140,\n\t\"./ArrayMap.js\": 141,\n\t\"./ArrayPrepend.js\": 142,\n\t\"./ArrayPut.js\": 143,\n\t\"./Await.js\": 144,\n\t\"./Class.js\": 145,\n\t\"./CodeReference.js\": 146,\n\t\"./CodeType.js\": 147,\n\t\"./CodeValue.js\": 148,\n\t\"./CollectionGet.js\": 149,\n\t\"./CollectionPut.js\": 150,\n\t\"./CollectionSize.js\": 151,\n\t\"./Comment.js\": 210,\n\t\"./CommentRegion.js\": 211,\n\t\"./CompareEqual.js\": 152,\n\t\"./CompareGreater.js\": 153,\n\t\"./CompareGreaterEqual.js\": 154,\n\t\"./CompareLess.js\": 155,\n\t\"./CompareLessEqual.js\": 156,\n\t\"./CompareNotEqual.js\": 157,\n\t\"./CompileMotoko.js\": 158,\n\t\"./CompileType.js\": 161,\n\t\"./Conditional.js\": 162,\n\t\"./ConditionalValue.js\": 163,\n\t\"./Divide.js\": 164,\n\t\"./DivideInt.js\": 165,\n\t\"./Function.js\": 86,\n\t\"./FunctionCall.js\": 166,\n\t\"./LiteralBool.js\": 167,\n\t\"./LiteralCustomType.js\": 168,\n\t\"./LiteralFloat.js\": 169,\n\t\"./LiteralIdentifier.js\": 170,\n\t\"./LiteralInt.js\": 171,\n\t\"./LiteralNat.js\": 172,\n\t\"./LiteralPair.js\": 173,\n\t\"./LiteralPairType.js\": 174,\n\t\"./LiteralText.js\": 175,\n\t\"./LiteralTuple.js\": 176,\n\t\"./LiteralTupleType.js\": 177,\n\t\"./LiteralType.js\": 178,\n\t\"./LoopForIntRange.js\": 179,\n\t\"./LoopWhile.js\": 180,\n\t\"./MainActor.js\": 181,\n\t\"./MainParameter.js\": 87,\n\t\"./MainParameterRead.js\": 182,\n\t\"./MapGet.js\": 183,\n\t\"./MapPut.js\": 184,\n\t\"./MapRemove.js\": 185,\n\t\"./Multiply.js\": 186,\n\t\"./NewArray.js\": 44,\n\t\"./NewHashMap.js\": 187,\n\t\"./Not.js\": 188,\n\t\"./Null.js\": 189,\n\t\"./Object.js\": 190,\n\t\"./Optional.js\": 191,\n\t\"./OptionalUnwrap.js\": 192,\n\t\"./Or.js\": 193,\n\t\"./Parameter.js\": 194,\n\t\"./ReferenceImport.js\": 195,\n\t\"./ReferencePathName.js\": 196,\n\t\"./Return.js\": 197,\n\t\"./SplitPair.js\": 198,\n\t\"./State.js\": 30,\n\t\"./StateRead.js\": 199,\n\t\"./StateUpdate.js\": 200,\n\t\"./Subtract.js\": 201,\n\t\"./TextConcat.js\": 202,\n\t\"./TextSize.js\": 203,\n\t\"./TypeMember.js\": 204,\n\t\"./TypeMemberReference.js\": 205,\n\t\"./ValueCall.js\": 206,\n\t\"./Variable.js\": 207\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 132;","import {containerType, identifierType, memberType} from '../block-types/types';\r\nimport {actorCategory} from '../block-categories/categories';\r\nimport {formatMembers, formatStatementBlock} from '../editor/format/formatHelpers';\r\n\r\nconst block = {\r\n    info: 'An actor which can be deployed as a smart contract',\r\n    category: actorCategory,\r\n    topLeft: 'actor',\r\n    topRight: 'members',\r\n    // global: true,\r\n    hidden: true,///\r\n    computeTitle(node, editor) {\r\n        let {name} = editor.compilers.motoko.getInputArgs(node);\r\n        return name && `actor ${name}`;\r\n    },\r\n    inputs: [{\r\n        key: 'name',\r\n        type: identifierType,\r\n        optional: true,\r\n    }, {\r\n        key: 'members',\r\n        type: memberType,\r\n        multi: true,\r\n    }],\r\n    outputs: [{\r\n        key: 'actor',\r\n        type: containerType,\r\n        toMotoko({name, members}) {\r\n            return [\r\n                'actor',\r\n                name,\r\n                formatStatementBlock(formatMembers(members)),\r\n            ];\r\n        },\r\n    }],\r\n};\r\nexport default block;","import {identifierType, memberType, paramType, principalType} from '../block-types/types';\r\nimport {actorCategory} from '../block-categories/categories';\r\nimport nodeIdentifierRef from '../compilers/utils/nodeIdentifierRef';\r\nimport {formatMembers, formatParentheses, formatStatementBlock} from '../editor/format/formatHelpers';\r\n\r\n// TODO: subclasses\r\nlet thisName = 'this';\r\n\r\nconst block = {\r\n    info: 'An object-oriented class of actors',\r\n    category: actorCategory,\r\n    topLeft: 'parent',\r\n    topRight: 'members',\r\n    // global: true,\r\n    hidden: true,///\r\n    computeTitle(node, editor) {\r\n        let {name, params} = editor.compilers.motoko.getInputArgs(node);\r\n        if(!name) {\r\n            return;\r\n        }\r\n        return `actor class ${name}${formatParentheses(params.join(', '))}`;\r\n    },\r\n    inputs: [{\r\n        key: 'name',\r\n        type: identifierType,\r\n        optional: true,\r\n    }, {\r\n        key: 'members',\r\n        type: memberType,\r\n        multi: true,\r\n    }, {\r\n        key: 'params',\r\n        type: paramType,\r\n        multi: true,\r\n    }],\r\n    outputs: [{\r\n        key: 'parent',\r\n        type: memberType,\r\n        toMotoko({name, params, members}, node, compiler) {\r\n            let hasCaller = node.outputs.get('caller').connections.length;\r\n\r\n            return `${hasCaller ? `shared (${nodeIdentifierRef(node)}) ` : ''}actor class${name ? ' ' + name : ''}${formatParentheses(params.join(', '))} = ${thisName} ${formatStatementBlock(formatMembers(members))}`;\r\n        },\r\n        // }, {\r\n        //     key: 'this',\r\n        //     type: valueType,\r\n        //     toMotoko({}) {\r\n        //         return thisName;\r\n        //     },\r\n    }, {\r\n        key: 'caller',\r\n        type: principalType,\r\n        toMotoko(args, node, compiler) {\r\n            return `${nodeIdentifierRef(node)}.caller`;\r\n        },\r\n    }],\r\n};\r\nexport default block;","import {arithmeticOperatorBlock} from '../block-patterns/operator-patterns';\r\n\r\nconst block = arithmeticOperatorBlock('+', (a, b) => a + b);\r\nexport default block;\r\n","import {binaryOperatorBlock} from '../block-patterns/operator-patterns';\r\nimport {boolType} from '../block-types/types';\r\n\r\nconst block = binaryOperatorBlock(boolType, 'and', (a, b) => a && b);\r\nexport default block;","import {arrayType, valueType} from '../block-types/types';\r\nimport {statementBlock} from '../block-patterns/statement-patterns';\r\nimport {collectionCategory} from '../block-categories/categories';\r\nimport {arrayImportRef} from './NewArray';\r\nimport {FaRegCaretSquareRight} from 'react-icons/fa';\r\n\r\nconst block = statementBlock({\r\n    title: 'Append (Array)',\r\n    category: collectionCategory,\r\n    icon: FaRegCaretSquareRight,\r\n    inputs: [{\r\n        key: 'array',\r\n        title: 'Array',\r\n        type: arrayType,\r\n    }, {\r\n        key: 'value',\r\n        type: valueType,\r\n    }],\r\n}, ({array, value}) => {\r\n    return `${array} := ${arrayImportRef}.append(${array}, [${value}]);`;\r\n});\r\nexport default block;\r\n","import {arrayType, valueType} from '../block-types/types';\r\nimport {collectionCategory} from '../block-categories/categories';\r\nimport {stateWriteIcon} from './State';\r\nimport {arrayImportRef} from './NewArray';\r\n\r\nconst block = {\r\n    title: 'Appended (Array)',\r\n    category: collectionCategory,\r\n    icon: stateWriteIcon,\r\n    topRight: 'result',\r\n    hidden: true,///\r\n    inputs: [{\r\n        key: 'array',\r\n        type: arrayType,\r\n    }, {\r\n        key: 'item',\r\n        type: valueType,\r\n    }],\r\n    outputs: [{\r\n        key: 'result',\r\n        type: valueType,\r\n        inferType({array}) {\r\n            if(arrayType.isSubtype(array)) {\r\n                return array.generics[0];\r\n            }\r\n        },\r\n        toMotoko({array, item}) {\r\n            return `${arrayImportRef}.append(${array}, ${item});`;\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {arrayType, boolType, effectType, unitType, valueType} from '../block-types/types';\r\nimport {collectionCategory} from '../block-categories/categories';\r\nimport {FaLayerGroup} from 'react-icons/fa';\r\nimport nodeIdentifierRef from '../compilers/utils/nodeIdentifierRef';\r\nimport {arrayImportRef} from './NewArray';\r\nimport {formatCurlyBraces} from '../editor/format/formatHelpers';\r\n\r\nconst block = {\r\n    title: 'Filter Items (Array)',\r\n    category: collectionCategory,\r\n    icon: FaLayerGroup,\r\n    topRight: 'result',\r\n    inputs: [{\r\n        key: 'array',\r\n        type: arrayType,\r\n    }, {\r\n        key: 'body',\r\n        title: 'Filter',\r\n        type: effectType.of(boolType),\r\n    }],\r\n    outputs: [{\r\n        key: 'result',\r\n        type: arrayType,\r\n        inferType({array}) {\r\n            return array;\r\n        },\r\n        toMotoko({array, body}, node, compiler) {\r\n            let type = array?.generics[0] || unitType;\r\n            let typeString = compiler.getTypeString(type);\r\n\r\n            return `${arrayImportRef}.filter<${typeString}>(${array}, func (${nodeIdentifierRef(node)} : ${typeString}) : Bool ${formatCurlyBraces(body)})`;\r\n        },\r\n    }, {\r\n        key: 'item',\r\n        type: valueType,\r\n        inferType({array}) {\r\n            if(arrayType.isSubtype(array)) {\r\n                return array.generics[0];\r\n            }\r\n        },\r\n        toMotoko(_, node, compiler) {\r\n            return nodeIdentifierRef(node);\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {arrayType, natType, valueType} from '../block-types/types';\r\nimport {collectionCategory} from '../block-categories/categories';\r\nimport {stateReadIcon} from './State';\r\n\r\nconst block = {\r\n    title: 'Get (Array)',\r\n    info: 'Get the item at a specific index',\r\n    category: collectionCategory,\r\n    icon: stateReadIcon,\r\n    topRight: 'value',\r\n    // deprecated: true,\r\n    inputs: [{\r\n        key: 'array',\r\n        type: arrayType,\r\n    }, {\r\n        key: 'index',\r\n        type: natType,\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: valueType,\r\n        inferType({array}) {\r\n            if(arrayType.isSubtype(array)) {\r\n                return array.generics[0];\r\n            }\r\n        },\r\n        toMotoko({array, index}) {\r\n            return `${array}[${index}]`;\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {arrayType, effectType, unitType, valueType} from '../block-types/types';\r\nimport {collectionCategory} from '../block-categories/categories';\r\nimport {FaLayerGroup} from 'react-icons/fa';\r\nimport nodeIdentifierRef from '../compilers/utils/nodeIdentifierRef';\r\nimport {arrayImportRef} from './NewArray';\r\nimport {formatCurlyBraces} from '../editor/format/formatHelpers';\r\n\r\nconst block = {\r\n    title: 'Replace Items (Array)',\r\n    info: 'Replace each item based on the given logic',\r\n    category: collectionCategory,\r\n    icon: FaLayerGroup,\r\n    topRight: 'body',\r\n    inputs: [{\r\n        key: 'array',\r\n        type: arrayType,\r\n    }, {\r\n        key: 'body',\r\n        title: 'Replace',\r\n        type: effectType,\r\n    }],\r\n    outputs: [{\r\n        key: 'result',\r\n        type: arrayType,\r\n        inferType({body}) {\r\n            if(effectType.isSubtype(body)) {\r\n                return arrayType.of(body.generics[0]);\r\n            }\r\n        },\r\n        toMotoko({array, body}, node, compiler) {\r\n            let fromType = array?.generics[0] || unitType;\r\n            let toType = compiler.editor.compilers.type.getInput(node, 'body') || unitType;\r\n\r\n            let fromTypeString = compiler.getTypeString(fromType);\r\n            let toTypeString = compiler.getTypeString(toType);\r\n\r\n            return `${arrayImportRef}.map<${fromTypeString}, ${toTypeString}>(${array}, func (${nodeIdentifierRef(node)} : ${fromTypeString}) : ${toTypeString} ${formatCurlyBraces(body)})`;\r\n        },\r\n    }, {\r\n        key: 'item',\r\n        type: valueType,\r\n        inferType({array}) {\r\n            if(arrayType.isSubtype(array)) {\r\n                return array.generics[0];\r\n            }\r\n        },\r\n        toMotoko(_, node, compiler) {\r\n            return nodeIdentifierRef(node);\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {arrayType, valueType} from '../block-types/types';\r\nimport {statementBlock} from '../block-patterns/statement-patterns';\r\nimport {collectionCategory} from '../block-categories/categories';\r\nimport {arrayImportRef} from './NewArray';\r\nimport {FaRegCaretSquareLeft} from 'react-icons/fa';\r\n\r\nconst block = statementBlock({\r\n    title: 'Prepend (Array)',\r\n    info: 'Add an item to the beginning of an array',\r\n    category: collectionCategory,\r\n    icon: FaRegCaretSquareLeft,\r\n    inputs: [{\r\n        key: 'array',\r\n        title: 'Array',\r\n        type: arrayType,\r\n    }, {\r\n        key: 'value',\r\n        type: valueType,\r\n    }],\r\n}, ({array, value}) => {\r\n    return `${array} := ${arrayImportRef}.append([${value}], ${array});`;\r\n});\r\nexport default block;\r\n","import {mutableArrayType, natType, valueType} from '../block-types/types';\r\nimport {statementBlock} from '../block-patterns/statement-patterns';\r\nimport {collectionCategory} from '../block-categories/categories';\r\nimport {stateWriteIcon} from './State';\r\n\r\nconst block = statementBlock({\r\n    title: 'Put (Array)',\r\n    info: 'Set the item at a specific index',\r\n    category: collectionCategory,\r\n    icon: stateWriteIcon,\r\n    // deprecated: true,\r\n    inputs: [{\r\n        key: 'array',\r\n        title: 'Array (mutable)',\r\n        type: mutableArrayType,\r\n    }, {\r\n        key: 'index',\r\n        type: natType,\r\n    }, {\r\n        key: 'value',\r\n        type: valueType,\r\n    }],\r\n}, ({array, index, value}) => {\r\n    return `${array}.put(${index}, ${value});`;\r\n});\r\nexport default block;\r\n","import {valueType} from '../block-types/types';\r\nimport {operatorCategory} from '../block-categories/categories';\r\nimport {formatParentheses} from '../editor/format/formatHelpers';\r\n\r\nconst block = {\r\n    title: '(await a)',\r\n    info: 'Wait for an asynchronous value',\r\n    category: operatorCategory,\r\n    topRight: 'result',\r\n    inputs: [{\r\n        key: 'input',\r\n        // type: asyncType,\r\n        type: valueType,//// Temporary\r\n    }],\r\n    outputs: [{\r\n        key: 'result',\r\n        type: valueType,\r\n        inferType({input}) {\r\n            return input.generics[0];\r\n        },\r\n        toMotoko({input}) {\r\n            return formatParentheses(`await ${input}`);\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {containerType, identifierType, memberType, paramType, principalType} from '../block-types/types';\r\nimport {actorCategory} from '../block-categories/categories';\r\nimport nodeIdentifierRef from '../compilers/utils/nodeIdentifierRef';\r\nimport {formatMembers, formatParentheses, formatStatementBlock} from '../editor/format/formatHelpers';\r\nimport {visibilityControlProp} from '../block-patterns/member-patterns';\r\n\r\n// TODO: subclasses\r\nlet thisName = 'this';\r\n\r\nconst block = {\r\n    info: 'An object-oriented class',\r\n    category: actorCategory,\r\n    topLeft: 'parent',\r\n    topRight: 'members',\r\n    global: true,\r\n    hidden: true,///\r\n    computeTitle(node, editor) {\r\n        let {name, params} = editor.compilers.motoko.getInputArgs(node);\r\n        if(!name) {\r\n            return;\r\n        }\r\n        return `class ${name}${formatParentheses(params.join(', '))}`;\r\n    },\r\n    inputs: [{\r\n        key: 'name',\r\n        type: identifierType,\r\n        optional: true,\r\n    }, {\r\n        key: 'members',\r\n        type: memberType,\r\n        multi: true,\r\n    }, {\r\n        key: 'params',\r\n        type: paramType,\r\n        multi: true,\r\n    }],\r\n    outputs: [{\r\n        key: 'parent',\r\n        type: containerType,\r\n        toMotoko({visibility, name, params, members}, node, compiler) {\r\n            let hasCaller = node.outputs.get('caller').connections.length;\r\n\r\n            return `${visibility} ${hasCaller ? `shared (${nodeIdentifierRef(node)}) ` : ''}class${name ? ' ' + name : ''}${formatParentheses(params.join(', '))} = ${thisName} ${formatStatementBlock(formatMembers(members))}`;\r\n        },\r\n        // }, {\r\n        //     key: 'this',\r\n        //     type: valueType,\r\n        //     toMotoko({}) {\r\n        //         return thisName;\r\n        //     },\r\n    }, /*{\r\n        key: 'caller',\r\n        type: principalType,\r\n        advanced: true,\r\n        toMotoko(args, node, compiler) {\r\n            return `${nodeIdentifierRef(node)}.caller`;\r\n        },\r\n    }, */{\r\n        key: 'self',\r\n        type: principalType,\r\n        advanced: true,\r\n        toMotoko(args, node, compiler) {\r\n            return thisName;\r\n        },\r\n    }],\r\n    controls: [\r\n        visibilityControlProp(),\r\n    ],\r\n};\r\nexport default block;","import {parseCodeBlockInputs} from '../block-patterns/code-patterns';\r\nimport {anyType, referenceType} from '../block-types/types';\r\nimport {expressionCategory} from '../block-categories/categories';\r\nimport CodeControlHandle from '../components/rete/controls/CodeControlHandle';\r\nimport {FOR_CUSTOM_LOGIC} from '../editor/useCases';\r\n\r\nconst block = {\r\n    title: '{ Reference }',\r\n    info: 'Compile an arbitrary reference',\r\n    useCases: [FOR_CUSTOM_LOGIC],\r\n    category: expressionCategory,\r\n    icon: expressionCategory.data.icon,\r\n    topRight: 'result',\r\n    width: 14,\r\n    inputs: [{\r\n        key: 'inputs',\r\n        type: anyType,\r\n        multi: true,\r\n    }],\r\n    outputs: [{\r\n        key: 'result',\r\n        type: referenceType,\r\n        toMotoko({inputs, expression}) {\r\n            return parseCodeBlockInputs(inputs, expression);\r\n        },\r\n    }],\r\n    controls: [{\r\n        key: 'expression',\r\n        config: {\r\n            controlType: CodeControlHandle,\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {parseCodeBlockInputs} from '../block-patterns/code-patterns';\r\nimport {customType, typeType, valueType} from '../block-types/types';\r\nimport {expressionCategory} from '../block-categories/categories';\r\nimport CodeControlHandle from '../components/rete/controls/CodeControlHandle';\r\nimport {FOR_CUSTOM_LOGIC} from '../editor/useCases';\r\n\r\nconst block = {\r\n    title: '{ Type }',\r\n    info: 'Compile an arbitrary type',\r\n    useCases: [FOR_CUSTOM_LOGIC],\r\n    category: expressionCategory,\r\n    icon: expressionCategory.data.icon,\r\n    // topLeft: 'inputs',\r\n    topRight: 'result',\r\n    width: 14,\r\n    inputs: [{\r\n        key: 'inputs',\r\n        type: typeType,\r\n        multi: true,\r\n    }, {\r\n        key: 'type',\r\n        type: typeType.of(valueType),\r\n    }],\r\n    outputs: [{\r\n        key: 'result',\r\n        type: typeType.of(valueType),\r\n        inferType({type}) {\r\n            return type || customType; // TODO: distinct customType\r\n        },\r\n        toMotoko({inputs, expression}) {\r\n            return parseCodeBlockInputs(inputs, expression);\r\n        },\r\n    }],\r\n    controls: [{\r\n        key: 'expression',\r\n        config: {\r\n            controlType: CodeControlHandle,\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {parseCodeBlockInputs} from '../block-patterns/code-patterns';\r\nimport {anyType, typeType, valueType} from '../block-types/types';\r\nimport {expressionCategory} from '../block-categories/categories';\r\nimport CodeControlHandle from '../components/rete/controls/CodeControlHandle';\r\nimport {FOR_CUSTOM_LOGIC} from '../editor/useCases';\r\nimport {formatCurlyBraces} from '../editor/format/formatHelpers';\r\n\r\nconst block = {\r\n    title: '{ Expression }',\r\n    info: 'Compile an arbitrary expression',\r\n    useCases: [FOR_CUSTOM_LOGIC],\r\n    category: expressionCategory,\r\n    icon: expressionCategory.data.icon,\r\n    // topLeft: 'inputs',\r\n    topRight: 'result',\r\n    width: 14,\r\n    inputs: [{\r\n        key: 'inputs',\r\n        type: anyType,\r\n        multi: true,\r\n    }, {\r\n        key: 'type',\r\n        type: typeType.of(valueType),\r\n    }],\r\n    outputs: [{\r\n        key: 'result',\r\n        type: valueType,\r\n        inferType({type}) {\r\n            // return parseInputs(inputs, typeCode);\r\n            return type;\r\n        },\r\n        toMotoko({inputs, expression}) {\r\n            return `do ${formatCurlyBraces(parseCodeBlockInputs(inputs, expression))}`;\r\n        },\r\n    }],\r\n    controls: [{\r\n        key: 'expression',\r\n        config: {\r\n            controlType: CodeControlHandle,\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {collectionType, mapType, optionalType, valueType} from '../block-types/types';\r\nimport {collectionCategory} from '../block-categories/categories';\r\nimport {stateReadIcon} from './State';\r\n\r\nconst block = {\r\n    title: 'Get (Collection)',\r\n    info: 'Retrieve an item corresponding to the given key',\r\n    category: collectionCategory,\r\n    icon: stateReadIcon,\r\n    topRight: 'value',\r\n    hidden: true,\r\n    inputs: [{\r\n        key: 'collection',\r\n        type: collectionType,\r\n    }, {\r\n        key: 'key',\r\n        type: valueType,\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: optionalType.of(valueType),\r\n        inferType({collection}) {\r\n            if(mapType.isSubtype(collection)) {\r\n                return optionalType.of(collection.generics[1]);\r\n            }\r\n        },\r\n        toMotoko({collection, key}) {\r\n            return `${collection}.get(${key})`;\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {valueType} from '../block-types/types';\r\nimport {statementBlock} from '../block-patterns/statement-patterns';\r\nimport {collectionCategory} from '../block-categories/categories';\r\nimport {stateWriteIcon} from './State';\r\n\r\nconst block = statementBlock({\r\n    info: 'Update an item corresponding to the given key',\r\n    title: 'Put (Collection)',\r\n    category: collectionCategory,\r\n    icon: stateWriteIcon,\r\n    hidden: true,\r\n    inputs: [{\r\n        key: 'collection',\r\n        type: collectionCategory,\r\n    }, {\r\n        key: 'key',\r\n        type: valueType,\r\n    }, {\r\n        key: 'value',\r\n        type: valueType,\r\n    }],\r\n}, ({collection, key, value}) => {\r\n    return `${collection}.put(${key}, ${value});`;\r\n});\r\nexport default block;\r\n","import {mapType, natType} from '../block-types/types';\r\nimport {collectionCategory} from '../block-categories/categories';\r\nimport {FaSitemap} from 'react-icons/fa';\r\n\r\nconst block = {\r\n    title: 'Size (Collection)',\r\n    info: 'Determine the size (or length) of a collection',\r\n    category: collectionCategory,\r\n    icon: FaSitemap,\r\n    inputs: [{\r\n        key: 'collection',\r\n        type: mapType,\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: natType,\r\n        toMotoko({map}) {\r\n            return `${map}.size()`;\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {binaryOperatorBlock} from '../block-patterns/operator-patterns';\r\nimport {boolType, valueType} from '../block-types/types';\r\n\r\nconst block = binaryOperatorBlock([valueType, boolType], '==', (a, b) => a === b);\r\nexport default block;\r\n","import {numberComparisonOperatorBlock} from '../block-patterns/operator-patterns';\r\n\r\nconst block = numberComparisonOperatorBlock('>', (a, b) => a > b);\r\nexport default block;\r\n","import {numberComparisonOperatorBlock} from '../block-patterns/operator-patterns';\r\n\r\nconst block = numberComparisonOperatorBlock('>=', (a, b) => a >= b);\r\nexport default block;\r\n","import {numberComparisonOperatorBlock} from '../block-patterns/operator-patterns';\r\n\r\nconst block = numberComparisonOperatorBlock('<', (a, b) => a < b);\r\nexport default block;\r\n","import {numberComparisonOperatorBlock} from '../block-patterns/operator-patterns';\r\n\r\nconst block = numberComparisonOperatorBlock('<=', (a, b) => a <= b);\r\nexport default block;\r\n","import {binaryOperatorBlock} from '../block-patterns/operator-patterns';\r\nimport {boolType, valueType} from '../block-types/types';\r\n\r\nconst block = binaryOperatorBlock([valueType, boolType], '!=', (a, b) => a !== b);\r\nexport default block;\r\n","import {compileBlock} from '../block-patterns/compile-patterns';\r\nimport {FOR_DEBUGGING, FOR_DOCUMENTATION, FOR_LEARNING_MOTOKO} from '../editor/useCases';\r\n\r\nconst block = compileBlock('motoko', {\r\n    title: 'Motoko',\r\n    info: 'Compile an expression to Motoko source code.',\r\n    useCases: [FOR_DEBUGGING, FOR_LEARNING_MOTOKO, FOR_DOCUMENTATION],\r\n    // global: true,\r\n});\r\nexport default block;\r\n","import {compileBlock} from '../block-patterns/compile-patterns';\r\nimport {FOR_DEBUGGING, FOR_DOCUMENTATION, FOR_LEARNING_MOTOKO} from '../editor/useCases';\r\n\r\nconst block = compileBlock('type', {\r\n    title: 'Type',\r\n    info: 'Display the type signature of an expression.',\r\n    useCases: [FOR_DEBUGGING, FOR_LEARNING_MOTOKO, FOR_DOCUMENTATION],\r\n    // global: true,\r\n}, type => type?.toTypeString());\r\nexport default block;\r\n","import {statementBlock} from '../block-patterns/statement-patterns';\r\nimport {boolType, effectType} from '../block-types/types';\r\nimport {formatCurlyBraces, formatParentheses} from '../editor/format/formatHelpers';\r\n\r\nconst block = statementBlock({\r\n    title: 'if() then {} else {}',\r\n    info: 'Evaluate based on a given condition',\r\n    inputs: [{\r\n        key: 'condition',\r\n        type: boolType,\r\n    }, {\r\n        key: 'trueCase',\r\n        title: 'True',\r\n        type: effectType,\r\n        optional: true,\r\n    }, {\r\n        key: 'falseCase',\r\n        title: 'False',\r\n        type: effectType,\r\n        optional: true,\r\n    }],\r\n}, ({condition, trueCase, falseCase}) => {\r\n    if(String(condition) === 'true') {\r\n        return trueCase;\r\n    }\r\n    if(String(condition) === 'false') {\r\n        return falseCase;\r\n    }\r\n\r\n    let falsePart = falseCase ? ['else', formatCurlyBraces(falseCase)] : '';\r\n    return [\r\n        'if',\r\n        formatParentheses(condition),\r\n        formatCurlyBraces(trueCase || ''),\r\n        falsePart,\r\n    ];\r\n});\r\nexport default block;","import {boolType, valueType} from '../block-types/types';\r\nimport {decompositionCategory} from '../block-categories/categories';\r\nimport {formatCurlyBraces, formatParentheses} from '../editor/format/formatHelpers';\r\n\r\nconst block = {\r\n    title: 'Map Bool',\r\n    info: 'Choose a value based on a given condition',\r\n    category: decompositionCategory,\r\n    topLeft: 'condition',\r\n    topRight: 'result',\r\n    inputs: [{\r\n        key: 'condition',\r\n        type: boolType,\r\n    }, {\r\n        key: 'trueCase',\r\n        type: valueType,\r\n    }, {\r\n        key: 'falseCase',\r\n        type: valueType,\r\n    }],\r\n    outputs: [{\r\n        key: 'result',\r\n        type: valueType,\r\n        inferType({trueCase, falseCase}) {\r\n            return trueCase.getSharedType(falseCase);\r\n        },\r\n        toMotoko({condition, trueCase, falseCase}) {\r\n            if(condition === true) {\r\n                return trueCase;\r\n            }\r\n            else if(condition === false) {\r\n                return falseCase;\r\n            }\r\n            return formatParentheses(`if ${formatParentheses(condition)} ${formatCurlyBraces(trueCase)} else ${formatCurlyBraces(falseCase)}`);\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {arithmeticOperatorBlock} from '../block-patterns/operator-patterns';\r\n\r\nconst block = arithmeticOperatorBlock('/', (a, b) => a / b);\r\nexport default block;","import {operatorCategory} from '../block-categories/categories';\r\nimport {intType} from '../block-types/types';\r\nimport {importRef} from '../compilers/MotokoCompiler';\r\n\r\nexport const intImportRef = importRef('mo:base/Int');\r\n\r\nconst block = {\r\n    title: '(a // b)',\r\n    category: operatorCategory,\r\n    topRight: 'result',\r\n    inputs: [{\r\n        key: 'left',\r\n        title: 'a',\r\n        type: intType,\r\n    }, {\r\n        key: 'right',\r\n        title: 'b',\r\n        type: intType,\r\n    }],\r\n    outputs: [{\r\n        key: 'result',\r\n        type: intType,\r\n        toMotoko({left, right}) {\r\n            return `${intImportRef}.div(${left}, ${right})`;\r\n        },\r\n        // inferType({left, right}) {\r\n        //     return left.getSharedType(right);\r\n        // },\r\n    }],\r\n};\r\nexport default block;","import {statementBlock} from '../block-patterns/statement-patterns';\r\nimport {nodeType, valueType} from '../block-types/types';\r\nimport {FaPlayCircle} from 'react-icons/fa';\r\nimport {functionCategory} from '../block-categories/categories';\r\nimport {getFunctionReturnType} from './Function';\r\nimport {FOR_REUSABLE_LOGIC} from '../editor/useCases';\r\nimport {findNodeSearchOptions} from '../block-patterns/search-patterns';\r\n\r\nconst block = statementBlock({\r\n    info: 'Invoke a function in this project',\r\n    title: 'Call Function',\r\n    useCases: [FOR_REUSABLE_LOGIC],\r\n    category: functionCategory,\r\n    icon: FaPlayCircle,\r\n    computeTitle(node, editor) {\r\n        let functionNode = editor.compilers.node.getInput(node, 'functionNode');\r\n        if(!functionNode) {\r\n            return;\r\n        }\r\n        let name = editor.compilers.motoko.getInput(functionNode, 'name');\r\n        let paramNames = editor.compilers.node.getInput(functionNode, 'params')\r\n            .map(n => editor.compilers.motoko.getInput(n, 'name'));\r\n        return name && `${name}(${paramNames.join(', ')})`;\r\n    },\r\n    customSearch(text, {editor}) {\r\n        return findNodeSearchOptions(text, editor, 'Function', 'functionNode');\r\n    },\r\n    inputs: [{\r\n        key: 'args',\r\n        title: 'Inputs',\r\n        type: valueType,\r\n        multi: true, // TODO: separate arg sockets\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        title: 'Result',\r\n        type: valueType,\r\n        inferType(_, node, compiler) {\r\n            let functionNode = compiler.editor.compilers.node.getInput(node, 'functionNode');\r\n            if(!functionNode) {\r\n                return;\r\n            }\r\n            return getFunctionReturnType(functionNode, compiler.editor);\r\n        },\r\n        toMotoko({args}, node, compiler) {\r\n            let functionNode = compiler.editor.compilers.node.getInput(node, 'functionNode');\r\n            if(!functionNode) {\r\n                return;\r\n            }\r\n            let name = compiler.getInput(functionNode, 'name');\r\n            if(!name) {\r\n                return;\r\n            }\r\n            return `${name}(${args.join(', ')})`;\r\n        },\r\n    }],\r\n    controls: [{\r\n        key: 'functionNode',\r\n        type: nodeType.withMeta({block: 'Function'}),\r\n    }],\r\n}, ({functionNode, args}, node, compiler) => {\r\n    let name = compiler.getInput(functionNode, 'name');\r\n    if(!name) {\r\n        return;\r\n    }\r\n    return `ignore ${name}(${args.join(', ')});`;\r\n});\r\nexport default block;\r\n","import {literalBlock} from '../block-patterns/literal-patterns';\r\nimport {boolType} from '../block-types/types';\r\n\r\nconst block = literalBlock({\r\n    title: 'Boolean',\r\n    customSearch(text) {\r\n        for(let value of [true, false]) {\r\n            let title = String(value);\r\n            if(title.startsWith(text.toLowerCase())) {\r\n                return {\r\n                    title,\r\n                    data: {\r\n                        value,\r\n                    },\r\n                };\r\n            }\r\n        }\r\n    },\r\n}, boolType);\r\nexport default block;","import {typeCategory} from '../block-categories/categories';\r\nimport {customType, referenceType, typeType, valueType} from '../block-types/types';\r\nimport {FaPencilAlt} from 'react-icons/fa';\r\n\r\nconst block = {\r\n    title: 'Custom Type',\r\n    info: 'A special user-defined type',\r\n    category: typeCategory,\r\n    topRight: 'value',\r\n    icon: FaPencilAlt,\r\n    hidden: true,////\r\n    inputs: [{\r\n        key: 'reference',\r\n        type: referenceType,\r\n    }, {\r\n        key: 'generics',\r\n        type: typeType.of(valueType),\r\n        multi: true,\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: typeType.of(customType),\r\n        inferType(args, node, compiler) {\r\n            let reference = compiler.editor.compilers.motoko.getInput(node, 'reference');\r\n            let generics = compiler.editor.compilers.type.getInput(node, 'generics');\r\n            if(!reference) {\r\n                return;\r\n            }\r\n            return customType.of(...generics).withMeta({name: reference}); ///\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {literalBlock} from '../block-patterns/literal-patterns';\r\nimport {floatType} from '../block-types/types';\r\n\r\nconst block = literalBlock({\r\n    title: 'Float',\r\n    customSearch(text) {\r\n        const value = +text;\r\n        if(!isNaN(value)) {\r\n            return {\r\n                title: value,\r\n                data: {\r\n                    value,\r\n                },\r\n            };\r\n        }\r\n    },\r\n}, floatType);\r\nexport default block;","import {identifierType} from '../block-types/types';\r\nimport {FaItalic} from 'react-icons/fa';\r\n\r\nconst block = {\r\n    title: 'Name',\r\n    info: identifierType.data.info,\r\n    // category: defaultCategory,\r\n    icon: FaItalic,\r\n    topRight: 'value',\r\n    outputs: [{\r\n        key: 'value',\r\n        type: identifierType,\r\n        control: true,\r\n        toMotoko({value}) {\r\n            return value;\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {literalBlock} from '../block-patterns/literal-patterns';\r\nimport {intType} from '../block-types/types';\r\n\r\nconst block = literalBlock({\r\n    title: 'Integer',\r\n    customSearch(text) {\r\n        const value = +text;\r\n        if(value % 1 === 0) {\r\n            return {\r\n                title: value,\r\n                data: {\r\n                    value,\r\n                },\r\n            };\r\n        }\r\n    },\r\n}, intType);\r\nexport default block;\r\n","import {literalBlock} from '../block-patterns/literal-patterns';\r\nimport {natType} from '../block-types/types';\r\n\r\nconst block = literalBlock({\r\n    title: 'Natural Number',\r\n    customSearch(text) {\r\n        const value = +text;\r\n        if(value >= 0 && value % 1 === 0) {\r\n            return {\r\n                title: value,\r\n                data: {\r\n                    value,\r\n                },\r\n            };\r\n        }\r\n    },\r\n}, natType);\r\nexport default block;\r\n","import {literalCategory} from '../block-categories/categories';\r\nimport {tupleType, valueType} from '../block-types/types';\r\n\r\nconst block = {\r\n    title: 'Pair',\r\n    info: 'An ordered pair of two values',\r\n    category: literalCategory,\r\n    topRight: 'value',\r\n    computeTitle(node, editor) {\r\n        let type = editor.compilers.type.getOutput(node, 'value');//?.generics[0];\r\n        return type && `Pair ${editor.compilers.motoko.getTypeString(type)}`;\r\n    },\r\n    inputs: [{\r\n        key: 'left',\r\n        title: 'a',\r\n        type: valueType,\r\n    }, {\r\n        key: 'right',\r\n        title: 'b',\r\n        type: valueType,\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: tupleType.of(valueType, valueType),\r\n        inferType({left, right}) {\r\n            return tupleType.of(left, right);\r\n        },\r\n        toMotoko({left, right}) {\r\n            return `(${left}, ${right})`;\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {typeCategory} from '../block-categories/categories';\r\nimport {tupleType, typeType, valueType} from '../block-types/types';\r\n\r\nconst block = {\r\n    title: 'Pair of Types',\r\n    info: 'An ordered pair of two types',\r\n    category: typeCategory,\r\n    topRight: 'value',\r\n    computeTitle(node, editor) {\r\n        let type = editor.compilers.type.getOutput(node, 'value');//?.generics[0];\r\n        return type && editor.compilers.motoko.getTypeString(type);\r\n    },\r\n    inputs: [{\r\n        key: 'left',\r\n        title: 'a',\r\n        type: typeType.of(valueType),\r\n    }, {\r\n        key: 'right',\r\n        title: 'b',\r\n        type: typeType.of(valueType),\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: typeType.of(tupleType.of(valueType, valueType)),\r\n        inferType({left, right}) {\r\n            return /*typeType.of(*/tupleType.of(left, right)/*)*/;\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {literalBlock} from '../block-patterns/literal-patterns';\r\nimport {textType} from '../block-types/types';\r\n\r\nconst block = literalBlock({\r\n    title: 'Text',\r\n    customSearch(text) {\r\n        if(text.startsWith('\"') || text.startsWith('\\'')) {\r\n            text = text.slice(1);\r\n            if(text.endsWith('\"') || text.endsWith('\\'')) {\r\n                text = text.slice(-1);\r\n            }\r\n            return {\r\n                title: `\"${text}\"`,\r\n                data: {\r\n                    value: text,\r\n                },\r\n            };\r\n        }\r\n    },\r\n}, textType, JSON.stringify);\r\nexport default block;\r\n","import {literalCategory} from '../block-categories/categories';\r\nimport {tupleType, valueType} from '../block-types/types';\r\n\r\nconst block = {\r\n    title: 'Tuple',\r\n    category: literalCategory,\r\n    topRight: 'value',\r\n    computeTitle(node, editor) {\r\n        let type = editor.compilers.type.getOutput(node, 'value');//?.generics[0];\r\n        return type && `Tuple ${editor.compilers.motoko.getTypeString(type)}`;\r\n    },\r\n    inputs: [{\r\n        key: 'inputs',\r\n        type: valueType,\r\n        multi: true,\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: tupleType,\r\n        inferType({inputs}) {\r\n            return tupleType.of(...inputs);\r\n        },\r\n        toMotoko({inputs}) {\r\n            return `(${inputs.join(', ')})`;\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {typeCategory} from '../block-categories/categories';\r\nimport {tupleType, typeType, valueType} from '../block-types/types';\r\n\r\nconst block = {\r\n    title: 'Tuple of Types',\r\n    category: typeCategory,\r\n    topRight: 'value',\r\n    computeTitle(node, editor) {\r\n        let type = editor.compilers.type.getOutput(node, 'value');//?.generics[0];\r\n        return type && editor.compilers.motoko.getTypeString(type);\r\n    },\r\n    inputs: [{\r\n        key: 'types',\r\n        type: typeType.of(valueType),\r\n        multi: true,\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: typeType.of(tupleType),\r\n        inferType({types}) {\r\n            return /*typeType.of(*/tupleType.of(...types/*.map(t => t.generics[0])*/)/*)*/; // Unwrap Type<?> inputs\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {typeCategory} from '../block-categories/categories';\r\nimport {typeType, valueType} from '../block-types/types';\r\n\r\nconst block = {\r\n    title: 'Type',\r\n    category: typeCategory,\r\n    topRight: 'value',\r\n    outputs: [{\r\n        key: 'value',\r\n        type: typeType.of(valueType),\r\n        control: true,\r\n        inferType({value}) {\r\n            // return typeType.of(value);\r\n            return value;\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {statementBlock} from '../block-patterns/statement-patterns';\r\nimport {boolType, effectType, intType, unitType} from '../block-types/types';\r\nimport {importRef} from '../compilers/MotokoCompiler';\r\nimport nodeIdentifierRef from '../compilers/utils/nodeIdentifierRef';\r\nimport {formatStatementBlock} from '../editor/format/formatHelpers';\r\n\r\nexport const iterImportRef = importRef('mo:base/Iter');\r\n\r\nconst block = statementBlock({\r\n    title: 'for(min..max) {}',\r\n    info: 'Repeat for a range of integers (inclusive)',\r\n    inputs: [{\r\n        key: 'min',\r\n        type: intType,\r\n    }, {\r\n        key: 'max',\r\n        type: intType,\r\n    }, {\r\n        key: 'loop',\r\n        type: effectType.of(unitType),\r\n    }],\r\n    outputs: [{\r\n        key: 'item',\r\n        type: intType,\r\n        toMotoko(_, node) {\r\n            return nodeIdentifierRef(node);\r\n        },\r\n    }],\r\n    controls: [{\r\n        key: 'inclusive',\r\n        type: boolType,\r\n    }],\r\n}, ({min, max, loop, inclusive}, node) => {\r\n    return `for (${nodeIdentifierRef(node)} in ${iterImportRef}.range(${min}, ${inclusive ? max : `(${max}) - 1`})) ${formatStatementBlock()};`;\r\n});\r\nexport default block;","import {statementBlock} from '../block-patterns/statement-patterns';\r\nimport {boolType, effectType, unitType} from '../block-types/types';\r\nimport {formatParentheses, formatStatementBlock} from '../editor/format/formatHelpers';\r\n\r\nconst block = statementBlock({\r\n    title: 'while() {}',\r\n    info: 'Repeat while the condition is true',\r\n    inputs: [{\r\n        key: 'condition',\r\n        type: boolType,\r\n    }, {\r\n        key: 'loop',\r\n        type: effectType.of(unitType),\r\n        optional: true,\r\n    }],\r\n}, ({condition, loop}) => {\r\n    return [\r\n        'while',\r\n        formatParentheses(condition),\r\n        formatStatementBlock(loop ?? ''),\r\n    ];\r\n});\r\nexport default block;","import {containerType} from '../block-types/types';\r\nimport {actorCategory} from '../block-categories/categories';\r\nimport compileGlobalMotoko from '../compilers/utils/compileGlobalMotoko';\r\n\r\nconst block = {\r\n    info: 'The top-level actor for the application. All member blocks reference this actor by default.',\r\n    category: actorCategory,\r\n    topLeft: 'actor',\r\n    // global: true,\r\n    inputs: [],\r\n    outputs: [{\r\n        key: 'actor',\r\n        type: containerType,\r\n        toMotoko(_, node, compiler) {\r\n            return compileGlobalMotoko(compiler.editor);\r\n        },\r\n    }],\r\n};\r\nexport default block;","import {nodeType, valueType} from '../block-types/types';\r\nimport {paramCategory} from '../block-categories/categories';\r\nimport {stateReadIcon} from './State';\r\nimport {FOR_CONFIGURATION} from '../editor/useCases';\r\nimport {findNodeSearchOptions} from '../block-patterns/search-patterns';\r\n\r\nconst block = {\r\n    title: 'Read Config',\r\n    info: 'Get a top-level configuration value',\r\n    useCases: [FOR_CONFIGURATION],\r\n    category: paramCategory,\r\n    icon: stateReadIcon,\r\n    topRight: 'value',\r\n    customSearch(text, {editor}) {\r\n        return findNodeSearchOptions(text, editor, 'MainParameter', 'configNode');\r\n    },\r\n    outputs: [{\r\n        key: 'value',\r\n        type: valueType,\r\n        inferType(args, node, compiler) {\r\n            let configNode = compiler.editor.compilers.node.getInput(node, 'configNode');\r\n            if(!configNode) {\r\n                return;\r\n            }\r\n            return compiler.getInput(configNode, 'type');\r\n        },\r\n        toMotoko(args, node, compiler) {\r\n            let configNode = compiler.editor.compilers.node.getInput(node, 'configNode');\r\n            if(!configNode) {\r\n                return;\r\n            }\r\n            return compiler.getInput(configNode, 'name');\r\n        },\r\n    }],\r\n    controls: [{\r\n        key: 'configNode',\r\n        type: nodeType.withMeta({block: 'MainParameter'}),\r\n    }],\r\n};\r\nexport default block;\r\n","import {mapType, optionalType, valueType} from '../block-types/types';\r\nimport {collectionCategory} from '../block-categories/categories';\r\nimport {stateReadIcon} from './State';\r\n\r\nconst block = {\r\n    title: 'Get (Map)',\r\n    category: collectionCategory,\r\n    icon: stateReadIcon,\r\n    topRight: 'value',\r\n    // deprecated: true,\r\n    inputs: [{\r\n        key: 'map',\r\n        type: mapType,\r\n    }, {\r\n        key: 'key',\r\n        type: valueType,\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: optionalType.of(valueType),\r\n        inferType({map}) {\r\n            if(mapType.isSubtype(map)) {\r\n                return optionalType.of(map.generics[1]);\r\n            }\r\n        },\r\n        toMotoko({map, key}) {\r\n            return `${map}.get(${key})`;\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {mapType, valueType} from '../block-types/types';\r\nimport {statementBlock} from '../block-patterns/statement-patterns';\r\nimport {collectionCategory} from '../block-categories/categories';\r\nimport {stateWriteIcon} from './State';\r\n\r\nconst block = statementBlock({\r\n    title: 'Put (Map)',\r\n    category: collectionCategory,\r\n    icon: stateWriteIcon,\r\n    // deprecated: true,\r\n    inputs: [{\r\n        key: 'map',\r\n        type: mapType,\r\n    }, {\r\n        key: 'key',\r\n        type: valueType,\r\n    }, {\r\n        key: 'value',\r\n        type: valueType,\r\n    }],\r\n}, ({map, key, value}) => {\r\n    return `${map}.put(${key}, ${value});`;\r\n});\r\nexport default block;\r\n","import {mapType, valueType} from '../block-types/types';\r\nimport {statementBlock} from '../block-patterns/statement-patterns';\r\nimport {collectionCategory} from '../block-categories/categories';\r\nimport {FaCompress} from 'react-icons/fa';\r\n\r\nconst block = statementBlock({\r\n    title: 'Remove (Map)',\r\n    category: collectionCategory,\r\n    icon: FaCompress,\r\n    inputs: [{\r\n        key: 'map',\r\n        type: mapType,\r\n    }, {\r\n        key: 'key',\r\n        type: valueType,\r\n    }],\r\n}, ({map, key}) => {\r\n    return `${map}.remove(${key});`;\r\n});\r\nexport default block;\r\n","import {binaryOperatorBlock} from '../block-patterns/operator-patterns';\r\nimport {floatType} from '../block-types/types';\r\n\r\nconst block = binaryOperatorBlock(floatType, '*', (a, b) => a * b);\r\nexport default block;","import {mapType, textType, typeType, valueType} from '../block-types/types';\r\nimport {importRef} from '../compilers/MotokoCompiler';\r\nimport {collectionCategory} from '../block-categories/categories';\r\nimport {FOR_STORING_DATA} from '../editor/useCases';\r\n\r\nexport const hashMapImportRef = importRef('mo:base/HashMap');\r\nconst getKeyImportRef = (type) => importRef(`mo:base/${type.name}`);\r\n\r\n// DEPRECATED: replaced by `NewHashMap`\r\nconst block = {\r\n    title: 'Create Map',\r\n    info: 'Construct an empty HashMap',\r\n    useCases: [FOR_STORING_DATA],\r\n    category: collectionCategory,\r\n    icon: collectionCategory.data.icon,\r\n    topRight: 'value',\r\n    hidden: true,\r\n    computeTitle(node, editor) {\r\n        let type = editor.compilers.type.getOutput(node, 'value');//?.generics[0];\r\n        return type && `new HashMap<${editor.compilers.motoko.getTypeString(type.generics[0])}, ${editor.compilers.motoko.getTypeString(type.generics[1])}>`;\r\n    },\r\n    inputs: [{\r\n        key: 'keyType',\r\n        type: typeType.of(textType), // TODO: other key types\r\n    }, {\r\n        key: 'valueType',\r\n        type: typeType.of(valueType),\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: mapType,\r\n        inferType({valueType}) {\r\n            return mapType.of(textType, valueType);\r\n        },\r\n        toMotoko(args, node, compiler) {\r\n            let {keyType, valueType} = compiler.editor.compilers.type.getInputArgs(node);\r\n            let keyImportRef = getKeyImportRef(keyType);\r\n            let valueTypeString = compiler.getTypeString(valueType);\r\n            return `${hashMapImportRef}.HashMap<Text, ${valueTypeString}>(0, ${keyImportRef}.equal, ${keyImportRef}.hash)`;\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {unaryOperatorBlock} from '../block-patterns/operator-patterns';\r\nimport {boolType} from '../block-types/types';\r\n\r\nconst block = unaryOperatorBlock(boolType, 'not', (a) => !a);\r\nexport default block;\r\n","import {nullType} from '../block-types/types';\r\nimport {literalCategory} from '../block-categories/categories';\r\n\r\nconst block = {\r\n    category: literalCategory,\r\n    topRight: 'value',\r\n    outputs: [{\r\n        key: 'value',\r\n        type: nullType,\r\n        toMotoko() {\r\n            return 'null';\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {containerType, identifierType, memberType, objectType} from '../block-types/types';\r\nimport {actorCategory} from '../block-categories/categories';\r\nimport {formatMembers, formatStatementBlock} from '../editor/format/formatHelpers';\r\nimport {visibilityControlProp} from '../block-patterns/member-patterns';\r\n\r\nconst block = {\r\n    info: objectType.data.info,\r\n    category: actorCategory,\r\n    topLeft: 'parent',\r\n    topRight: 'members',\r\n    // global: true,\r\n    hidden: true,///\r\n    computeTitle(node, editor) {\r\n        let {name} = editor.compilers.motoko.getInputArgs(node);\r\n        return name && `object ${name}`;\r\n    },\r\n    inputs: [{\r\n        key: 'name',\r\n        type: identifierType,\r\n        optional: true,\r\n    }, {\r\n        key: 'members',\r\n        type: memberType,\r\n        multi: true,\r\n    }],\r\n    outputs: [{\r\n        key: 'parent',\r\n        type: containerType,\r\n        toMotoko({visibility, name, members}) {\r\n            return [\r\n                visibility,\r\n                'object',\r\n                name,\r\n                formatStatementBlock(formatMembers(members)),\r\n            ];\r\n        },\r\n    }],\r\n    controls: [\r\n        visibilityControlProp(),\r\n    ],\r\n};\r\nexport default block;","import {optionalType, valueType} from '../block-types/types';\r\nimport {operatorCategory} from '../block-categories/categories';\r\nimport {FOR_ERROR_HANDLING} from '../editor/useCases';\r\n\r\nconst block = {\r\n    title: 'Wrap Optional (?a)',\r\n    info: 'Create an optional version of the input value',\r\n    useCases: [FOR_ERROR_HANDLING],\r\n    category: operatorCategory,\r\n    // topRight: 'result',\r\n    inputs: [{\r\n        key: 'input',\r\n        title: 'Value',\r\n        type: valueType,\r\n    }],\r\n    outputs: [{\r\n        key: 'result',\r\n        type: optionalType,\r\n        inferType({input}) {\r\n            return optionalType.of(input);\r\n        },\r\n        toMotoko({input}) {\r\n            return `(?${input})`;\r\n        },\r\n    }, {\r\n        key: 'null',\r\n        type: optionalType,\r\n        inferType({input}) {\r\n            return optionalType.of(input);\r\n        },\r\n        toMotoko({input}) {\r\n            return 'null';\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {statementBlock} from '../block-patterns/statement-patterns';\r\nimport {effectType, optionalType, valueType} from '../block-types/types';\r\nimport {decompositionCategory} from '../block-categories/categories';\r\nimport nodeIdentifierRef from '../compilers/utils/nodeIdentifierRef';\r\nimport {FOR_ERROR_HANDLING} from '../editor/useCases';\r\nimport {formatParentheses, formatStatementBlock} from '../editor/format/formatHelpers';\r\n\r\nconst block = statementBlock({\r\n    title: 'Unwrap Optional',\r\n    info: 'Run different logic depending on whether an Optional value is null',\r\n    useCases: [FOR_ERROR_HANDLING],\r\n    category: decompositionCategory,\r\n    inputs: [{\r\n        key: 'input',\r\n        type: optionalType,\r\n    }, {\r\n        key: 'valueCase',\r\n        title: 'Value',\r\n        type: effectType,\r\n        optional: true,\r\n    }, {\r\n        key: 'nullCase',\r\n        title: 'Null',\r\n        type: effectType,\r\n        optional: true,\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: valueType,\r\n        inferType({input}) {\r\n            return input;\r\n        },\r\n        toMotoko({input}, node) {\r\n            return nodeIdentifierRef(node);\r\n        },\r\n    }],\r\n}, ({input, valueCase, nullCase}, node) => {\r\n    if(String(input) === 'null') {\r\n        return nullCase;\r\n    }\r\n\r\n    let valuePart = valueCase ? `case (?${nodeIdentifierRef(node)}) {${valueCase}};` : '';\r\n    let nullPart = nullCase ? `case null {${nullCase}};` : '';\r\n\r\n    return [\r\n        'switch',\r\n        formatParentheses(input),\r\n        formatStatementBlock(`${valuePart}${nullPart && ' ' + nullPart}`),\r\n    ];\r\n});\r\nexport default block;","import {binaryOperatorBlock} from '../block-patterns/operator-patterns';\r\nimport {boolType} from '../block-types/types';\r\n\r\nconst block = binaryOperatorBlock(boolType, 'or', (a, b) => a || b);\r\nexport default block;\r\n","import {identifierType, paramType, typeType, valueType} from '../block-types/types';\r\nimport {paramCategory} from '../block-categories/categories';\r\nimport {FOR_REUSABLE_LOGIC} from '../editor/useCases';\r\n\r\nconst block = {\r\n    info: 'An input parameter to a class or function',\r\n    useCases: [FOR_REUSABLE_LOGIC],\r\n    topLeft: 'param',\r\n    topRight: 'value',\r\n    category: paramCategory,\r\n    computeTitle(node, editor) {\r\n        let name = editor.compilers.motoko.getInput(node, 'name');\r\n        let type = editor.compilers.type.getInput(node, 'type');\r\n        return name && `${name} : ${type ? editor.compilers.motoko.getTypeString(type) : 'Any'}`;\r\n    },\r\n    inputs: [{\r\n        key: 'name',\r\n        type: identifierType,\r\n    }, {\r\n        key: 'type',\r\n        type: typeType.of(valueType),\r\n    }],\r\n    outputs: [{\r\n        key: 'param',\r\n        type: paramType,\r\n        toMotoko({name, type}, node, compiler) {\r\n            let typeString = compiler.getTypeString(type) || 'Any';\r\n            return `${name} : ${typeString}`;\r\n        },\r\n    }, {\r\n        key: 'value',\r\n        type: valueType,\r\n        toMotoko({name}) {\r\n            return name;\r\n        },\r\n        inferType({type}) {\r\n            return type;\r\n        },\r\n    }],\r\n};\r\nexport default block;","import {referenceType, textType} from '../block-types/types';\r\nimport {FaItalic} from 'react-icons/fa';\r\nimport {importRef} from '../compilers/MotokoCompiler';\r\nimport {FOR_CUSTOM_LOGIC} from '../editor/useCases';\r\n\r\nconst block = {\r\n    title: 'Import Reference',\r\n    // category: defaultCategory,\r\n    useCases: [FOR_CUSTOM_LOGIC],\r\n    icon: FaItalic,\r\n    topRight: 'value',\r\n    outputs: [{\r\n        key: 'value',\r\n        type: referenceType,\r\n        toMotoko({path}) {\r\n            return importRef(path);\r\n        },\r\n    }],\r\n    controls: [{\r\n        key: 'path',\r\n        type: textType,\r\n        config: {\r\n            validation: {\r\n                minLength: 1,\r\n            },\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {identifierType, referenceType, textType} from '../block-types/types';\r\nimport {FOR_CUSTOM_LOGIC} from '../editor/useCases';\r\n\r\nconst block = {\r\n    title: 'Path',\r\n    // category: defaultCategory,\r\n    useCases: [FOR_CUSTOM_LOGIC],\r\n    topRight: 'reference',\r\n    inputs: [{\r\n        key: 'parent',\r\n        type: textType,\r\n        config: {\r\n            validation: {\r\n                minLength: 1,\r\n            },\r\n        },\r\n    }],\r\n    outputs: [{\r\n        key: 'reference',\r\n        type: referenceType,\r\n        toMotoko({parent, name}) {\r\n            return `${parent}.${name}`;\r\n        },\r\n    }],\r\n    controls: [{\r\n        key: 'name',\r\n        type: identifierType,\r\n        config: {\r\n            validation: {\r\n                minLength: 1,\r\n            },\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {effectType, unitType, valueType} from '../block-types/types';\r\nimport {endStatementBlock} from '../block-patterns/statement-patterns';\r\nimport {functionCategory} from '../block-categories/categories';\r\nimport {FaCaretLeft} from 'react-icons/fa';\r\nimport {FOR_BUILDING_API} from '../editor/useCases';\r\n\r\nconst block = endStatementBlock({\r\n    info: 'End a function\\'s execution path',\r\n    useCases: [FOR_BUILDING_API],\r\n    category: functionCategory,\r\n    icon: FaCaretLeft,\r\n    inputs: [{\r\n        key: 'value',\r\n        type: valueType,\r\n        optional: true,\r\n    }],\r\n    // controls: [{\r\n    //     key: 'functionNode',\r\n    //     config: {\r\n    //         controlType: NodeControlHandle,\r\n    //         controlProps: {\r\n    //             component: 'Function',\r\n    //         },\r\n    //     },\r\n    // }],\r\n}, {\r\n    inferType({value}) {\r\n        return effectType.of(value || unitType);\r\n    },\r\n    toMotoko({value}) {\r\n        return `return${value ? ' ' + value : ''};`;\r\n    },\r\n});\r\nexport default block;","import {decompositionCategory} from '../block-categories/categories';\r\nimport {tupleType, valueType} from '../block-types/types';\r\nimport {formatParentheses} from '../editor/format/formatHelpers';\r\n\r\nconst block = {\r\n    info: 'Access the left and right elements of a pair',\r\n    category: decompositionCategory,\r\n    inputs: [{\r\n        key: 'value',\r\n        title: 'Pair',\r\n        type: tupleType.of(valueType, valueType),\r\n    }],\r\n    outputs: [{\r\n        key: 'left',\r\n        type: valueType,\r\n        inferType({value}) {\r\n            if(value) {\r\n                return value.generics[0];\r\n            }\r\n        },\r\n        toMotoko({value}) {\r\n            return `${formatParentheses(value)}.0`;\r\n        },\r\n    }, {\r\n        key: 'right',\r\n        type: valueType,\r\n        inferType({value}) {\r\n            if(value) {\r\n                return value.generics[1];\r\n            }\r\n        },\r\n        toMotoko({value}) {\r\n            return `${formatParentheses(value)}.1`;\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {nodeType, valueType} from '../block-types/types';\r\nimport {stateCategory} from '../block-categories/categories';\r\nimport {stateReadIcon} from './State';\r\nimport {FOR_BUILDING_API} from '../editor/useCases';\r\nimport {findNodeSearchOptions} from '../block-patterns/search-patterns';\r\n\r\nconst block = {\r\n    title: 'Read State',\r\n    info: 'Get the current value of a state',\r\n    useCases: [FOR_BUILDING_API],\r\n    category: stateCategory,\r\n    icon: stateReadIcon,\r\n    topRight: 'value',\r\n    customSearch(text, {editor}) {\r\n        return findNodeSearchOptions(text, editor, 'State', 'stateNode');\r\n    },\r\n    outputs: [{\r\n        key: 'value',\r\n        type: valueType,\r\n        inferType(args, node, compiler) {\r\n            let stateNode = compiler.editor.compilers.node.getInput(node, 'stateNode');\r\n            if(!stateNode) {\r\n                return;\r\n            }\r\n            return compiler.getInput(stateNode, 'initialValue');\r\n        },\r\n        toMotoko(args, node, compiler) {\r\n            let stateNode = compiler.editor.compilers.node.getInput(node, 'stateNode');\r\n            if(!stateNode) {\r\n                return;\r\n            }\r\n            return compiler.getInput(stateNode, 'name');\r\n        },\r\n    }],\r\n    controls: [{\r\n        key: 'stateNode',\r\n        type: nodeType.withMeta({block: 'State'}),\r\n    }],\r\n};\r\nexport default block;\r\n","import {statementBlock} from '../block-patterns/statement-patterns';\r\nimport {stateCategory} from '../block-categories/categories';\r\nimport {nodeType} from '../block-types/types';\r\nimport {stateWriteIcon} from './State';\r\nimport {FOR_STORING_DATA} from '../editor/useCases';\r\n\r\nconst block = statementBlock({\r\n    title: 'Write State',\r\n    info: 'Set the value of a state',\r\n    useCases: [FOR_STORING_DATA],\r\n    category: stateCategory,\r\n    icon: stateWriteIcon,\r\n    inputs: [{\r\n        key: 'value',\r\n        type: 'Value',\r\n        // optional: true,\r\n    }],\r\n    // outputs: [{\r\n    //     key: 'newValue',\r\n    //     type: 'Value',\r\n    //     toMotoko({node: stateNode, value}, node, compiler) {\r\n    //         let name = compiler.getOutput(stateNode, 'name');\r\n    //         if(!name) {\r\n    //             return;\r\n    //         }\r\n    //         return `(${name} := ${value || '()'})`;\r\n    //     },\r\n    // }],\r\n    controls: [{\r\n        key: 'stateNode',\r\n        type: nodeType.withMeta({block: 'State'}),\r\n    }],\r\n}, ({stateNode, value}, node, compiler) => {\r\n    let name = compiler.getInput(stateNode, 'name');\r\n    if(!name) {\r\n        return;\r\n    }\r\n    return `${name} := ${value};`;\r\n});\r\nexport default block;\r\n","import {arithmeticOperatorBlock} from '../block-patterns/operator-patterns';\r\n\r\nconst block = arithmeticOperatorBlock('-', (a, b) => a - b);\r\nexport default block;\r\n","import {binaryOperatorBlock} from '../block-patterns/operator-patterns';\r\nimport {textType} from '../block-types/types';\r\n\r\nconst block = binaryOperatorBlock(textType, '#', (a, b) => a || b);\r\nexport default block;\r\n","import {natType, textType} from '../block-types/types';\r\nimport {FaSitemap} from 'react-icons/fa';\r\n\r\nconst block = {\r\n    title: 'Length (Text)',\r\n    // category: textCategory,\r\n    icon: FaSitemap,\r\n    inputs: [{\r\n        key: 'text',\r\n        type: textType,\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: natType,\r\n        toMotoko({text}) {\r\n            return `${text}.size()`;\r\n        },\r\n    }],\r\n};\r\nexport default block;\r\n","import {typeType, valueType} from '../block-types/types';\r\nimport {computeMemberName, memberBlock, visibilityControlProp} from '../block-patterns/member-patterns';\r\nimport {typeCategory} from '../block-categories/categories';\r\n\r\nconst block = memberBlock({\r\n    title: 'Named Type',\r\n    info: 'An actor-level type definition',\r\n    category: typeCategory,\r\n    topRight: 'type',\r\n    // global: true,\r\n    hidden: true,////\r\n    shortcuts: [{\r\n        block: 'TypeMemberReference',\r\n        nodeKey: 'typeNode',\r\n    }],\r\n    computeTitle(node, editor) {\r\n        let name = computeMemberName(node, editor);\r\n        let type = editor.compilers.type.getInput(node, 'typeInput');//?.generics[0];\r\n        return type && `${name || '(?)'} = ${editor.compilers.motoko.getTypeString(type)}`;\r\n    },\r\n    inputs: [{\r\n        key: 'typeInput',\r\n        title: 'Definition',\r\n        type: typeType.of(valueType),\r\n    }],\r\n    outputs: [{\r\n        key: 'type',\r\n        type: typeType.of(valueType),\r\n        inferType({name, typeInput}) {\r\n            if(!typeInput.isAbstract()) {\r\n                // return typeType.of(typeInput);\r\n                return typeInput.withMeta({name});///\r\n            }\r\n        },\r\n        // toMotoko({name}) {\r\n        //     return name;\r\n        // },\r\n    }],\r\n    controls: [\r\n        visibilityControlProp(),\r\n    ],\r\n}, {\r\n    toMotoko({visibility, name, typeInput}) {\r\n        let modifiers = [visibility !== 'system' && visibility].filter(m => m).join(' ');\r\n\r\n        return `${modifiers && modifiers + ' '}type ${name} = ${typeInput};`;\r\n    },\r\n});\r\nexport default block;\r\n","import {nodeType, typeType, valueType} from '../block-types/types';\r\nimport {typeCategory} from '../block-categories/categories';\r\nimport {FaAngleRight} from 'react-icons/fa';\r\n\r\nconst block = {\r\n    title: 'Type Reference',\r\n    category: typeCategory,\r\n    icon: FaAngleRight,\r\n    topRight: 'type',\r\n    hidden: true,////\r\n    computeTitle(node, editor) {\r\n        let typeNode = editor.compilers.node.getInput(node, 'typeNode');\r\n        console.log(typeNode);\r\n        if(!typeNode) {\r\n            return;\r\n        }\r\n        return editor.compilers.motoko.getInput(typeNode, 'name');\r\n    },\r\n    outputs: [{\r\n        key: 'type',\r\n        type: typeType.of(valueType),\r\n        inferType(args, node, compiler) {\r\n            let typeNode = compiler.editor.compilers.node.getInput(node, 'typeNode');\r\n            if(!typeNode) {\r\n                return;\r\n            }\r\n            return compiler.editor.compilers.type.getInput(typeNode, 'type');\r\n        },\r\n        // toMotoko({name}) {\r\n        //     return name;\r\n        // },\r\n    }],\r\n    controls: [{\r\n        key: 'typeNode',\r\n        type: nodeType.withMeta({block: 'TypeMember'}),\r\n    }],\r\n};\r\nexport default block;\r\n","import {statementBlock} from '../block-patterns/statement-patterns';\r\nimport {functionType, valueType} from '../block-types/types';\r\nimport {FaRegPlayCircle} from 'react-icons/fa';\r\nimport {functionCategory} from '../block-categories/categories';\r\nimport {FOR_CUSTOM_LOGIC, FOR_REUSABLE_LOGIC} from '../editor/useCases';\r\nimport {formatParentheses} from '../editor/format/formatHelpers';\r\n\r\nconst block = statementBlock({\r\n    title: 'Call Value',\r\n    info: 'Invoke a callable value',\r\n    useCases: [FOR_REUSABLE_LOGIC, FOR_CUSTOM_LOGIC],\r\n    category: functionCategory,\r\n    icon: FaRegPlayCircle,\r\n    inputs: [{\r\n        key: 'callable',\r\n        type: functionType,\r\n    }, {\r\n        key: 'args',\r\n        title: 'Inputs',\r\n        type: valueType,\r\n        multi: true,\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        title: 'Result',\r\n        type: valueType,\r\n        inferType({callable}) {\r\n            if(functionType.isSubtype(callable)) {\r\n                return callable;\r\n            }\r\n            return functionType;///\r\n        },\r\n        toMotoko({callable, args}, node, compiler) {\r\n            return `(${callable})(${args.join(', ')})`;\r\n        },\r\n    }],\r\n}, ({callable, args}, node, compiler) => {\r\n\r\n    return `ignore ${callable}${formatParentheses(args.join(', '))};`;\r\n});\r\nexport default block;\r\n","import {statementBlock} from '../block-patterns/statement-patterns';\r\nimport {identifierType, valueType} from '../block-types/types';\r\nimport {paramCategory} from '../block-categories/categories';\r\nimport nodeIdentifierRef from '../compilers/utils/nodeIdentifierRef';\r\nimport {FOR_REUSABLE_LOGIC} from '../editor/useCases';\r\n\r\nconst block = statementBlock({\r\n    title: 'Local Variable',\r\n    info: 'Store and retrieve data from within a function',\r\n    useCases: [FOR_REUSABLE_LOGIC],\r\n    category: paramCategory,\r\n    inputs: [{\r\n        key: 'name',\r\n        type: identifierType,\r\n        optional: true,\r\n    }, {\r\n        key: 'initialValue',\r\n        type: valueType,\r\n    }],\r\n    outputs: [{\r\n        key: 'value',\r\n        type: valueType,\r\n        inferType({initialValue}) {\r\n            return initialValue;\r\n        },\r\n        toMotoko({name}, node) {\r\n            return name || nodeIdentifierRef(node);\r\n        },\r\n    }],\r\n}, ({name, initialValue}, node) => {\r\n    return `var ${name || nodeIdentifierRef(node)} = ${initialValue};`;\r\n});\r\nexport default block;","import styled from 'styled-components';\r\nimport ReactTooltip from 'react-tooltip';\r\nimport React from 'react';\r\n\r\nconst StyledReactTooltip = styled(ReactTooltip)`\r\n    padding: .5em 1em !important;\r\n\r\n    .multi-line {\r\n        text-align: left !important;\r\n    }\r\n`;\r\n\r\nexport default function GlobalTooltip() {\r\n    // const afterShow = (event) => {\r\n    //     console.log(event);///\r\n    // };\r\n\r\n    return (\r\n        <StyledReactTooltip\r\n            backgroundColor=\"#111\"\r\n            place=\"bottom\"\r\n            delayShow={250}\r\n            // afterShow={afterShow}\r\n            multiline={true}\r\n        />\r\n    );\r\n}\r\n","var _linearGradient;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgGradient(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _linearGradient || (_linearGradient = /*#__PURE__*/React.createElement(\"linearGradient\", {\n    id: \"svg-block-gradient\",\n    width: 0,\n    height: 0,\n    x2: 1,\n    y2: 1\n  }, /*#__PURE__*/React.createElement(\"stop\", {\n    offset: \"0%\",\n    stopColor: \"#00EFFB\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    offset: \"50%\",\n    stopColor: \"#8649E1\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    offset: \"100%\",\n    stopColor: \"#F900E3\"\n  }))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgGradient);\nexport default __webpack_public_path__ + \"static/media/gradient.04de6742.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react';\r\nimport styled from 'styled-components';\r\nimport classNames from 'classnames';\r\nimport {IconContext} from 'react-icons';\r\nimport {ReactComponent as Gradient} from '../../../assets/icons/gradient.svg';\r\n\r\nconst MenuContainer = styled.div`\r\n    background: #FFF;\r\n    margin-bottom: 3px;\r\n    position: relative;\r\n    background-clip: padding-box;\r\n    z-index: 10;\r\n\r\n    :before {\r\n        content: \"\";\r\n        position: absolute;\r\n        left: 0;\r\n        right: 0;\r\n        bottom: 0;\r\n        height: 2px;\r\n        background: linear-gradient(90deg, #00EFFB, #8649E1, #F900E3);\r\n        z-index: -1;\r\n        margin-bottom: -2px;\r\n    }\r\n\r\n`;\r\n\r\nconst HiddenGradient = styled(Gradient)`\r\n    height: 0;\r\n    width: 0;\r\n`;\r\n\r\nexport default function TopMenu({className, children, ...others}) {\r\n    return (\r\n        <MenuContainer className={classNames('top-menu text-secondary d-flex justify-content-start align-items-center', className)} {...others}>\r\n            <HiddenGradient/>\r\n            <IconContext.Provider value={{style: {verticalAlign: 'bottom'/*, transform: 'translateY(-1px)'*/}}}>\r\n                {children}\r\n            </IconContext.Provider>\r\n        </MenuContainer>\r\n    );\r\n}","import React from 'react';\r\nimport classNames from 'classnames';\r\nimport styled from 'styled-components';\r\nimport useReactTooltip from '../../../hooks/useReactTooltip';\r\n\r\nlet ItemContainer = styled.div`\r\n\r\n`;\r\n\r\nexport default function MenuItem({variant, tooltip, className, ...others}) {\r\n    useReactTooltip();\r\n\r\n    return (\r\n        <ItemContainer\r\n            className={classNames('noselect h3 mx-3 px-3 pt-1 pb-2 mb-0 d-inline-block text-center', variant && `text-${variant}`, className)}\r\n            data-tip={tooltip}\r\n            data-delay-show={100}\r\n            {...others}>\r\n        </ItemContainer>\r\n    );\r\n}","import React from 'react';\r\nimport MenuItem from './MenuItem';\r\nimport styled from 'styled-components';\r\nimport classNames from 'classnames';\r\n\r\nlet StyledMenuItem = styled(MenuItem)`\r\n    cursor: pointer;\r\n    border-radius: 10px;\r\n\r\n    &.round {\r\n        border-radius: 50% !important;\r\n        width: 48px;\r\n        height: 48px;\r\n        padding: 0 !important;\r\n    }\r\n\r\n    :hover {\r\n        background: #F0F0F0;\r\n    }\r\n\r\n    :hover > svg {\r\n        fill: url(\"#svg-block-gradient\");\r\n    }\r\n`;\r\n\r\nexport default function MenuButton({children, className, ...others}) {\r\n    return (\r\n        <StyledMenuItem className={classNames('menu-button', className)} {...others}>\r\n            {children}\r\n        </StyledMenuItem>\r\n    );\r\n}","import React, {useCallback} from 'react';\r\nimport {useDropzone} from 'react-dropzone';\r\nimport classNames from 'classnames';\r\n\r\nexport default function FileDropZone({options, onFile, onFileContent, className, children, ...others}) {\r\n\r\n    const onDrop = useCallback(files => {\r\n        if(files.length) {\r\n            const file = files[0];\r\n            onFile?.(file);\r\n            if(onFileContent) {\r\n                const reader = new FileReader();\r\n                reader.onload = (e) => {\r\n                    onFileContent(e.target.result);\r\n                };\r\n                reader.readAsText(file);\r\n            }\r\n        }\r\n    }, [onFile, onFileContent]);\r\n\r\n    const {getRootProps, getInputProps, isDragActive} = useDropzone({\r\n        maxFiles: 1,\r\n        onDrop,\r\n        ...options,\r\n    });\r\n\r\n    return (\r\n        <div className={classNames(className, isDragActive && 'dragging')} {...{...others, ...getRootProps()}}>\r\n            <input {...getInputProps()}/>\r\n            {children}\r\n        </div>\r\n    );\r\n}","import React from 'react';\r\n\r\nexport default React.createContext(null);\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\nimport styled from 'styled-components';\r\n\r\n\r\nconst Container = styled.div`\r\n    :hover {\r\n        background: #0001;\r\n    }\r\n`;\r\n\r\nexport default function MenuModalOption({name, description, className, children, ...others}) {\r\n    return (\r\n        <Container\r\n            className={classNames(className, 'clickable d-flex mt-2 px-3 py-2')} {...others}>\r\n            <div className=\"flex-grow-1\">\r\n                {name && <h4 className=\"fw-normal\">{name}</h4>}\r\n                {description && <div className=\"text-muted\">{description}</div>}\r\n            </div>\r\n            <div>\r\n                {children}\r\n            </div>\r\n        </Container>\r\n    );\r\n}","import React, {useContext} from 'react';\r\nimport EventsContext, {PROJECT_LOAD_EVENT} from '../../contexts/EventsContext';\r\nimport styled from 'styled-components';\r\nimport classNames from 'classnames';\r\nimport {getExampleProjects} from '../../examples/examples';\r\nimport FileDropZone from '../common/FileDropZone';\r\nimport {DROP_ZONE_EXTENSIONS} from './Editor';\r\nimport LoadFileContext from '../../contexts/LoadFileContext';\r\nimport MenuModalOption from '../common/MenuModalOption';\r\n\r\nconst MenuContainer = styled.div`\r\n    padding: 20px;\r\n`;\r\n\r\nconst StyledFileDropZone = styled(FileDropZone)`\r\n    padding: 2em;\r\n    border: 2px #0005 dashed;\r\n\r\n    &.dragging, &:hover {\r\n        background: #0002;\r\n    }\r\n`;\r\n\r\nexport default function LoadProjectModal({className, ...others}) {\r\n\r\n    const events = useContext(EventsContext);\r\n    const loadFile = useContext(LoadFileContext);\r\n\r\n    const examples = getExampleProjects();\r\n\r\n    return (\r\n        <MenuContainer className={classNames('bg-light', className)} {...others}>\r\n            <StyledFileDropZone\r\n                className={classNames('clickable text-center text-muted rounded-3')}\r\n                options={{accept: DROP_ZONE_EXTENSIONS.join(',')}}\r\n                onFileContent={loadFile}>\r\n                <h5>Import a .blocks file . . .</h5>\r\n            </StyledFileDropZone>\r\n            {examples.map((example, i) => (\r\n                <MenuModalOption\r\n                    key={i}\r\n                    name={example.name}\r\n                    description={example.description || '(No description provided)'}\r\n                    onClick={() => events.emit(PROJECT_LOAD_EVENT, example)}>\r\n                </MenuModalOption>\r\n            ))}\r\n        </MenuContainer>\r\n    );\r\n}","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgDownload(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"100%\",\n    height: \"100%\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    xmlSpace: \"preserve\",\n    style: {\n      fillRule: \"evenodd\",\n      clipRule: \"evenodd\",\n      strokeLinejoin: \"round\",\n      strokeMiterlimit: 2\n    },\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M20,15L20,19C20,19.549 19.549,20 19,20C19,20 5,20 5,20C4.451,20 4,19.549 4,19C4,19 4,15 4,15C4,14.448 3.552,14 3,14C2.448,14 2,14.448 2,15L2,19C2,20.646 3.354,22 5,22L19,22C20.646,22 22,20.646 22,19L22,15C22,14.448 21.552,14 21,14C20.448,14 20,14.448 20,15Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11,12.586L7.707,9.293C7.317,8.903 6.683,8.903 6.293,9.293C5.903,9.683 5.903,10.317 6.293,10.707L11.293,15.707C11.413,15.827 11.556,15.91 11.708,15.957L11.711,15.958C11.795,15.983 11.884,15.998 11.976,16L12,16L12.024,16C12.116,15.998 12.205,15.983 12.289,15.958L12.292,15.957C12.444,15.91 12.587,15.827 12.707,15.707L17.707,10.707C18.097,10.317 18.097,9.683 17.707,9.293C17.317,8.903 16.683,8.903 16.293,9.293L13,12.586L13,3C13,2.448 12.552,2 12,2C11.448,2 11,2.448 11,3L11,12.586Z\"\n  }))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgDownload);\nexport default __webpack_public_path__ + \"static/media/download.9a79f24e.svg\";\nexport { ForwardRef as ReactComponent };","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgFilePlus(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"100%\",\n    height: \"100%\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    xmlSpace: \"preserve\",\n    style: {\n      fillRule: \"evenodd\",\n      clipRule: \"evenodd\",\n      strokeLinejoin: \"round\",\n      strokeMiterlimit: 2\n    },\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M21,8L21,7.988C20.998,7.807 20.947,7.637 20.861,7.492C20.819,7.42 20.767,7.353 20.707,7.293L14.707,1.293C14.647,1.233 14.58,1.181 14.508,1.139C14.362,1.053 14.193,1.002 14.012,1L14,1L6,1C4.354,1 3,2.354 3,4L3,20C3,21.646 4.354,23 6,23L18,23C19.646,23 21,21.646 21,20L21,8ZM13,3L6,3C5.451,3 5,3.451 5,4C5,4 5,20 5,20C5,20.549 5.451,21 6,21C6,21 18,21 18,21C18.549,21 19,20.549 19,20L19,9L14,9C13.448,9 13,8.552 13,8L13,3ZM11,14L9,14C8.448,14 8,14.448 8,15C8,15.552 8.448,16 9,16L11,16L11,18C11,18.552 11.448,19 12,19C12.552,19 13,18.552 13,18L13,16L15,16C15.552,16 16,15.552 16,15C16,14.448 15.552,14 15,14L13,14L13,12C13,11.448 12.552,11 12,11C11.448,11 11,11.448 11,12L11,14ZM15,7L17.586,7L15,4.414L15,7Z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgFilePlus);\nexport default __webpack_public_path__ + \"static/media/file-plus.c3f75220.svg\";\nexport { ForwardRef as ReactComponent };","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgFolder(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"100%\",\n    height: \"100%\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    xmlSpace: \"preserve\",\n    style: {\n      fillRule: \"evenodd\",\n      clipRule: \"evenodd\",\n      strokeLinejoin: \"round\",\n      strokeMiterlimit: 2\n    },\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M23,19L23,8C23,6.354 21.646,5 20,5L11.535,5C11.535,5 9.832,2.445 9.832,2.445C9.647,2.167 9.334,2 9,2L4,2C2.354,2 1,3.354 1,5L1,19C1,20.646 2.354,22 4,22L20,22C21.646,22 23,20.646 23,19ZM21,19C21,19.549 20.549,20 20,20C20,20 4,20 4,20C3.451,20 3,19.549 3,19L3,5C3,4.451 3.451,4 4,4C4,4 8.465,4 8.465,4C8.465,4 10.168,6.555 10.168,6.555C10.353,6.833 10.666,7 11,7L20,7C20.549,7 21,7.451 21,8C21,8 21,19 21,19Z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgFolder);\nexport default __webpack_public_path__ + \"static/media/folder.fe3b16f3.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgFolderWide(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"100%\",\n    height: \"100%\",\n    viewBox: \"0 0 30 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    xmlSpace: \"preserve\",\n    style: {\n      fillRule: \"evenodd\",\n      clipRule: \"evenodd\",\n      strokeLinejoin: \"round\",\n      strokeMiterlimit: 2\n    },\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Artboard1\",\n    transform: \"matrix(1.25,0,0,1,0,0)\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    x: 0,\n    y: 0,\n    width: 24,\n    height: 24,\n    style: {\n      fill: \"none\"\n    }\n  }), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    transform: \"matrix(0.8,0,0,1,2.4,0)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M23,19L23,8C23,6.354 21.646,5 20,5L11.535,5C11.535,5 9.832,2.445 9.832,2.445C9.647,2.167 9.334,2 9,2L4,2C2.354,2 1,3.354 1,5C1,5 1,19 1,19C1,20.646 2.354,22 4,22L20,22C21.646,22 23,20.646 23,19ZM21,19C21,19.549 20.549,20 20,20C20,20 4,20 4,20C3.451,20 3,19.549 3,19L3,5C3,4.451 3.451,4 4,4C4,4 8.465,4 8.465,4C8.465,4 10.168,6.555 10.168,6.555C10.353,6.833 10.666,7 11,7L20,7C20.549,7 21,7.451 21,8L21,19Z\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgFolderWide);\nexport default __webpack_public_path__ + \"static/media/folder-wide.231dfb87.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgFolderOpen(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"100%\",\n    height: \"100%\",\n    viewBox: \"0 0 30 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    xmlSpace: \"preserve\",\n    style: {\n      fillRule: \"evenodd\",\n      clipRule: \"evenodd\",\n      strokeLinejoin: \"round\",\n      strokeMiterlimit: 2\n    },\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Artboard1\",\n    transform: \"matrix(1.25,0,0,1,0,0)\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    x: 0,\n    y: 0,\n    width: 24,\n    height: 24,\n    style: {\n      fill: \"none\"\n    }\n  }), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    transform: \"matrix(0.8,0,0,1,0,0)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M5.8,21.747C5.825,21.769 5.851,21.789 5.878,21.809C6.059,21.941 6.27,22.003 6.479,22L6.527,21.998C6.572,21.995 6.617,21.99 6.661,21.981C6.772,21.993 6.885,22 7,22L23,22C23.32,22 23.621,21.847 23.809,21.588L29.597,13.621C29.818,13.317 29.85,12.914 29.679,12.579C29.509,12.244 29.164,12.033 28.788,12.033L25.939,12.033L26,8C26,6.354 24.646,5 23,5L14.535,5C14.535,5 12.832,2.445 12.832,2.445C12.647,2.167 12.334,2 12,2L7,2C5.354,2 4,3.354 4,5C4,5 4,19 4,19C4,20.22 4.745,21.28 5.8,21.747ZM8.428,20L12.763,14.033L26.826,14.033C26.826,14.033 22.49,20 22.49,20L8.428,20ZM23.939,12.033C23.961,10.57 24,7.993 24,7.987C23.993,7.444 23.544,7 23,7L14,7C13.666,7 13.353,6.833 13.168,6.555C13.168,6.555 11.465,4 11.465,4C11.465,4 7,4 7,4C6.451,4 6,4.451 6,5L6,19C6,19.238 6.085,19.457 6.225,19.629L11.445,12.445L11.445,12.445C11.627,12.196 11.922,12.033 12.254,12.033L23.939,12.033Z\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgFolderOpen);\nexport default __webpack_public_path__ + \"static/media/folder-open.81301dea.svg\";\nexport { ForwardRef as ReactComponent };","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgSave(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"100%\",\n    height: \"100%\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    xmlSpace: \"preserve\",\n    style: {\n      fillRule: \"evenodd\",\n      clipRule: \"evenodd\",\n      strokeLinejoin: \"round\",\n      strokeMiterlimit: 2\n    },\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M19,22C20.646,22 22,20.646 22,19L22,8C22,7.735 21.895,7.48 21.707,7.293L16.707,2.293C16.52,2.105 16.265,2 16,2L5,2C3.354,2 2,3.354 2,5L2,19C2,20.646 3.354,22 5,22L19,22ZM8,4L8,7L15,7C15.552,7 16,7.448 16,8C16,8.552 15.552,9 15,9L7,9C6.448,9 6,8.552 6,8L6,4L5,4C4.451,4 4,4.451 4,5C4,5 4,19 4,19C4,19.549 4.451,20 5,20L6,20L6,13C6,12.448 6.448,12 7,12L17,12C17.552,12 18,12.448 18,13L18,20L19,20C19.549,20 20,19.549 20,19C20,19 20,8.414 20,8.414C20,8.414 15.586,4 15.586,4L8,4ZM8,20L16,20L16,14C16,14 8,14 8,14L8,20Z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSave);\nexport default __webpack_public_path__ + \"static/media/save.5b65bc79.svg\";\nexport { ForwardRef as ReactComponent };","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgCrosshair(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"100%\",\n    height: \"100%\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    xmlSpace: \"preserve\",\n    style: {\n      fillRule: \"evenodd\",\n      clipRule: \"evenodd\",\n      strokeLinejoin: \"round\",\n      strokeMiterlimit: 2\n    },\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12,1C5.929,1 1,5.929 1,12C1,18.071 5.929,23 12,23C18.071,23 23,18.071 23,12C23,12 23,11.964 23,11.964C22.998,11.52 22.971,11.076 22.916,10.634C22.823,9.889 22.654,9.153 22.411,8.442C22.144,7.662 21.789,6.913 21.354,6.213C20.907,5.492 20.377,4.823 19.777,4.223C19.177,3.623 18.508,3.093 17.787,2.646C17.087,2.211 16.338,1.856 15.558,1.589C14.836,1.342 14.089,1.171 13.331,1.08C12.89,1.027 12.445,1.001 12,1ZM13,3.055L13,6C13,6.552 12.552,7 12,7C11.448,7 11,6.552 11,6L11,3.055C6.831,3.516 3.517,6.831 3.055,11L6,11C6.552,11 7,11.448 7,12C7,12.552 6.552,13 6,13L3.055,13C3.516,17.169 6.831,20.483 11,20.945L11,18C11,17.448 11.448,17 12,17C12.552,17 13,17.448 13,18L13,20.945C17.169,20.484 20.483,17.169 20.945,13L18,13C17.448,13 17,12.552 17,12C17,11.448 17.448,11 18,11L20.945,11C20.484,6.831 17.169,3.517 13,3.055Z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgCrosshair);\nexport default __webpack_public_path__ + \"static/media/crosshair.dd422401.svg\";\nexport { ForwardRef as ReactComponent };","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgLearning(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"100%\",\n    height: \"100%\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    xmlSpace: \"preserve\",\n    style: {\n      fillRule: \"evenodd\",\n      clipRule: \"evenodd\",\n      strokeLinejoin: \"round\",\n      strokeMiterlimit: 2\n    },\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.045,9.517L4.045,18.022C4.045,18.137 4.065,18.249 4.101,18.352L4.104,18.36C4.141,18.463 4.195,18.562 4.268,18.652C5.445,20.102 7.827,22.949 12,22.949C16.173,22.949 18.555,20.102 19.732,18.652C19.805,18.562 19.859,18.463 19.896,18.36L19.899,18.352C19.935,18.249 19.955,18.137 19.955,18.022L19.955,14.524C19.955,13.972 19.507,13.524 18.955,13.524C18.403,13.524 17.955,13.972 17.955,14.524L17.955,17.667C16.949,18.898 15.117,20.949 12,20.949C8.883,20.949 7.051,18.898 6.045,17.667L6.045,10.569L11.535,13.454C11.826,13.607 12.174,13.607 12.465,13.454L21.017,8.959L21.017,14.524C21.017,15.076 21.465,15.524 22.017,15.524C22.569,15.524 23.017,15.076 23.017,14.524L23.017,7.366C23.017,7.356 23.017,7.345 23.016,7.335C23.017,7.325 23.017,7.314 23.017,7.304C23.017,6.932 22.811,6.592 22.482,6.419L12.465,1.154C12.174,1.001 11.826,1.001 11.535,1.154L1.518,6.419C1.189,6.592 0.983,6.932 0.983,7.304C0.983,7.675 1.189,8.016 1.518,8.189L4.045,9.517ZM12,3.169L19.867,7.304C19.867,7.304 12,11.439 12,11.439C12,11.439 4.133,7.304 4.133,7.304L12,3.169Z\"\n  }))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgLearning);\nexport default __webpack_public_path__ + \"static/media/learning.17e086e5.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _path2;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgSettings(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"100%\",\n    height: \"100%\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    xmlSpace: \"preserve\",\n    style: {\n      fillRule: \"evenodd\",\n      clipRule: \"evenodd\",\n      strokeLinejoin: \"round\",\n      strokeMiterlimit: 2\n    },\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12,8C9.792,8 8,9.792 8,12C8,14.208 9.792,16 12,16C14.208,16 16,14.208 16,12C16,9.792 14.208,8 12,8ZM12,10C13.104,10 14,10.896 14,12C14,13.104 13.104,14 12,14C10.896,14 10,13.104 10,12C10,10.896 10.896,10 12,10Z\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M20.913,15L21,15L21.077,14.999C22.688,14.958 24,13.62 24,12C24,10.354 22.646,9 21,9C21.018,9 21.035,9 21.052,9.001L20.997,9L20.831,9C20.615,8.998 20.416,8.889 20.298,8.713C20.284,8.646 20.263,8.58 20.235,8.516C20.128,8.274 20.179,7.989 20.365,7.799C20.177,7.992 20.415,7.749 20.415,7.749L20.417,7.748C20.98,7.185 21.297,6.421 21.297,5.625C21.297,4.829 20.98,4.065 20.417,3.503C19.855,2.94 19.091,2.623 18.295,2.623C17.499,2.623 16.735,2.94 16.172,3.503L16.171,3.505L16.171,3.505L16.114,3.562C15.925,3.742 15.644,3.791 15.404,3.685C15.4,3.684 15.397,3.682 15.394,3.681C15.156,3.579 15.001,3.345 15,3.086C15.001,3.352 15,3.249 15,3.003L15,3L15,3C15,1.354 13.646,-0 12,0C10.354,0 9,1.354 9,3L9,3.005L9,3.005L9,3.166C8.999,3.413 8.847,3.621 8.625,3.724L8.587,3.737L8.587,3.741C8.363,3.842 8.331,3.847 8.516,3.765C8.274,3.872 7.99,3.821 7.8,3.636L7.749,3.585L7.747,3.583L7.747,3.583C7.185,3.02 6.421,2.703 5.625,2.703C4.829,2.703 4.065,3.02 3.503,3.583C2.94,4.145 2.623,4.909 2.623,5.705C2.623,6.501 2.94,7.265 3.503,7.827L3.505,7.829L3.505,7.829L3.505,7.829L3.539,7.862L3.564,7.883L3.555,7.879C3.741,8.069 3.792,8.354 3.685,8.596C3.677,8.616 3.669,8.635 3.661,8.655C3.57,8.903 3.335,9.072 3.071,9.08L3.071,9.08C3.058,9.08 3.045,9.081 3.033,9.082L3.016,9.083L3,9.084L3,9.08C1.354,9.08 -0,10.434 0,12.08C0,13.726 1.354,15.08 3,15.08L3.167,15.08C3.425,15.081 3.659,15.236 3.761,15.474C3.762,15.477 3.764,15.48 3.765,15.484C3.872,15.726 3.821,16.01 3.636,16.2L3.584,16.252L3.586,16.255L3.585,16.256L3.583,16.252C3.02,16.815 2.703,17.579 2.703,18.375C2.703,19.171 3.02,19.935 3.583,20.497C4.145,21.06 4.909,21.377 5.705,21.377C6.501,21.377 7.265,21.06 7.828,20.497C7.64,20.684 7.885,20.439 7.885,20.439C8.074,20.258 8.356,20.209 8.596,20.315C8.616,20.323 8.635,20.331 8.655,20.339C8.903,20.43 9.072,20.664 9.08,20.929L9.08,20.998L9.08,21L9.08,21C9.08,22.646 10.434,24 12.08,24C13.726,24 15.08,22.646 15.08,21C15.08,21.022 15.079,21.044 15.078,21.066L15.08,20.996L15.08,20.834C15.081,20.575 15.236,20.341 15.474,20.239C15.477,20.238 15.48,20.236 15.484,20.235C15.726,20.128 16.011,20.179 16.201,20.365C16.221,20.385 16.242,20.404 16.264,20.422L16.252,20.417C16.815,20.98 17.579,21.297 18.375,21.297C19.171,21.297 19.935,20.98 20.497,20.417C21.06,19.855 21.377,19.091 21.377,18.295C21.377,17.499 21.06,16.735 20.497,16.173L20.498,16.174L20.496,16.172L20.438,16.114C20.258,15.922 20.21,15.642 20.315,15.404C20.316,15.4 20.318,15.397 20.319,15.394C20.421,15.156 20.655,15.001 20.913,15ZM13.002,3.156C13.001,3.135 13,3.115 13,3.094C13.004,4.147 13.635,5.101 14.602,5.517C15.589,5.951 16.748,5.739 17.519,4.985L17.504,4.991L17.514,4.983C17.527,4.972 17.539,4.962 17.552,4.951L17.585,4.919L17.585,4.919L17.585,4.919L17.588,4.917C17.775,4.729 18.03,4.623 18.295,4.623C18.56,4.623 18.815,4.729 19.003,4.917C19.003,4.917 19.003,4.917 19.003,4.917C19.191,5.105 19.297,5.36 19.297,5.625C19.297,5.89 19.191,6.145 19.003,6.333L18.944,6.392C18.944,6.392 18.654,6.688 18.935,6.401C18.179,7.174 17.969,8.335 18.405,9.324C18.554,9.66 18.558,9.762 18.401,9.394C18.816,10.363 19.772,10.996 20.826,11L21,11C21.549,11 22,11.451 22,12C22,12.549 21.549,13 21,13L21,13L20.997,13L20.912,13L20.875,13.001L20.906,13C19.853,13.004 18.899,13.635 18.483,14.602L18.483,14.602C18.049,15.589 18.261,16.748 19.015,17.519L19.73,17.82L19.025,17.529C19.025,17.529 19.271,17.775 19.083,17.588C19.271,17.775 19.377,18.03 19.377,18.295C19.377,18.56 19.271,18.815 19.083,19.003C19.083,19.003 19.083,19.003 19.083,19.003C18.895,19.191 18.64,19.297 18.375,19.297C18.119,19.297 17.873,19.198 17.688,19.023L17.609,18.945L17.603,18.939L17.599,18.935L17.57,18.907C16.799,18.175 15.657,17.975 14.682,18.403C13.715,18.819 13.084,19.773 13.08,20.826L13.08,21C13.08,21.549 12.629,22 12.08,22C11.531,22 11.08,21.549 11.08,21L11.075,21.005C11.078,20.975 11.08,20.945 11.08,20.915L11.08,20.913L11.08,20.896L11.08,20.887L11.079,20.872L11.079,20.862C11.044,19.794 10.367,18.848 9.368,18.47C8.393,18.053 7.246,18.266 6.481,19.015L6.471,19.025C6.471,19.025 6.414,19.082 6.414,19.082C6.414,19.082 6.127,19.369 6.412,19.083C6.225,19.271 5.97,19.377 5.705,19.377C5.44,19.377 5.185,19.271 4.998,19.083C4.997,19.083 4.997,19.083 4.997,19.082C4.809,18.895 4.703,18.64 4.703,18.375C4.703,18.11 4.809,17.855 4.997,17.667L4.985,17.672C5.009,17.652 5.032,17.631 5.055,17.609L5.055,17.609L5.055,17.609L5.065,17.599C5.819,16.828 6.031,15.669 5.597,14.682C5.181,13.715 4.227,13.084 3.174,13.08L3.174,13.081L3.133,13.08C3.083,13.08 3.039,13.089 3,13.106L3,13.08C2.451,13.08 2,12.629 2,12.08C2,11.531 2.451,11.08 3,11.08L3.082,11.08L3.09,11.08L3.09,11.08L3.113,11.08C4.191,11.055 5.149,10.374 5.53,9.368C5.942,8.406 5.739,7.277 5.015,6.512L4.985,6.481L4.985,6.481L4.976,6.472L4.917,6.413C4.729,6.225 4.623,5.97 4.623,5.705C4.623,5.44 4.729,5.185 4.917,4.998C4.917,4.997 4.917,4.997 4.918,4.997C5.105,4.809 5.36,4.703 5.625,4.703C5.89,4.703 6.145,4.809 6.332,4.997L7.04,5.29L6.335,4.999C6.335,4.999 6.588,5.248 6.401,5.065C7.166,5.813 8.312,6.027 9.295,5.607L9.299,5.606L9.331,5.595L9.333,5.595L9.331,5.595C9.352,5.588 9.373,5.58 9.394,5.571C10.368,5.153 10.996,4.233 11,3.174L11,3.174L11,3.166L11,3.005L11,3L11,3C11,2.451 11.451,2 12,2C12.549,2 13,2.451 13,3L14,4C14,4 13,3.003 13,3.003C13,3.003 13,3.076 13,3.088L13.002,3.156ZM15.075,21.098L15.074,21.108L15.075,21.098ZM16.96,20.71L16.822,20.647L16.804,20.645L16.96,20.71ZM4.446,17.895L4.428,17.897L4.29,17.96L4.446,17.895ZM4.29,17.96L4.264,17.896L4.263,17.896L4.29,17.96ZM4.27,8.18L4.132,8.117L4.117,8.116L4.27,8.18ZM9.293,5.608C9.174,5.655 9.071,5.649 9.071,5.649C9.146,5.644 9.221,5.63 9.293,5.608Z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSettings);\nexport default __webpack_public_path__ + \"static/media/settings.4e7600e7.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react';\r\nimport {ReactComponent as Download} from '../../assets/icons/download.svg';\r\nimport {ReactComponent as FilePlus} from '../../assets/icons/file-plus.svg';\r\nimport {ReactComponent as Folder} from '../../assets/icons/folder.svg';\r\nimport {ReactComponent as FolderWide} from '../../assets/icons/folder-wide.svg';\r\nimport {ReactComponent as FolderOpen} from '../../assets/icons/folder-open.svg';\r\nimport {ReactComponent as Save} from '../../assets/icons/save.svg';\r\nimport {ReactComponent as Crosshair} from '../../assets/icons/crosshair.svg';\r\nimport {ReactComponent as Learning} from '../../assets/icons/learning.svg';\r\nimport {ReactComponent as Settings} from '../../assets/icons/settings.svg';\r\n\r\n// Convention here is `CONSTANT_CASE` for exported constants and `camelCase` otherwise.\r\n// This makes it easier to quickly know what values are globally accessible, since almost everything is a constant anyway.\r\n\r\nconst defaultIconSize = 24;\r\nconst defaultFill = 'rgb(108, 117, 125)';\r\n\r\nconst createIcon = (SvgComponent, widthRatio = 1) => ({fill, size, ...others}) => {\r\n    return (\r\n        <SvgComponent\r\n            fill={fill || defaultFill}\r\n            width={(size || defaultIconSize) * widthRatio}\r\n            height={size || defaultIconSize}\r\n            {...others}\r\n        />\r\n    );\r\n};\r\n\r\nexport const DownloadIcon = createIcon(Download);\r\nexport const FilePlusIcon = createIcon(FilePlus);\r\nexport const FolderIcon = createIcon(Folder);\r\nexport const FolderWideIcon = createIcon(FolderWide, 30 / 24); // TODO: we can probably automate this\r\nexport const FolderOpenIcon = createIcon(FolderOpen, 30 / 24);\r\nexport const SaveIcon = createIcon(Save);\r\nexport const CrosshairIcon = createIcon(Crosshair);\r\nexport const LearningIcon = createIcon(Learning);\r\nexport const SettingsIcon = createIcon(Settings);\r\n","import React from 'react';\r\nimport styled, {css} from 'styled-components';\r\nimport classNames from 'classnames';\r\n\r\nlet ContainerDiv = styled.div`\r\n    position: absolute;\r\n\r\n    ${props => props.bottom && css`\r\n        bottom: 0;\r\n    `};\r\n\r\n    ${props => props.top && css`\r\n        top: 0;\r\n        margin-top: 75px;\r\n    `};\r\n\r\n    ${props => props.left && css`\r\n        left: 0;\r\n    `};\r\n\r\n    ${props => props.right && css`\r\n        right: 0;\r\n    `};\r\n\r\n    z-index: 100;\r\n`;\r\n\r\nexport default function FloatingMenu({className, children, ...others}) {\r\n    return (\r\n        <ContainerDiv className={classNames('floating-menu p-4 d-flex flex-row align-items-center justify-content-center', className)} {...others}>\r\n            {children}\r\n        </ContainerDiv>\r\n    );\r\n}","import useLocalStorage from '../utils/useLocalStorage';\r\n\r\nexport default function useLearningModeState() {\r\n    return useLocalStorage('blocks.learningMode', true);\r\n}\r\n","import useLocalStorage from '../utils/useLocalStorage';\r\n\r\nexport default function useThemePartsState() {\r\n    return useLocalStorage('blocks.themeParts', {});\r\n}\r\n","import useLocalStorage from '../utils/useLocalStorage';\r\n\r\nexport default function useAutosaveState() {\r\n    return useLocalStorage('blocks.autosave', true);\r\n}\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nexport default function MenuModal({title, className, children, ...others}) {\r\n\r\n    return (\r\n        <div className={classNames('p-3', className)} {...others}>\r\n            {title && <h3 className=\"fw-light\">{title}</h3>}\r\n            <hr/>\r\n            {children}\r\n        </div>\r\n    );\r\n}","import {getBlock} from './blocks';\r\n\r\n/* eslint-disable quote-props */\r\nconst shortcutKeys = {\r\n    'c': 'Comment',\r\n    'd': 'CommentRegion',\r\n\r\n    // Arithmetic\r\n    '-': 'Subtract',\r\n    '=': 'Add',\r\n    '8': 'Multiply',\r\n    '/': 'Divide',\r\n\r\n    // Boolean logic\r\n    '7': 'And',\r\n    '\\\\': 'Or',\r\n    '1': 'Not',\r\n\r\n    // Control flow\r\n    'r': 'Return',\r\n\r\n    // Literal values\r\n    ',': 'LiteralTuple',\r\n    '.': 'LiteralIdentifier',\r\n    '\\'': 'LiteralText',///\r\n    'x': 'CodeValue',\r\n    'b': 'LiteralBool',\r\n    'n': 'LiteralNat',\r\n    'i': 'LiteralInt',\r\n    'f': 'LiteralFloat',\r\n    // 's': 'LiteralText',\r\n    'a': 'NewArray',\r\n    'm': 'NewHashMap',\r\n\r\n    // Optionals\r\n    'o': 'Optional',\r\n    'u': 'OptionalUnwrap',\r\n};\r\n\r\nexport const SHORTCUT_KEYS = new Map(Object.entries(shortcutKeys).map(([k, v]) => [k, getBlock(v)]));\r\n","import {capitalCase} from 'change-case';\r\n\r\nexport default function getBlockLabel(block) {\r\n    if(!block) {\r\n        return '';\r\n    }\r\n    return block.title || capitalCase(block.name);\r\n}","import styled from 'styled-components';\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {SHORTCUT_KEYS} from '../../editor/shortcutKeys';\r\nimport getBlockLabel from '../../utils/getBlockLabel';\r\n\r\nconst BlockShortcutContainer = styled.div`\r\n    padding: .5rem 1rem;\r\n    background: #0001;\r\n    max-height: 20rem;\r\n    overflow-y: auto;\r\n`;\r\n\r\nconst ShortcutContainer = styled.div`\r\n    font-weight: 500;\r\n\r\n    :hover {\r\n        background: #0001;\r\n    }\r\n`;\r\n\r\nconst KeyContainer = styled.code`\r\n    background: #0001;\r\n    padding: .25rem .5rem;\r\n    border-radius: .5rem;\r\n    white-space: nowrap;\r\n`;\r\n\r\nfunction KeyboardShortcut({binding, className, children, ...others}) {\r\n    return (\r\n        <ShortcutContainer className=\"p-1 d-flex align-items-center\">\r\n            <label className=\"mb-0 flex-grow-1\">{children}</label>\r\n            {(Array.isArray(binding) ? binding : [binding]).map((key, i) => (\r\n                <label key={`${key}${i}`} className=\"ms-1\">\r\n                    {/*{i > 0 && <span>+</span>}*/}\r\n                    <KeyContainer className={classNames(className, 'text-info')} {...others}>\r\n                        {key}\r\n                    </KeyContainer>\r\n                </label>\r\n            ))}\r\n        </ShortcutContainer>\r\n    );\r\n}\r\n\r\nexport default function KeyBindingDetail() {\r\n    return (\r\n        <BlockShortcutContainer>\r\n            <KeyboardShortcut binding={['left mouse']}>\r\n                Select & Drag\r\n            </KeyboardShortcut>\r\n            <KeyboardShortcut binding={['right mouse']}>\r\n                Context Menu\r\n            </KeyboardShortcut>\r\n            <KeyboardShortcut binding={['ctrl', 'right mouse']}>\r\n                Context Menu (+)\r\n            </KeyboardShortcut>\r\n            <KeyboardShortcut binding={'delete'}>\r\n                Delete Selected Blocks\r\n            </KeyboardShortcut>\r\n            <KeyboardShortcut binding={['ctrl', 'left mouse']}>\r\n                Remove Connection\r\n            </KeyboardShortcut>\r\n            {[...SHORTCUT_KEYS.keys()].sort().map(key => (\r\n                <KeyboardShortcut key={key} binding={key}>\r\n                    <span className=\"text-muted\">{getBlockLabel(SHORTCUT_KEYS.get(key))}</span>\r\n                </KeyboardShortcut>\r\n            ))}\r\n        </BlockShortcutContainer>\r\n    );\r\n}","import React from 'react';\r\nimport useThemeState from '../../hooks/persistent/useThemeState';\r\nimport useThemes from '../../hooks/useThemes';\r\nimport useLearningModeState from '../../hooks/persistent/useLearningModeState';\r\nimport {sentenceCase} from 'change-case';\r\nimport useThemePartsState from '../../hooks/persistent/useThemePartsState';\r\nimport styled from 'styled-components';\r\nimport useAutosaveState from '../../hooks/persistent/useAutosaveState';\r\nimport MenuModal from '../common/MenuModal';\r\nimport KeyBindingDetail from './KeyBindingDetail';\r\n\r\nconst settingInputs = {\r\n    select({value, options, onChange}) {\r\n        return (\r\n            <select className=\"form-control ml-5 w-auto\" onChange={onChange} value={value}>\r\n                {options.map((option, i) => (\r\n                        <option key={i} value={option.value}>{option.label ?? option.value}</option>\r\n                    ),\r\n                )}\r\n            </select>\r\n        );\r\n    },\r\n    toggle({value, onChange}) {\r\n        return (\r\n            <input type=\"checkbox\" checked={!!value} onChange={onChange}/>\r\n        );\r\n    },\r\n};\r\n\r\nconst NestedContainer = styled.div`\r\n    background: #0001;\r\n`;\r\n\r\n/**\r\n * Creates a UI element for a given setting.\r\n */\r\nfunction Setting({name, description, type, extras, props}) {\r\n\r\n    const SettingInput = settingInputs[type];\r\n\r\n    return (\r\n        <>\r\n            <div className=\"w-100 py-1 px-3 d-flex flex-column align-items-start justify-content-center\">\r\n                <div className=\"w-100 d-flex flex-row align-items-center justify-content-between\">\r\n                    <span className=\"flex-grow-1\" style={{fontWeight: 500}}>{name}</span>\r\n                    {SettingInput && <SettingInput {...props}/>}\r\n                </div>\r\n                <span className=\"small text-muted\">{description}</span>\r\n            </div>\r\n            {extras && !!extras.length && (\r\n                <NestedContainer className=\"ps-3 py-1 rounded-3\">\r\n                    {extras.map((extra, i) => <Setting key={i} {...extra}/>)}\r\n                </NestedContainer>\r\n            )}\r\n        </>\r\n    );\r\n}\r\n\r\nexport default function SettingsModal() {\r\n    const [theme, setTheme] = useThemeState();\r\n    const [themeParts, setThemeParts] = useThemePartsState();\r\n    const [autosave, setAutosave] = useAutosaveState();\r\n    const [learningMode, setLearningMode] = useLearningModeState();\r\n\r\n    const themes = useThemes();\r\n\r\n    // Define the content for each option.\r\n    const settings = [{\r\n        name: 'Theme',\r\n        description: 'The color scheme used in the editor.',\r\n        type: 'select',\r\n        props: {\r\n            label: theme.name,\r\n            value: theme.id,\r\n            options: themes.map(theme => ({value: theme.id, label: theme.name})),\r\n            onChange(e) {\r\n                setTheme(e.target.value);\r\n            },\r\n        },\r\n        extras: theme.parts.map(part => ({\r\n            name: sentenceCase(part),\r\n            type: 'toggle',\r\n            props: {\r\n                value: !!themeParts[part],\r\n                onChange() {\r\n                    setThemeParts({...themeParts, [part]: !themeParts[part]});\r\n                },\r\n            },\r\n        })),\r\n    }, {\r\n        name: 'Auto-save changes',\r\n        description: 'Automatically sync changes while using the editor.',\r\n        type: 'toggle',\r\n        props: {\r\n            value: autosave,\r\n            onChange() {\r\n                setAutosave(!autosave);\r\n            },\r\n        },\r\n    }, {\r\n        name: 'Learning Mode',\r\n        description: 'Provides more detailed mouse-over tooltips.',\r\n        type: 'toggle',\r\n        props: {\r\n            value: learningMode,\r\n            onChange() {\r\n                setLearningMode(!learningMode);\r\n            },\r\n        },\r\n    }];\r\n\r\n    return (\r\n        <MenuModal title=\"Settings\">\r\n            {settings.map((setting, i) => (\r\n                <div key={i}>\r\n                    <Setting {...setting}/>\r\n                    <hr/>\r\n                </div>\r\n            ))}\r\n            <h4 className=\"mt-4 fw-light\">Keyboard Shortcuts</h4>\r\n            {/*<hr/>*/}\r\n            <KeyBindingDetail/>\r\n        </MenuModal>\r\n    );\r\n}","import {makeLocalStorageObservable} from '../utils/useLocalStorage';\r\nimport useObservableState from '../utils/useObservableState';\r\n\r\n// TODO: move to `src/observables`?\r\nexport const OUTPUT_PANEL_STATE = makeLocalStorageObservable('blocks.outputPanel', null);\r\n\r\nexport default function useOutputPanelState() {\r\n    return useObservableState(OUTPUT_PANEL_STATE);\r\n}\r\n","import makeObservable from '../utils/makeObservable';\r\n\r\nexport const CONTEXT_MENU_STORE = makeObservable(null);","export const getTutorialNode = (editor, id) => {\r\n    return editor.nodes.find(node => node.id === id);\r\n};","import {getTutorialNode} from '../utils/getTutorialNode';\r\n\r\nexport const createNodeStep = (name, id) => {\r\n    return {\r\n        isComplete(progress) {\r\n            return getTutorialNode(progress.editor, id);\r\n        },\r\n        setupNode(node, progress) {\r\n            if(node.name === name && !getTutorialNode(progress.editor, id)) {\r\n                node.id = id;\r\n            }\r\n        },\r\n    };\r\n};","import {css, keyframes} from 'styled-components';\r\n\r\nexport const highlightStyle = css`\r\n    box-shadow: 0 0 1.5rem #FFF !important;\r\n`;\r\n\r\nconst animation = keyframes`\r\n    0% {\r\n        transform: scale(1);\r\n    }\r\n    50% {\r\n        transform: scale(1.1);\r\n    }\r\n    100% {\r\n        transform: scale(1);\r\n    }\r\n`;\r\nexport const animationStyle = css`\r\n    animation: ${animation} 1.5s ease-out infinite;\r\n`;\r\n\r\n\r\nexport function getNodeSelector(id, key) {\r\n    const selector = `.node-id-${id}`;\r\n    return key ? `${selector} .prop.key-${key}` : selector;\r\n}\r\n\r\nexport function highlightNode(id, key) {\r\n    return css`\r\n        ${getNodeSelector(id)} {\r\n            ${highlightStyle}\r\n        }\r\n\r\n        ${(key || undefined) && css`\r\n            ${getNodeSelector(id, key)} {\r\n                //box-shadow: 0 0 .5rem #FFF !important;\r\n                background: #FFF2 !important;\r\n\r\n                input, select {\r\n                    &:not(:focus) {\r\n                        ${animationStyle}\r\n                    }\r\n                }\r\n            }\r\n        `}\r\n    `;\r\n}\r\n\r\nexport function highlightNodeSocket(id, key) {\r\n    return css`\r\n        ${highlightNode(id)}\r\n        ${getNodeSelector(id)} .socket.key-${key} {\r\n            ${animationStyle}\r\n        }\r\n    `;\r\n}\r\n\r\nexport function highlightNodeShortcut(id, blockName) {\r\n    return css`\r\n        ${getNodeSelector(id)} .node-shortcut-button.shortcut-block-${blockName} {\r\n            border: 2px solid white !important;\r\n            ${highlightStyle}\r\n            ${animationStyle}\r\n        }\r\n    `;\r\n}\r\n\r\nexport function highlightContextMenuComponent(blockName) {\r\n    return css`\r\n        .context-menu .component-${blockName} {\r\n            box-shadow: 0 0 .5rem #FFFA !important;\r\n            border: 1px solid white;\r\n\r\n            background: inherit !important;\r\n\r\n            ${animationStyle}\r\n        }\r\n    `;\r\n}\r\n","import makeObservable from '../utils/makeObservable';\r\n\r\nexport const EDITOR_STATE_STORE = makeObservable(null);","import makeObservable from '../utils/makeObservable';\r\n\r\nexport const EDITOR_SELECTION_STORE = makeObservable([]);","import {CONTEXT_MENU_STORE} from '../../observables/contextMenuStore';\r\nimport {createNodeStep} from '../steps/createNodeStep';\r\nimport {css} from 'styled-components';\r\nimport {getTutorialNode} from '../utils/getTutorialNode';\r\nimport {\r\n    animationStyle,\r\n    highlightContextMenuComponent,\r\n    highlightNode,\r\n    highlightNodeShortcut,\r\n    highlightNodeSocket,\r\n    highlightStyle,\r\n} from '../utils/tutorialStyles';\r\nimport {EDITOR_STATE_STORE} from '../../observables/editorStateStore';\r\nimport {OUTPUT_PANEL_STATE} from '../../hooks/persistent/useOutputPanelState';\r\nimport {EDITOR_SELECTION_STORE} from '../../observables/editorSelectionStore';\r\n\r\n// Custom ID for the tutorial blocks\r\nconst functionNodeId = 'helloFunction';\r\nconst returnNodeId = 'helloReturn';\r\nconst textNodeId = 'helloText';\r\n\r\n// TODO: automatic lookup\r\nconst getFunctionNode = editor => getTutorialNode(editor, functionNodeId);\r\nconst getReturnNode = editor => getTutorialNode(editor, returnNodeId);\r\nconst getTextNode = editor => getTutorialNode(editor, textNodeId);\r\n\r\n// Global style when tutorial is active\r\nconst style = css`\r\n\r\n`;\r\n\r\nexport const helloWorldTutorial = {\r\n    id: 'hello-world',\r\n    name: 'Hello, World!',\r\n    description: 'Create a simple Blocks smart contract.',\r\n    style,\r\n    setupVariables(progress) {\r\n        // Update tutorial based on these observables\r\n        return {\r\n            contextMenu: CONTEXT_MENU_STORE,\r\n            editorState: EDITOR_STATE_STORE,\r\n            editorSelection: EDITOR_SELECTION_STORE,\r\n            outputPanel: OUTPUT_PANEL_STATE,\r\n        };\r\n    },\r\n    steps: [{\r\n        ...createNodeStep('Function', functionNodeId),\r\n        title: 'Create a function',\r\n        style: css`\r\n            ${highlightContextMenuComponent('Function')}\r\n        `,\r\n        render(progress, {contextMenu}) {\r\n            if(!contextMenu) {\r\n                return 'Right-click somewhere in the editor space.';\r\n            }\r\n            if(contextMenu.node) {\r\n                return 'Make sure to right-click on empty space.';\r\n            }\r\n            return <>Select the <code>Function</code> block.</>;\r\n        },\r\n    }, {\r\n        title: 'Clear the selection',\r\n        info: 'Left-click somewhere in the editor space.',\r\n        isComplete(progress, {editorSelection}) {\r\n            return !editorSelection.length || getReturnNode(progress.editor);\r\n        },\r\n    }, {\r\n        title: 'Name the function',\r\n        // info: 'Type something into the \"Name\" field.',\r\n        style: css`\r\n            ${highlightNode(functionNodeId, 'name')}\r\n        `,\r\n        render() {\r\n            return (\r\n                <>\r\n                    <div>Type something into the <code>Name</code> field.</div>\r\n                    <hr/>\r\n                    <small>For example: <code>hello</code></small>\r\n                </>\r\n            );\r\n        },\r\n        isComplete(progress) {\r\n            const node = getFunctionNode(progress.editor);\r\n            return node.data.name;\r\n        },\r\n    }, {\r\n        ...createNodeStep('Return', returnNodeId),\r\n        title: 'Add a Return statement',\r\n        info: 'Click and drag the outlined button.',\r\n        style: css`\r\n            ${highlightNodeShortcut(functionNodeId, 'Return')}\r\n            ${highlightNode(returnNodeId) /* Highlight return node if already exists */}\r\n        `,\r\n        render() {\r\n            return <small>This is a shortcut for adding a <code>Return</code> statement.</small>;\r\n        },\r\n    }, {\r\n        title: 'Connect the Return statement',\r\n        info: 'Connect the two indicated sockets.',\r\n        style: css`\r\n            ${highlightNodeSocket(functionNodeId, 'body')}\r\n            ${highlightNodeSocket(returnNodeId, 'statement')}\r\n        `,\r\n        isComplete(progress) {\r\n            const node = getFunctionNode(progress.editor);\r\n            const connections = node.outputs.get('body').connections;\r\n            if(connections.some(conn => conn.input.node.id === returnNodeId)) {\r\n                return true;\r\n            }\r\n            // Clear connections (TODO: move to side effect function)\r\n            connections.forEach(conn => progress.editor.removeConnection(conn));\r\n            return false;\r\n        },\r\n    }, {\r\n        ...createNodeStep('LiteralText', textNodeId),\r\n        title: 'Return a text value',\r\n        style: css`\r\n            ${highlightContextMenuComponent('LiteralText')}\r\n            ${highlightNodeSocket(returnNodeId, 'value')}\r\n            ${highlightNode(textNodeId) /* Highlight text node if already exists */}\r\n        `,\r\n        render(progress, {contextMenu}) {\r\n            if(!contextMenu) {\r\n                return <>Click and drag from the <code>Value</code> socket.</>;\r\n            }\r\n            if(!contextMenu.context) {\r\n                return <>Make sure to drag from the <code>Value</code> socket on the <code>Return</code> block.</>;\r\n            }\r\n            return <>Type <code>text</code> into the search bar and click on the outlined result.</>;\r\n        },\r\n    }, {\r\n        title: 'Connect the Text block',\r\n        info: 'Connect the two indicated sockets.',\r\n        style: css`\r\n            ${highlightNodeSocket(returnNodeId, 'value')}\r\n            ${highlightNodeSocket(textNodeId, 'value')}\r\n        `,\r\n        isComplete(progress) {\r\n            const node = getReturnNode(progress.editor);\r\n            const connections = node.inputs.get('value').connections;\r\n            if(connections.some(conn => conn.output.node.id === textNodeId)) {\r\n                return true;\r\n            }\r\n            // Clear connections (TODO: move to side effect function)\r\n            connections.forEach(conn => progress.editor.removeConnection(conn));\r\n            return false;\r\n        },\r\n    }, {\r\n        title: 'Define the Text content',\r\n        // info: 'Write something in the \"Value\" text box.',\r\n        style: css`\r\n            ${highlightNode(textNodeId, 'value')}\r\n        `,\r\n        render() {\r\n            return (\r\n                <>\r\n                    <div>Type something into the <code>Value</code> field.</div>\r\n                    <hr/>\r\n                    <small>For example: <code>Hello world!</code></small>\r\n                </>\r\n            );\r\n        },\r\n        isComplete(progress) {\r\n            const node = getTextNode(progress.editor);\r\n            return node.data.value;\r\n        },\r\n    }, {\r\n        title: 'View the smart contract',\r\n        info: 'Click the \"Compile\" button at the bottom-right of the page.',\r\n        style: css`\r\n            .compile-button {\r\n                border: 1px solid white;\r\n                ${highlightStyle}\r\n                ${animationStyle}\r\n            }\r\n        `,\r\n        render(progress) {\r\n            const functionNode = getFunctionNode(progress.editor);\r\n            const textNode = getTextNode(progress.editor);\r\n            return (\r\n                <small>\r\n                    Your function is named <code>{functionNode.data.name}</code>{' '}\r\n                    with a return value of <code>\"{textNode.data.value}\"</code>.\r\n                </small>\r\n            );\r\n        },\r\n        isComplete(progress, {outputPanel}) {\r\n            return outputPanel;\r\n        },\r\n    }],\r\n};","import {helloWorldTutorial} from './definitions/helloWorldTutorial';\r\n\r\nexport const TUTORIALS = [\r\n    helloWorldTutorial,\r\n];\r\n","import makeObservable from '../utils/makeObservable';\r\n\r\nexport const EDITOR_STORE = makeObservable(null);","import useLocalStorage from '../utils/useLocalStorage';\r\nimport {useCallback, useMemo} from 'react';\r\nimport {TUTORIALS} from '../../tutorials/tutorials';\r\nimport useNodeEditor from '../useNodeEditor';\r\nimport getEmbedConfig from '../../utils/getEmbedConfig';\r\n\r\nexport default function useTutorialProgressState() {\r\n    const defaultTutorial = getEmbedConfig('tutorial');\r\n    const defaultState = defaultTutorial ? {tutorial: defaultTutorial} : null;\r\n\r\n    const [state, setState] = useLocalStorage('blocks.tutorialProgress', defaultState);\r\n\r\n    const editor = useNodeEditor();\r\n\r\n    const progress = useMemo(() => {\r\n        if(!state) {\r\n            return null;\r\n        }\r\n        const tutorial = TUTORIALS.find(t => t.id === state.tutorial);\r\n        if(!tutorial) {\r\n            return null;\r\n        }\r\n        // const stepIndex = Math.min(state.stepIndex || 0, tutorial.steps.length - 1);\r\n        return Object.freeze({\r\n            ...state,\r\n            editor,\r\n            tutorial,\r\n            // stepIndex,\r\n            // step: tutorial.steps[stepIndex],\r\n        });\r\n    }, [editor, state]);\r\n\r\n    const setProgress = useCallback(progress => {\r\n        setState(progress ? {\r\n            ...progress,\r\n            editor: undefined,\r\n            tutorial: progress.tutorial?.id,\r\n            // step: undefined,\r\n        } : null);\r\n    }, [setState]);\r\n\r\n    return [progress, setProgress];\r\n}\r\n","import useObservableState from './utils/useObservableState';\r\nimport {EDITOR_STORE} from '../observables/editorStore';\r\n\r\nexport default function useNodeEditor() {\r\n    const [editor] = useObservableState(EDITOR_STORE);\r\n    return editor;\r\n}\r\n","import {useMemo} from 'react';\r\nimport useObjectObservable from './utils/useObjectObservable';\r\n\r\nexport default function useTutorialVariables(progress) {\r\n\r\n    const variables = useMemo(() => progress.tutorial.setupVariables(progress), [progress]);\r\n\r\n    return useObjectObservable(variables);\r\n}\r\n","import {useEffect, useState} from 'react';\r\n\r\n// Use an object {K: V} constructed from {K: Observable<V>}\r\nexport default function useObjectObservable(object) {\r\n    let [result, setResult] = useState({});\r\n\r\n    // const unsubscribe = useMemo(() => {\r\n    //     const callbacks = [];\r\n    //     for(const [key, observable] of Object.entries(object)) {\r\n    //         result[key] = observable.get();\r\n    //         callbacks.push(observable.subscribe(value => {\r\n    //             if(value !== result[key]) {\r\n    //                 result[key] = value;\r\n    //                 setResult({...result});\r\n    //             }\r\n    //         }));\r\n    //     }\r\n    //     return () => callbacks.forEach(callback => callback());\r\n    //     // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    // }, [object /* result */]);\r\n    //\r\n    // useEffect(() => unsubscribe, [unsubscribe]);\r\n\r\n    useEffect(() => {\r\n        const callbacks = [];\r\n        for(const [key, observable] of Object.entries(object)) {\r\n            result[key] = observable.get();\r\n            callbacks.push(observable.subscribe(value => {\r\n                if(value !== result[key]) {\r\n                    result[key] = value;\r\n                    setResult({...result});\r\n                }\r\n            }));\r\n        }\r\n        return () => callbacks.forEach(callback => callback());\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [object]);\r\n\r\n    return result;\r\n}\r\n","import {Button, ButtonGroup, Card} from 'react-bootstrap';\r\nimport React, {useCallback} from 'react';\r\nimport useTutorialProgressState from '../../hooks/persistent/useTutorialProgressState';\r\nimport useFamiliarityState, {FAMILIAR, LEARNING} from '../../hooks/persistent/useFamiliarityState';\r\nimport styled, {createGlobalStyle} from 'styled-components';\r\nimport {helloWorldTutorial} from '../../tutorials/definitions/helloWorldTutorial';\r\nimport getTutorialStep from '../../tutorials/utils/getTutorialStep';\r\nimport useTutorialVariables from '../../hooks/useTutorialVariables';\r\nimport useReactTooltip from '../../hooks/useReactTooltip';\r\nimport useListener from '../../hooks/utils/useListener';\r\nimport {FiSmile, FiX} from 'react-icons/fi';\r\nimport {LearningIcon} from '../common/Icon';\r\n\r\nconst StyledLearningIcon = styled(LearningIcon)`\r\n    width: 24px;\r\n    fill: #FFF;\r\n`;\r\n\r\nconst StyledCard = styled(Card)`\r\n    opacity: .9;\r\n    box-shadow: 0 2px 12px #0005;\r\n    border: none;\r\n    max-width: 30rem;\r\n    font-size: 18px;\r\n    font-weight: 500;\r\n`;\r\n\r\nconst StyledCardHeader = styled(Card.Header)`\r\n    //background: #8649E1\r\n`;\r\n\r\nconst GlobalStyle = createGlobalStyle`\r\n    ${props => props.tutorialCss}\r\n    ${props => props.stepCss}\r\n`;\r\n\r\nfunction HelperCard({title, icon, iconTooltip, hideCloseButton, children, ...others}) {\r\n    const [, setProgress] = useTutorialProgressState();\r\n\r\n    useReactTooltip();\r\n\r\n    return (\r\n        <StyledCard {...others}>\r\n            {(icon || title) && (\r\n                <StyledCardHeader className=\"helper-card-header bg-info py-3\">\r\n                    <h4 className=\"mb-0 d-flex align-items-center justify-content-start text-white\">\r\n                        <span className=\"me-3 mb-1\" data-tip={iconTooltip} data-place=\"top\" data-delay-show={0}>\r\n                            {icon || <StyledLearningIcon/>}\r\n                        </span>\r\n                        {title && <span className=\"me-3 flex-grow-1\">{title}</span>}\r\n                        {!hideCloseButton && (\r\n                            <span className=\"float-end\">\r\n                            <FiX\r\n                                className=\"clickable text-white\" onClick={() => {\r\n                                setProgress(null);\r\n                            }}/>\r\n                        </span>\r\n                        )}\r\n                    </h4>\r\n                </StyledCardHeader>\r\n            )}\r\n            <Card.Body className=\"helper-card-body\">\r\n                {children}\r\n            </Card.Body>\r\n        </StyledCard>\r\n    );\r\n}\r\n\r\nfunction TutorialProgressCard({progress, onComplete}) {\r\n    const variables = useTutorialVariables(progress);\r\n\r\n    const {tutorial, editor} = progress;\r\n\r\n    const step = getTutorialStep(progress, variables);\r\n\r\n    // Allow tutorials to intercept node creation\r\n    useListener(editor, 'prenodecreate', (node) => {\r\n        if(!editor.silent && step) {\r\n            if(step.setupNode) {\r\n                step.setupNode(node, progress, variables);\r\n            }\r\n        }\r\n    });\r\n\r\n    if(!step) {\r\n        // Tutorial completed\r\n        return (\r\n            <HelperCard\r\n                title=\"Congratulations!\"\r\n                icon={<FiSmile/>}>\r\n                You completed our \"{tutorial.name}\" tutorial.\r\n                <hr/>\r\n                <ButtonGroup className=\"d-flex\">\r\n                    <Button variant=\"success\" onMouseDown={() => onComplete()}>Close</Button>\r\n                </ButtonGroup>\r\n            </HelperCard>\r\n        );\r\n    }\r\n\r\n    // Custom JSX from tutorial step\r\n    const rendered = step.render?.(progress, variables);\r\n\r\n    // Tutorial in progress\r\n    return (\r\n        <HelperCard\r\n            title={step.title || tutorial.name}\r\n            iconTooltip={`${tutorial.name} (${tutorial.description})`}>\r\n            {step.info}\r\n            {rendered && step.info && <hr/>}\r\n            {rendered}\r\n            {(tutorial.style || step.style) && (\r\n                <GlobalStyle tutorialCss={tutorial.style} stepCss={step.style}/>\r\n            )}\r\n        </HelperCard>\r\n    );\r\n}\r\n\r\nexport default function TutorialCard() {\r\n    const [progress, setProgress] = useTutorialProgressState();\r\n    const [familiarity, setFamiliarity] = useFamiliarityState();\r\n\r\n    // Temp: browser debug\r\n    window.resetTutorial = () => {\r\n        setProgress(null);\r\n        setFamiliarity(null);\r\n    };\r\n\r\n    const onAccept = useCallback(() => {\r\n        setProgress({\r\n            tutorial: helloWorldTutorial,\r\n        });\r\n        setFamiliarity(LEARNING);\r\n    }, [setFamiliarity, setProgress]);\r\n\r\n    const onDecline = useCallback(() => {\r\n        setFamiliarity(FAMILIAR);\r\n    }, [setFamiliarity]);\r\n\r\n    const onComplete = useCallback(() => {\r\n        setProgress(null);\r\n    }, [setProgress]);\r\n\r\n    if(progress) {\r\n        return (\r\n            <TutorialProgressCard progress={progress} onComplete={onComplete}/>\r\n        );\r\n    }\r\n    if(!familiarity) {\r\n        return (\r\n            <HelperCard title=\"New to Blocks?\" hideCloseButton={true}>\r\n                <ButtonGroup className=\"d-flex\">\r\n                    <Button variant=\"success\" onMouseDown={onAccept}>Start Tutorial</Button>\r\n                    <Button variant=\"\" className=\"text-muted\" onMouseDown={onDecline}>Skip</Button>\r\n                </ButtonGroup>\r\n            </HelperCard>\r\n        );\r\n    }\r\n    return null;\r\n}\r\n","export default function getTutorialStep(progress, variables) {\r\n    const {tutorial/*, step, stepIndex*/} = progress;\r\n\r\n    // let i = step.checkpoint ? stepIndex : 0;\r\n    let i = 0;///\r\n    while(i < tutorial.steps.length) {\r\n        const step = tutorial.steps[i];\r\n        if(!step.isComplete?.(progress, variables)) {\r\n            break;\r\n        }\r\n        i++;\r\n    }\r\n    return i === tutorial.steps.length ? null : tutorial.steps[i];\r\n}\r\n","import useLocalStorage from '../utils/useLocalStorage';\r\n\r\nexport const LEARNING = 'learning';\r\nexport const FAMILIAR = 'familiar';\r\n\r\nexport default function useFamiliarityState() {\r\n    return useLocalStorage('blocks.familiarity', null);\r\n}\r\n","import React from 'react';\r\nimport {TUTORIALS} from '../../tutorials/tutorials';\r\nimport MenuModal from '../common/MenuModal';\r\nimport MenuModalOption from '../common/MenuModalOption';\r\nimport useTutorialProgressState from '../../hooks/persistent/useTutorialProgressState';\r\nimport {FiX} from 'react-icons/fi';\r\nimport classNames from 'classnames';\r\n\r\nconst tutorials = TUTORIALS;\r\n\r\nexport default function TutorialsModal() {\r\n    const [progress, setProgress] = useTutorialProgressState();\r\n\r\n    const currentTutorial = progress?.tutorial;\r\n\r\n    return (\r\n        <MenuModal title=\"Tutorials\">\r\n            {tutorials.map((tutorial, i) => {\r\n                const selected = currentTutorial === tutorial;\r\n                return (\r\n                    <MenuModalOption\r\n                        key={i}\r\n                        name={tutorial.name}\r\n                        description={tutorial.description || '(No description provided)'}\r\n                        className={classNames(selected && 'text-info')}\r\n                        style={{\r\n                            transition: 'border-left-width .2s ease-out',\r\n                            borderStyle: 'solid',\r\n                            borderColor: 'transparent',\r\n                            borderWidth: `4px ${selected ? 8 : 4}px`,\r\n                            borderLeftColor: 'var(--bs-info)',\r\n                        }} // TODO: refactor to styled-components\r\n                        onClick={() => setProgress(selected ? null : {tutorial})}>\r\n                        {selected && <span className=\"h5 mb-0 text-muted\"><FiX/></span>}\r\n                    </MenuModalOption>\r\n                );\r\n            })}\r\n        </MenuModal>\r\n    );\r\n}","import TopMenu from '../common/menus/TopMenu';\r\nimport MenuButton from '../common/menus/MenuButton';\r\nimport React, {useContext, useState} from 'react';\r\nimport MenuItem from '../common/menus/MenuItem';\r\nimport styled, {keyframes} from 'styled-components';\r\nimport classNames from 'classnames';\r\nimport EventsContext, {\r\n    EDITOR_CHANGE_EVENT,\r\n    EDITOR_SAVE_EVENT,\r\n    PROJECT_CLEAR_EVENT,\r\n    PROJECT_EXPORT_EVENT,\r\n    PROJECT_LOAD_EVENT,\r\n} from '../../contexts/EventsContext';\r\nimport useListener from '../../hooks/utils/useListener';\r\nimport LoadProjectModal from './LoadProjectModal';\r\nimport {Modal} from 'react-bootstrap';\r\nimport {\r\n    CrosshairIcon,\r\n    DownloadIcon,\r\n    FilePlusIcon,\r\n    FolderOpenIcon,\r\n    FolderWideIcon,\r\n    LearningIcon,\r\n    SaveIcon,\r\n    SettingsIcon,\r\n} from '../common/Icon';\r\nimport ReactTooltip from 'react-tooltip';\r\nimport AreaPlugin from 'rete-area-plugin';\r\nimport FloatingMenu from '../common/menus/FloatingMenu';\r\nimport SettingsModal from './SettingsModal';\r\nimport useOutputPanelState from '../../hooks/persistent/useOutputPanelState';\r\nimport useAutosaveState from '../../hooks/persistent/useAutosaveState';\r\nimport TutorialCard from './TutorialCard';\r\nimport TutorialsModal from './TutorialsModal';\r\nimport useTutorialProgressState from '../../hooks/persistent/useTutorialProgressState';\r\nimport useTimeout from '../../hooks/utils/useTimeout';\r\n\r\nconst BlocksLogo = styled.img`\r\n    -webkit-user-drag: none;\r\n    user-select: none;\r\n    height: 40px;\r\n`;\r\n\r\nconst ProjectNameInput = styled.input`\r\n    border: 2px solid transparent !important;\r\n    border-bottom: solid 2px #0003 !important;\r\n    font-weight: bold;\r\n    vertical-align: top;\r\n    margin-top: .4em;\r\n    padding: .25em .25em .1em;\r\n    position: relative;\r\n    background-clip: padding-box;\r\n\r\n    &::before {\r\n        content: '';\r\n        position: absolute;\r\n        top: 0;\r\n        left: 0;\r\n        right: 0;\r\n        bottom: 0;\r\n        background: linear-gradient(30deg, #00EFFB, #8649E1, #F900E3);\r\n        margin: -2px;\r\n        z-index: -1;\r\n        opacity: 0;\r\n    }\r\n\r\n    :focus {\r\n        outline: none;\r\n\r\n        &::before {\r\n            opacity: 1;\r\n        }\r\n    }\r\n`;\r\n\r\n// TODO: define animated icons in their own files\r\nconst saveAnimation = keyframes`\r\n    30% {\r\n        transform: scale(.6);\r\n    }\r\n`;\r\nconst StyledSaveIcon = styled(SaveIcon)`\r\n    &.animating {\r\n        animation: ${saveAnimation} .7s ease-out;\r\n    }\r\n`;\r\n\r\n// const zoomAnimation = keyframes`\r\n//     from {\r\n//         transform: rotate(0);\r\n//     }\r\n//     to {\r\n//         transform: rotate(360deg);\r\n//     }\r\n// `;\r\nconst StyledZoomIcon = styled(CrosshairIcon)`\r\n    &.animating {\r\n        animation: ${saveAnimation} .7s ease-out;\r\n    }\r\n`;\r\n\r\nconst StyledLearningIcon = styled(LearningIcon)`\r\n    transition: .2s transform ease-out;\r\n\r\n    &.enabled {\r\n        //stroke: var(--bs-primary) !important;\r\n        //transform: scale(1.3) !important;\r\n        //box-shadow: 0 0 12px inset #0003;\r\n        //border-radius: 50%;\r\n        //outline: 2px solid var(--bs-primary);\r\n    }\r\n`;\r\n\r\nexport default function EditorMenu({editor}) {\r\n    const [name, setName] = useState('');\r\n    const [saveAnimating, setSaveAnimating] = useState(false);\r\n    const [zoomAnimating, setZoomAnimating] = useState(false);\r\n    const [openMenu, setOpenMenu] = useState(null);\r\n    const [outputPanel, setOutputPanel] = useOutputPanelState();\r\n    const [autosave] = useAutosaveState();\r\n    const [progress] = useTutorialProgressState();\r\n\r\n    const events = useContext(EventsContext);\r\n\r\n    useListener(events, EDITOR_SAVE_EVENT, () => {\r\n        setSaveAnimating(true);\r\n    });\r\n\r\n    useListener(events, PROJECT_LOAD_EVENT, project => {\r\n        setName(project.name);\r\n        setOpenMenu(false);\r\n    });\r\n\r\n    /// Temp, until projectName refactor\r\n    useTimeout(() => {\r\n        setName(editor.projectName);\r\n    });\r\n\r\n    // TODO refactor\r\n    const updateName = (name) => {\r\n        setName(name);\r\n        editor.projectName = name;\r\n        events.emit(EDITOR_CHANGE_EVENT, editor);\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <TopMenu>\r\n                <MenuItem className=\"d-none d-sm-block\">\r\n                    <a href=\"https://blocks-editor.github.io/\" target=\"_blank\" rel=\"noreferrer\">\r\n                        <BlocksLogo\r\n                            className=\"pt-1\"\r\n                            src={`${process.env.PUBLIC_URL}/img/logo-gradient.png`}\r\n                            alt=\"Blocks Logo\"\r\n                            draggable=\"false\"\r\n                        />\r\n                    </a>\r\n                </MenuItem>\r\n                <div className=\"w-100 px-3\">\r\n                    <ProjectNameInput\r\n                        type=\"text\"\r\n                        placeholder=\"Unnamed Project\"\r\n                        className=\"bg-light text-secondary\"\r\n                        value={name || ''}\r\n                        onChange={e => updateName(e.target.value)}\r\n                        onKeyDown={e => e.key === 'Enter' && events.emit(EDITOR_SAVE_EVENT, editor)}\r\n                    />\r\n                    {!autosave && (\r\n                        <MenuButton\r\n                            tooltip=\"Save Changes\"\r\n                            onMouseDown={() => events.emit(EDITOR_SAVE_EVENT, editor)}>\r\n                            <StyledSaveIcon\r\n                                className={classNames(saveAnimating && 'animating')}\r\n                                onAnimationEnd={() => setSaveAnimating(false)}\r\n                            />\r\n                        </MenuButton>\r\n                    )}\r\n                    <MenuButton\r\n                        tooltip=\"Export to File\"\r\n                        onMouseDown={() => events.emit(PROJECT_EXPORT_EVENT, editor.toJSON())}>\r\n                        <DownloadIcon/>\r\n                    </MenuButton>\r\n                    <MenuButton\r\n                        tooltip=\"New Project\"\r\n                        onMouseDown={() => events.emit(PROJECT_CLEAR_EVENT)}>\r\n                        <FilePlusIcon/>\r\n                    </MenuButton>\r\n                    <MenuButton\r\n                        tooltip=\"Load Project\"\r\n                        onMouseDown={() => setOpenMenu('load')}>\r\n                        {openMenu === 'load' ? <FolderOpenIcon/> : <FolderWideIcon/>}\r\n                    </MenuButton>\r\n                    <MenuButton\r\n                        tooltip=\"Tutorials\"\r\n                        onMouseDown={() => setOpenMenu('tutorials')}>\r\n                        <StyledLearningIcon className={classNames(!!progress && 'enabled')}/>\r\n                    </MenuButton>\r\n                    <MenuButton\r\n                        // className=\"float-end\"\r\n                        tooltip=\"Options\"\r\n                        onMouseDown={() => setOpenMenu('settings')}>\r\n                        <SettingsIcon/>\r\n                    </MenuButton>\r\n                </div>\r\n            </TopMenu>\r\n            <FloatingMenu top left>\r\n                <TutorialCard/>\r\n            </FloatingMenu>\r\n            <FloatingMenu bottom left>\r\n                <MenuButton\r\n                    className=\"round d-flex align-items-center justify-content-center\"\r\n                    tooltip=\"Reset Viewport\"\r\n                    onMouseDown={() => {\r\n                        AreaPlugin.zoomAt(editor);\r\n                        setZoomAnimating(true);\r\n                    }}>\r\n                    <StyledZoomIcon\r\n                        className={classNames(zoomAnimating && 'animating')}\r\n                        onAnimationEnd={() => setZoomAnimating(false)}\r\n                    />\r\n                </MenuButton>\r\n            </FloatingMenu>\r\n            <FloatingMenu bottom right>\r\n                <MenuButton\r\n                    className=\"compile-button text-uppercase h4 text-muted\"\r\n                    tooltip=\"Compile to Motoko\"\r\n                    onMouseDown={() => setOutputPanel(!outputPanel)}>\r\n                    <small>Compile</small>\r\n                </MenuButton>\r\n            </FloatingMenu>\r\n            <Modal\r\n                show={openMenu}\r\n                onShow={() => ReactTooltip.hide()}\r\n                onHide={() => setOpenMenu(null)}>\r\n                <Modal.Body>\r\n                    {openMenu === 'load' && (\r\n                        <LoadProjectModal/>\r\n                    )}\r\n                    {openMenu === 'tutorials' && (\r\n                        <TutorialsModal/>\r\n                    )}\r\n                    {openMenu === 'settings' && (\r\n                        <SettingsModal/>\r\n                    )}\r\n                </Modal.Body>\r\n            </Modal>\r\n        </>\r\n    );\r\n}","import {useEffect} from 'react';\r\n\r\nexport default function useTimeout(...args) {\r\n    useEffect(() => {\r\n        const id = setTimeout(...args);\r\n        return () => clearTimeout(id);\r\n    });\r\n}\r\n","import React from 'react';\r\n\r\nexport default function ExternalLink({href, children, ...others}) {\r\n    return (\r\n        <a\r\n            href={href}\r\n            target=\"_blank\"\r\n            rel=\"noreferrer\"\r\n            style={{textDecoration: 'none'}}\r\n            {...others}>\r\n            {children}\r\n        </a>\r\n    );\r\n}","import React, {useContext, useState} from 'react';\r\nimport classNames from 'classnames';\r\nimport styled, {css} from 'styled-components';\r\nimport {FiClipboard, FiMaximize2, FiMinimize2, FiX} from 'react-icons/fi';\r\nimport {FaLink, FaPlay} from 'react-icons/fa';\r\nimport CodeEditor from '../monaco/CodeEditor';\r\nimport compileGlobalMotoko from '../../compilers/utils/compileGlobalMotoko';\r\nimport EventsContext, {EDITOR_CHANGE_EVENT} from '../../contexts/EventsContext';\r\nimport useOutputPanelState from '../../hooks/persistent/useOutputPanelState';\r\nimport useFullscreenPanelState from '../../hooks/persistent/useFullscreenPanelState';\r\nimport useListener from '../../hooks/utils/useListener';\r\nimport {CopyToClipboard} from 'react-copy-to-clipboard/lib/Component';\r\nimport ExternalLink from '../common/ExternalLink';\r\nimport useReactTooltip from '../../hooks/useReactTooltip';\r\n\r\nconst OutputContainer = styled.div`\r\n    display: flex;\r\n    flex-direction: column;\r\n    position: absolute;\r\n    top: 54px; // Magic temporary evil number\r\n    bottom: 0;\r\n    right: 0;\r\n    width: 40%;\r\n    transition: 0.4s;\r\n    z-index: 100;\r\n    //padding-top: 95px;\r\n\r\n    ${props => props.closed && css`\r\n        transform: translateX(100%);\r\n    `}\r\n\r\n    ${props => props.fullscreen && css`\r\n        width: 100%;\r\n    `}\r\n`;\r\n\r\nconst ClipboardButton = styled.div`\r\n    opacity: 0.7;\r\n\r\n    &:hover {\r\n        opacity: 1;\r\n    }\r\n`;\r\n\r\nconst outputPanelId = 'output';\r\n\r\nexport default function OutputPanel({editor}) {\r\n\r\n    const [panel, setPanel] = useOutputPanelState();\r\n    const [fullscreen, setFullscreen] = useFullscreenPanelState();\r\n    const [output, setOutput] = useState('');\r\n    const [copied, setCopied] = useState(false);\r\n\r\n    const events = useContext(EventsContext);\r\n\r\n    const closed = !panel;\r\n\r\n    // Generate output source code\r\n    const getOutput = () => {\r\n        return compileGlobalMotoko(editor);\r\n    };\r\n\r\n    useListener(events, EDITOR_CHANGE_EVENT, () => {\r\n        setOutput(closed ? '' : getOutput());\r\n        setCopied(false);\r\n    });\r\n\r\n    useReactTooltip();\r\n\r\n    // Regenerate output after opening panel\r\n    if(!closed && !output) {\r\n        setOutput(getOutput());\r\n    }\r\n\r\n    return (\r\n        <OutputContainer\r\n            className={classNames('output-panel px-3 pt-3')}\r\n            closed={closed}\r\n            fullscreen={fullscreen === outputPanelId}>\r\n            <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                <div className=\"clickable px-2 pb-2\" onClick={() => setPanel(null)}>\r\n                    <FiX size={18}/>\r\n                </div>\r\n                <h3 className=\"mx-3 mb-0 noselect\">Compiled Output</h3>\r\n                <div\r\n                    className=\"clickable px-2 pb-2\"\r\n                    onClick={() => setFullscreen(fullscreen === outputPanelId ? false : outputPanelId)}>\r\n                    {fullscreen === outputPanelId\r\n                        ? <FiMinimize2 size={18}/> // TODO: horizontally flip icons and swap positions with close button?\r\n                        : <FiMaximize2 size={18}/>\r\n                    }\r\n                </div>\r\n            </div>\r\n            <div className=\"flex-grow-1\">\r\n                <CodeEditor value={output} readOnly={true}/>\r\n            </div>\r\n            <div className=\"bottom-bar d-flex flex-row align-items-center justify-content-between py-2\">\r\n                {/*<CopyToClipboard text={output} onCopy={() => setCopied(true)}>*/}\r\n                {/*    <ClipboardButton className=\"clickable d-flex flex-row align-items-center justify-content-center py-2 px-3\">*/}\r\n                {/*        <small>{copied ? 'Copied!' : 'Copy to Clipboard'}</small>*/}\r\n                {/*        <FiClipboard className=\"ms-2\"/>*/}\r\n                {/*    </ClipboardButton>*/}\r\n                {/*</CopyToClipboard>*/}\r\n                <ExternalLink\r\n                    className=\"flex-grow-1\"\r\n                    href=\"https://smartcontracts.org/docs/language-guide/basic-concepts.html\">\r\n                    <div\r\n                        className=\"btn btn-outline-secondary d-flex justify-content-center\"\r\n                        data-tip=\"Learn more about the Motoko programming language.\">\r\n                        <FaLink className=\"mt-1 me-2\"/>\r\n                        Documentation\r\n                    </div>\r\n                </ExternalLink>\r\n                <CopyToClipboard text={output} onCopy={() => setCopied(true)}>\r\n                    <ClipboardButton\r\n                        className=\"clickable d-flex justify-content-center py-2 px-4\"\r\n                        data-tip=\"Copy to Clipboard\"\r\n                        data-delay-show={100}>\r\n                        <FiClipboard className=\"h5 mb-0\"/>\r\n                        {copied && <small className=\"ms-2\">Copied!</small>}\r\n                    </ClipboardButton>\r\n                </CopyToClipboard>\r\n                <ExternalLink className=\"flex-grow-1\" href=\"https://m7sm4-2iaaa-aaaab-qabra-cai.raw.ic0.app/\">\r\n                    <div\r\n                        className=\"btn btn-outline-success d-flex justify-content-center\"\r\n                        data-tip=\"Run and deploy your smart contract on Motoko Playground.\">\r\n                        <FaPlay className=\"mt-1 me-2\"/>\r\n                        Playground\r\n                    </div>\r\n                </ExternalLink>\r\n            </div>\r\n        </OutputContainer>\r\n    );\r\n}","import useLocalStorage from '../utils/useLocalStorage';\r\n\r\nexport default function useFullscreenPanelState() {\r\n    return useLocalStorage('blocks.fullscreenPanel', false);\r\n}\r\n","import React from 'react';\r\nimport useControlValue from '../../../hooks/utils/useControlValue';\r\nimport classNames from 'classnames';\r\n\r\n\r\nexport default function TextControlHandle({control, bindInput, validation: {minLength, maxLength}}) {\r\n    let [value, setValue] = useControlValue(control);\r\n\r\n    let invalid = !control.validate(value);\r\n\r\n    return (\r\n        <input\r\n            type=\"text\"\r\n            className={classNames('w-100', invalid && 'invalid')}\r\n            autoComplete=\"blocks-app\"\r\n            autoCorrect=\"off\"\r\n            ref={bindInput}\r\n            value={value || ''}\r\n            placeholder={control.name}\r\n            minLength={minLength}\r\n            maxLength={maxLength}\r\n            onChange={event => setValue(event.target.value || undefined)}\r\n        />\r\n    );\r\n}\r\n","import {sentenceCase} from 'change-case';\r\n\r\nexport default function getDefaultLabel(text) {\r\n    if(!text) {\r\n        return '';\r\n    }\r\n    return sentenceCase(text);\r\n}","import {anyType, getType, TYPE_MAP} from '../../../block-types/types';\r\nimport React, {useContext} from 'react';\r\nimport EventsContext, {ERROR_EVENT} from '../../../contexts/EventsContext';\r\nimport classNames from 'classnames';\r\nimport useReactTooltip from '../../../hooks/useReactTooltip';\r\nimport getDefaultLabel from '../../../utils/getDefaultLabel';\r\n\r\nexport default function TypeSelect({value, constraintType, abstract, invalid, onChange, ...others}) {\r\n\r\n    constraintType = constraintType || anyType;\r\n\r\n    const types = [...TYPE_MAP.values()]\r\n        .filter(type => (abstract || !type.data.abstract) && constraintType.isSubtype(type));\r\n\r\n    let events = useContext(EventsContext);\r\n\r\n    if(value) {\r\n        try {\r\n            value = getType(value);\r\n        }\r\n        catch(err) {\r\n            onChange(value = undefined);///\r\n            // console.error(err);\r\n            events.emit(ERROR_EVENT, err);\r\n        }\r\n    }\r\n\r\n    invalid = invalid || !value || !types.some(t => t.isSubtype(value));\r\n\r\n    // if(invalid && types.length) {\r\n    //     let firstType = types[0];\r\n    //     if(firstType) {\r\n    //         onChange(value = firstType);\r\n    //     }\r\n    //     // value = constraintType;\r\n    // }\r\n\r\n    useReactTooltip();\r\n\r\n    return (\r\n        <>\r\n            <select\r\n                className={classNames(invalid && 'invalid')}\r\n                value={value?.name}\r\n                onChange={event => onChange(getType(event.target.value))}\r\n                {...others}>\r\n                {invalid && <option label=\"(Type)\" value={value?.name}/>}\r\n                {types.map(type => (\r\n                    <option key={type.name} label={type.name} value={type.name}/>\r\n                ))}\r\n            </select>\r\n            <div className=\"ps-2\">\r\n                {value?.generics?.map((type, i) => (\r\n                    <TypeSelect\r\n                        key={i}\r\n                        value={type}\r\n                        constraintType={value.data.baseType.generics[i]}\r\n                        abstract={abstract}\r\n                        data-tip={getDefaultLabel(value.data.genericNames?.[i])}\r\n                        onChange={t => {\r\n                            let generics = [...value.generics];\r\n                            generics.splice(i, 1, t);\r\n                            onChange(getType({\r\n                                ...value.toJSON(),\r\n                                generics,\r\n                            }));\r\n                        }}/>\r\n                ))}\r\n            </div>\r\n        </>\r\n    );\r\n}","import {getBlock} from '../editor/blocks';\r\nimport getBlockLabel from './getBlockLabel';\r\n\r\nexport default function getNodeLabel(node, editor, simplified) {\r\n    let block = getBlock(node.name);\r\n    if(!simplified && block && block.computeTitle) {\r\n        let title = block.computeTitle(node, editor);\r\n        if(title) {\r\n            return title;\r\n        }\r\n    }\r\n    return getBlockLabel(block);\r\n}","import * as Rete from 'rete';\r\nimport TextControlHandle from '../../components/rete/controls/TextControlHandle';\r\nimport EventEmitter from 'events';\r\nimport {bindNodeInput} from '../../utils/bindNodeInput';\r\nimport TypeControlHandle from '../../components/rete/controls/TypeControlHandle';\r\nimport NodeControlHandle from '../../components/rete/controls/NodeControlHandle';\r\nimport CheckboxControlHandle from '../../components/rete/controls/CheckboxControlHandle';\r\nimport NumberControlHandle from '../../components/rete/controls/NumberControlHandle';\r\n\r\n// TODO: static assertions\r\nconst controlTypes = {\r\n    text: TextControlHandle,\r\n    number: NumberControlHandle,\r\n    checkbox: CheckboxControlHandle,\r\n    node: NodeControlHandle,\r\n    type: TypeControlHandle,\r\n};\r\n\r\nexport default class BaseControl extends Rete.Control {\r\n    constructor(editor, key, name, config = {}) {\r\n        super(key);\r\n\r\n        this.name = name;\r\n        this.config = config;\r\n        this.editor = editor;\r\n        this.render = 'react';\r\n        this.component = (typeof config.controlType === 'string' ? controlTypes[config.controlType] : config.controlType) || TextControlHandle;\r\n        this.props = {\r\n            ...config.controlProps,\r\n            validation: config.validation || {},\r\n            control: this,\r\n            editor,\r\n            bindInput: bindNodeInput,\r\n        };\r\n\r\n        this.events = new EventEmitter();\r\n    }\r\n\r\n    validate(value) {\r\n        if(value === undefined && !this.config.optional) {\r\n            return false;\r\n        }\r\n        if(value !== null && value !== undefined) {\r\n            let validation = this.config.validation;\r\n            if(validation) {\r\n                if('custom' in validation && !validation.custom(value)) {\r\n                    return false;\r\n                }\r\n                if('minLength' in validation && value.length < validation.minLength) {\r\n                    return false;\r\n                }\r\n                if('maxLength' in validation && value.length > validation.maxLength) {\r\n                    return false;\r\n                }\r\n                if('min' in validation && value < validation.min) {\r\n                    return false;\r\n                }\r\n                if('max' in validation && value > validation.max) {\r\n                    return false;\r\n                }\r\n                if('step' in validation && value - (validation.min || 0) % validation.step !== 0) {\r\n                    return false;\r\n                }\r\n                if('pattern' in validation && !validation.pattern.test(value)) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    getDefaultValue() {\r\n        // return this.config.defaultValue;\r\n    }\r\n\r\n    getValue() {\r\n        let value = this.getData(this.key);\r\n        return value === undefined ? this.getDefaultValue() : value;\r\n    }\r\n\r\n    setValue(value) {\r\n        if(this.getData(this.key) === value) {\r\n            return;\r\n        }\r\n\r\n        this.putData(this.key, value);\r\n        this.events.emit('update', value);\r\n\r\n        this.config.onChange?.(this);////\r\n    }\r\n}\r\n","import React from 'react';\r\nimport useControlValue from '../../../hooks/utils/useControlValue';\r\n\r\n\r\nexport default function NumberControlHandle({control, bindInput, validation: {min, max, step}}) {\r\n    let [value, setValue] = useControlValue(control);\r\n\r\n    return (\r\n        <input\r\n            type=\"number\"\r\n            style={{width: '4em'}}\r\n            ref={bindInput}\r\n            min={min}\r\n            max={max}\r\n            step={step}\r\n            value={value || 0}\r\n            onChange={event => setValue(+event.target.value || event.target.value)}\r\n        />\r\n    );\r\n}\r\n","import React from 'react';\r\nimport useControlValue from '../../../hooks/utils/useControlValue';\r\n\r\n\r\nexport default function CheckboxControlHandle({control, bindInput}) {\r\n    let [value, setValue] = useControlValue(control);\r\n\r\n    return (\r\n        <label ref={bindInput}>\r\n            <input\r\n                type=\"checkbox\"\r\n                checked={!!value}\r\n                onChange={event => setValue(event.target.checked)}\r\n            />\r\n            <span className=\"input-title my-0\" style={{verticalAlign: 'top'}}>{control.name}</span>\r\n        </label>\r\n    );\r\n}\r\n","import React, {useContext, useState} from 'react';\r\nimport useControlValue from '../../../hooks/utils/useControlValue';\r\nimport EventsContext, {EDITOR_CHANGE_EVENT} from '../../../contexts/EventsContext';\r\nimport useListener from '../../../hooks/utils/useListener';\r\nimport getNodeLabel from '../../../utils/getNodeLabel';\r\nimport classNames from 'classnames';\r\nimport {getBlock} from '../../../editor/blocks';\r\n\r\n\r\nexport default function NodeControlHandle({editor, control, bindInput}) {\r\n    let [value, setValue] = useControlValue(control);\r\n\r\n    let [nodes, setNodes] = useState(() => [...editor.nodes]);\r\n\r\n    let events = useContext(EventsContext);\r\n    useListener(events, EDITOR_CHANGE_EVENT, () => setNodes([...editor.nodes]));\r\n\r\n    let blockName = control.config.type?.meta.block;///\r\n    let blockFilter = blockName && (Array.isArray(blockName) ? blockName : [blockName]).map(block => {\r\n        let name = typeof block === 'string' ? block : block.name;\r\n        getBlock(name); // Ensure block exists\r\n        return name;\r\n    });\r\n\r\n    if(blockFilter) {\r\n        nodes = nodes.filter(n => !blockFilter || blockFilter.includes(n.name));\r\n    }\r\n\r\n    let invalid = !value || !nodes.some(n => String(n.id) === String(value) && (!blockFilter || blockFilter.includes(n.name)));\r\n\r\n    // TODO: cleanly prevent number -> string id conversion\r\n    return (\r\n        <select\r\n            ref={bindInput}\r\n            className={classNames(invalid && 'invalid')}\r\n            style={{maxWidth: '100%'}}\r\n            value={value}\r\n            onChange={event => setValue(event.target.value || undefined)}>\r\n            <option key={-1} label={'(Select a Node)'} value={undefined}/>\r\n            {nodes.map(node => (\r\n                <option key={node.id} label={getNodeLabel(node, editor)} value={node.id}/>\r\n            ))}\r\n        </select>\r\n    );\r\n}\r\n","import React from 'react';\r\nimport useControlValue from '../../../hooks/utils/useControlValue';\r\nimport TypeSelect from '../../common/inputs/TypeSelect';\r\n\r\n\r\nexport default function TypeControlHandle({abstract, control, bindInput}) {\r\n    let [value, setValue] = useControlValue(control);\r\n\r\n    let constraintType = control.config.type.generics[0];\r\n\r\n    let invalid = !control.validate(value);\r\n\r\n    // if(typeType.isSubtype(value)) {\r\n    //     value = value?.generics[0];\r\n    // }\r\n\r\n    return (\r\n        <div ref={bindInput}>\r\n            <TypeSelect\r\n                value={value}\r\n                constraintType={constraintType}\r\n                abstract={abstract}\r\n                invalid={invalid}\r\n                onChange={setValue/*type => setValue(typeType.of(type))*/}>\r\n            </TypeSelect>\r\n        </div>\r\n    );\r\n}\r\n","import BaseControl from './BaseControl';\r\n\r\nexport default class PropControl extends BaseControl {\r\n    constructor(editor, prop, name) {\r\n        super(editor, prop.key, name, {\r\n            ...prop.type?.data || {},\r\n            ...prop.config || {},\r\n            prop,\r\n            type: prop.type,\r\n            optional: prop.optional,\r\n        });\r\n    }\r\n\r\n    getDefaultValue() {\r\n        // let value = super.getDefaultValue();\r\n        // return value !== undefined ? value : this.config.type?.getDefaultValue();\r\n\r\n        if('controlDefault' in this.config) {\r\n            return this.config.controlDefault;\r\n        }\r\n\r\n        return this.config.type?.getDefaultValue();\r\n    }\r\n\r\n    getValue() {\r\n        let value = super.getValue();\r\n        if(this.config.type?.fromJSON) {\r\n            value = this.config.type.fromJSON(value, this);\r\n        }\r\n        return value;\r\n    }\r\n}","import {getType} from '../block-types/types';\r\n\r\nexport default function flattenUniqueTypes(type, array = []) {\r\n    type = getType(type);\r\n    if(!array.includes(type)) {\r\n        array.push(type);\r\n    }\r\n    for(const generic of type.generics) {\r\n        flattenUniqueTypes(generic, array);\r\n    }\r\n    return array;\r\n}\r\n","import Rete from 'rete';\r\nimport {getType} from '../../block-types/types';\r\nimport flattenUniqueTypes from '../../utils/flattenUniqueTypes';\r\n\r\nexport default class PropSocket extends Rete.Socket {\r\n    constructor(title, prop) {\r\n        const type = getType(prop.type);\r\n        super(title, {...type.data, type});\r\n\r\n        this.prop = prop;\r\n    }\r\n\r\n    findProp() {\r\n        return this.prop;\r\n    }\r\n\r\n    findLabel() {\r\n        const type = this.findType();\r\n\r\n        // let text = type.toTypeString();\r\n        let text = '';\r\n        for(const relevant of flattenUniqueTypes(type)) {\r\n            const info = relevant.meta.info || relevant.data.info;\r\n            if(info) {\r\n                if(text) {\r\n                    text += '<br>';\r\n                }\r\n                text += `${relevant.toTypeString()} : ${info}`;\r\n            }\r\n        }\r\n        return text;\r\n    }\r\n\r\n    findType() {\r\n        return this.data.type;\r\n    }\r\n\r\n    compatibleWith(other) {\r\n        if(!('findType' in other)) {\r\n            return false;\r\n        }\r\n        let type = this.findType();\r\n        let otherType = other.findType();\r\n\r\n        return type.isSubtype(otherType) || otherType.isSubtype(type);\r\n    }\r\n}","import PropSocket from './PropSocket';\r\nimport {typeType} from '../../block-types/types';\r\n\r\nexport default class PropOutputSocket extends PropSocket {\r\n    constructor(node, title, prop, typeCompiler) {\r\n        super(title, prop/*.type*/);\r\n\r\n        this.nodeId = node.id;\r\n        this.nodeName = node.name;\r\n        // this.prop = prop;\r\n        this.typeCompiler = typeCompiler;\r\n\r\n        this._isTypeOfType = typeType.isSubtype(this.prop.type);\r\n    }\r\n\r\n    findType() {\r\n        if(this.typeCompiler.editor.silent) {\r\n            return super.findType();\r\n        }\r\n\r\n        try {\r\n            let type = this.typeCompiler.getOutput(this.nodeId, this.prop.key);\r\n            if(type) {\r\n                if(this._isTypeOfType) {\r\n                    if(typeType.isSubtype(type)) {\r\n                        console.warn('Type of Type of Type (Intentional?)');\r\n                    }\r\n                    type = typeType.of(type);\r\n                }\r\n                return type || super.findType();\r\n            }\r\n        }\r\n        catch(err) {\r\n            console.warn(`Error on socket [${this.nodeName}.${this.prop.key}]:`, err);///\r\n        }\r\n        return super.findType();\r\n    }\r\n\r\n    // compatibleWith(other) {\r\n    //     if(!('findType' in other)) {\r\n    //         return;\r\n    //     }\r\n    //     let reversed = !!this.data.reversed;\r\n    //     if(reversed === !other.data.reversed) {\r\n    //         return false;\r\n    //     }\r\n    //     let self = this;\r\n    //     if(!reversed) {\r\n    //         [self, other] = [other, self];\r\n    //     }\r\n    //     let selfType = self.findType();\r\n    //     let otherType = other.findType();\r\n    //\r\n    //     console.log(selfType, otherType);\r\n    //\r\n    //     return selfType && selfType.isSubtype(otherType);\r\n    // }\r\n}","import getDefaultLabel from './getDefaultLabel';\r\n\r\nexport default function getPropLabel(prop) {\r\n    if(!prop) {\r\n        return '';\r\n    }\r\n    return prop.title || getDefaultLabel(prop.key);\r\n}","import Rete from 'rete';\r\nimport PropControl from '../controls/PropControl';\r\nimport PropSocket from '../sockets/PropSocket';\r\nimport PropOutputSocket from '../sockets/PropOutputSocket';\r\nimport {sentenceCase} from 'change-case';\r\nimport getPropLabel from '../../utils/getPropLabel';\r\n\r\nexport default class BlockComponent extends Rete.Component {\r\n\r\n    constructor(block) {\r\n        super(block.name);\r\n\r\n        this.block = block;\r\n        this.keywords = [\r\n            ...sentenceCase(block.name).toLowerCase().split(' ').filter(s => s),\r\n            ...block.title?.split(' ').filter(s => s) || [],\r\n            ...block.keywords || [],\r\n        ];\r\n    }\r\n\r\n    getEditorNode(node) {\r\n        return this.editor.nodes.find(n => n.id === node.id);\r\n    }\r\n\r\n    getControls(node) {\r\n        return this.getEditorNode(node).controls;\r\n    }\r\n\r\n    async builder(node) {\r\n        // noinspection JSCheckFunctionSignatures\r\n        this.editor.trigger('prenodecreate', node, this);\r\n\r\n        const addProp = (prop, isPropOutput) => {\r\n            let title = getPropLabel(prop);\r\n            let socket = isPropOutput ? new PropOutputSocket(node, title, prop, this.editor.compilers.type) : new PropSocket(title, prop);\r\n            if(!!prop.type.data.reversed === isPropOutput) {\r\n                return addPropInput(prop, socket, isPropOutput);\r\n            }\r\n            else {\r\n                return addPropOutput(prop, socket, isPropOutput);\r\n            }\r\n        };\r\n\r\n        const addPropInput = (prop, socket, isOutput) => {\r\n            let title = getPropLabel(prop);\r\n            let input = new Rete.Input(prop.key, title, socket, prop.type.data.reversed || !!prop.multi);\r\n            if(shouldPropHaveControl(prop, socket, isOutput)) {\r\n                input.addControl(new PropControl(this.editor, prop, title));\r\n            }\r\n            node.addInput(input);\r\n            return input;\r\n        };\r\n\r\n        const addPropOutput = (prop, socket, isOutput) => {\r\n            let title = getPropLabel(prop);\r\n            let output = new Rete.Output(prop.key, title, socket, !prop.type.data.reversed || !!prop.multi);\r\n            node.addOutput(output);\r\n            if(shouldPropHaveControl(prop, socket, isOutput)) {\r\n                node.addControl(new PropControl(this.editor, prop, title));\r\n            }\r\n            return output;\r\n        };\r\n\r\n        const shouldPropHaveControl = (prop, socket, isOutput) => {\r\n            return prop.control || (!!socket.data.reversed === isOutput && socket.data.controlType && !prop.multi);\r\n        };\r\n\r\n        for(let prop of this.block.inputs) {\r\n            addProp(prop, false);\r\n        }\r\n        for(let prop of this.block.outputs) {\r\n            addProp(prop, true);\r\n        }\r\n\r\n        for(let prop of this.block.controls) {\r\n            let title = getPropLabel(prop);\r\n            node.addControl(new PropControl(this.editor, prop, title));\r\n        }\r\n\r\n        // // Advanced mode control if relevant\r\n        // if(this.block.props.find(prop => prop.advanced)) {\r\n        //     node.addControl(new BaseControl(this.editor, 'editor:advanced', 'Advanced', {\r\n        //         controlType: CheckboxControlHandle,\r\n        //     }));\r\n        // }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\n// List of functions to call when starting/ending a connection (event listener optimization)\r\nexport default React.createContext([]);\r\n","import Compiler from './Compiler';\r\n\r\nexport default class NodeCompiler extends Compiler {\r\n    constructor(editor) {\r\n        super(editor, 'toEditorNode');\r\n    }\r\n\r\n    defaultCompile(prop, node) {\r\n        return node;\r\n    }\r\n\r\n    postCompile(result, node, key) {\r\n        if(!result) {\r\n            return;\r\n        }\r\n        let id;\r\n        if(typeof result === 'object') {\r\n            id = result.id;\r\n            if(!id) {\r\n                throw new Error(`Invalid node object with keys: {${Object.keys(result).join(', ')}}`);\r\n            }\r\n        }\r\n        else {\r\n            id = result;\r\n        }\r\n        // Convert node id to string in case of number/string mismatch\r\n        id = String(id);\r\n        return this.editor.nodes.find(n => String(n.id) === id);\r\n    }\r\n}","import Compiler from './Compiler';\r\nimport {getType} from '../block-types/types';\r\n\r\nexport default class TypeCompiler extends Compiler {\r\n    constructor(editor) {\r\n        super(editor, 'inferType');\r\n    }\r\n\r\n    defaultCompile(prop, node) {\r\n        return getType(prop.type);\r\n    }\r\n\r\n    postCompile(type, node, key) {\r\n        // if(typeof type === 'string' || typeof type === 'number' || typeof type === 'boolean' || type === null || type === undefined) {\r\n        //     return type;/////////\r\n        // }\r\n        if(type === undefined) {\r\n            return;\r\n        }\r\n        type = getType(type);\r\n        if(type.isAbstract()) {\r\n            console.warn(`[${node.name}.${key}]`, 'Abstract inferred type:', type.toTypeString());\r\n            return;\r\n        }\r\n        return type;\r\n    }\r\n}","import Compiler from './Compiler';\r\n\r\nexport default class ControlCompiler extends Compiler {\r\n    constructor(editor) {\r\n        super(editor, 'toControl');\r\n    }\r\n\r\n    defaultCompile(prop, node) {\r\n    }\r\n\r\n    postCompile(result, node, key) {\r\n        return result;\r\n    }\r\n}","import Rete from 'rete';\r\nimport MotokoCompiler from '../compilers/MotokoCompiler';\r\nimport NodeCompiler from '../compilers/NodeCompiler';\r\nimport TypeCompiler from '../compilers/TypeCompiler';\r\nimport ControlCompiler from '../compilers/ControlCompiler';\r\nimport compileGlobalMotoko from '../compilers/utils/compileGlobalMotoko';\r\n\r\n// Custom Rete.js node editor implementation\r\n\r\nexport default class BlocksNodeEditor extends Rete.NodeEditor {\r\n    constructor(...args) {\r\n        super(...args);\r\n\r\n        this.projectName = '';\r\n        this.projectDescription = '';\r\n        this.compilers = {\r\n            control: new ControlCompiler(this),\r\n            node: new NodeCompiler(this),\r\n            type: new TypeCompiler(this),\r\n            motoko: new MotokoCompiler(this),\r\n        };\r\n\r\n        // Called before node creation\r\n        this.bind('prenodecreate');\r\n\r\n        // Clear all event listeners after destroy\r\n        this.on('destroy', () => {\r\n            setTimeout(() => {\r\n                for(let array of Object.values(this.events)) {\r\n                    array.length = 0;\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    off(event, listener) {\r\n        const events = this.events[event];\r\n        if(!events) {\r\n            return;\r\n        }\r\n        const index = events.indexOf(listener);\r\n        if(index !== -1) {\r\n            events.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    // noinspection JSCheckFunctionSignatures\r\n    toJSON() {\r\n        const language = 'motoko';\r\n        let output;\r\n        try {\r\n            // TODO: optimize / refactor?\r\n            output = compileGlobalMotoko(this);\r\n        }\r\n        catch(err) {\r\n            console.warn(`Error while compiling before save: ${err}`);\r\n            // console.warn(err);\r\n        }\r\n\r\n        let json = {\r\n            name: this.projectName,\r\n            description: this.projectDescription,\r\n            version: this.id,\r\n            language,\r\n            output: output || null,\r\n            ...super.toJSON(),\r\n        };\r\n        delete json.id;\r\n        // noinspection JSValidateTypes\r\n        return json;\r\n    }\r\n\r\n    async fromJSON(json) {\r\n        // noinspection JSUnresolvedVariable\r\n        json = {id: json.version, ...json};\r\n\r\n        if(!this.beforeImport(json)) {\r\n            return false;\r\n        }\r\n\r\n        // TODO: refactor serialization\r\n        this.projectName = json.name || '';\r\n        this.projectDescription = json.description || '';\r\n\r\n        let hadError = false;\r\n        try {\r\n            const nodes = {};\r\n            await Promise.all(Object.entries(json.nodes).map(async ([id, jsonNode]) => {\r\n                try {\r\n                    const component = this.getComponent(jsonNode.name);\r\n                    const node = await component.build(Rete.Node.fromJSON(jsonNode));\r\n                    nodes[id] = node;\r\n                    this.addNode(node);\r\n                }\r\n                catch(e) {\r\n                    hadError = true;\r\n                    return this.trigger('error', e);\r\n                }\r\n            }));\r\n\r\n            Object.entries(json.nodes).forEach(([id, jsonNode]) => {\r\n                const node = nodes[id];\r\n\r\n                Object.entries(jsonNode.outputs).forEach(([key, jsonOutput]) => {\r\n                    try {\r\n                        jsonOutput.connections.forEach(jsonConnection => {\r\n                            const nodeId = jsonConnection.node;\r\n                            const data = jsonConnection.data;\r\n                            const targetOutput = node.outputs.get(key);\r\n                            const otherNode = nodes[nodeId];\r\n                            if(!otherNode) {\r\n                                hadError = true;\r\n                                return this.trigger('error', `Tried to connect to unknown node ${node.id}`);\r\n                            }\r\n                            const targetInput = otherNode.inputs.get(jsonConnection.input);\r\n\r\n                            if(!targetOutput || !targetInput) {\r\n                                hadError = true;\r\n                                return this.trigger('error', `IO not found for node ${node.id}`);\r\n                            }\r\n\r\n                            this.connect(targetOutput, targetInput, data);\r\n                        });\r\n                    }\r\n                    catch(e) {\r\n                        hadError = true;\r\n                        return this.trigger('error', e);\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        catch(e) {\r\n            this.trigger('warn', e);\r\n            hadError = true;\r\n        }\r\n        return this.afterImport() && !hadError;\r\n    }\r\n\r\n    async createNode(component, data = {}, position = null) {\r\n        let node = await component.createNode(data);\r\n        if(position) {\r\n            let {x, y} = position;\r\n            [node.position[0], node.position[1]] = [x, y];\r\n        }\r\n        this.addNode(node);\r\n        return node;\r\n    }\r\n\r\n    async createNodeAtCursor(component, data = {}) {\r\n        let {x, y} = this.view.area.mouse;\r\n        return this.createNode(component, data, {x: x - 80, y: y - 20});\r\n    }\r\n\r\n    updateNode(node) {\r\n        node.update();\r\n        setTimeout(() => {\r\n            for(const io of [...node.inputs.values(), ...node.outputs.values()]) {\r\n                for(const conn of io.connections) {\r\n                    this.view.connections.get(conn)?.update();\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    connect(output, input, data) {\r\n        if(output.node && output.node === input.node) {\r\n            return;\r\n        }\r\n        super.connect(output, input, data);\r\n    }\r\n}\r\n","import {useContext, useState} from 'react';\r\nimport EventsContext, {EDITOR_CHANGE_EVENT} from '../../../../contexts/EventsContext';\r\nimport useListener from '../../../../hooks/utils/useListener';\r\nimport useReactTooltip from '../../../../hooks/useReactTooltip';\r\n\r\nexport default function DynamicTitle({editor, node, block, fallback}) {\r\n\r\n    const computeTitle = () => {\r\n        /// untested\r\n        if(editor.silent) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            return block.computeTitle(node, editor);\r\n        }\r\n        catch(err) {\r\n            console.error(`Unable to compute title for node: ${node.name}`);\r\n            console.error(err);\r\n            return '<Error>';\r\n        }\r\n    };\r\n\r\n    const [title, setTitle] = useState(computeTitle);\r\n\r\n    const events = useContext(EventsContext);\r\n\r\n    useListener(events, EDITOR_CHANGE_EVENT, () => setTitle(computeTitle()));\r\n\r\n    const result = title || fallback || null;\r\n\r\n    useReactTooltip();\r\n\r\n    return (\r\n        <span data-tip={result}>{result}</span>\r\n    );\r\n}","import React, {useCallback, useContext, useEffect, useState} from 'react';\r\nimport classNames from 'classnames';\r\nimport Rete, {Output} from 'rete';\r\nimport ConnectionAwareListContext from '../../../contexts/ConnectionAwareListContext';\r\nimport useReactTooltip from '../../../hooks/useReactTooltip';\r\n\r\n// Derived from: https://github.com/retejs/react-render-plugin/blob/master/src/Socket.jsx\r\n\r\nexport function SocketHandle(props) {\r\n    const {type, propKey, socket, innerRef, io} = props;\r\n\r\n    const [relevant, setRelevant] = useState(false);\r\n    const [requested, setRequested] = useState(null);\r\n\r\n    const connectionAwareList = useContext(ConnectionAwareListContext);\r\n\r\n    const socketType = socket.findType();\r\n    const reversed = !!socketType.data.reversed;\r\n\r\n    // Does the socket accept multiple inputs?\r\n    const multiple = io.multipleConnections && (io instanceof Rete.Input) !== reversed;\r\n\r\n    // console.log('redraw');////\r\n\r\n    // let socketRef;\r\n    const bindRef = el => {\r\n        // socketRef = el;\r\n        el && innerRef(el, type, io);\r\n    };\r\n\r\n    // Update whether the socket is requesting a connection\r\n    let timeout;\r\n    const updateRequested = useCallback(() => {\r\n        clearTimeout(timeout);\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n        timeout = setTimeout(() => {\r\n            // TODO: memory leak?\r\n            let requested = !io.connections.length;\r\n            if(requested) {\r\n                const prop = socket.findProp?.();\r\n                requested = !!(prop?.input && (\r\n                    prop.request || (!prop.optional && !multiple && !io.control)\r\n                ));\r\n            }\r\n            setRequested(requested);\r\n        });\r\n    }, [io, multiple, socket]);\r\n\r\n    if(requested === null) {\r\n        updateRequested();\r\n    }\r\n\r\n    useEffect(() => {\r\n        const listener = (starting, connectionIO) => {\r\n            if(starting) {\r\n                if((io instanceof Output) === (connectionIO instanceof Output)) {\r\n                    return;\r\n                }\r\n                if(io.node && io.node === connectionIO.node) {\r\n                    return;\r\n                }\r\n                let [input, output] = (io instanceof Output) === !!socket.data.reversed\r\n                    ? [io, connectionIO] : [connectionIO, io];\r\n\r\n                let [inputType, outputType] = [input.socket.findType?.(), output.socket.findType?.()];\r\n\r\n                if(outputType && inputType?.isSubtype(outputType)) {\r\n                    setRelevant(true);\r\n                }\r\n            }\r\n            else {\r\n                setRelevant(false);\r\n            }\r\n            updateRequested();\r\n        };\r\n        connectionAwareList.push(listener);\r\n        return () => {\r\n            let index = connectionAwareList.indexOf(listener);\r\n            if(index !== -1) {\r\n                connectionAwareList.splice(index, 1);\r\n            }\r\n            else {\r\n                console.warn('Missing connection aware listener on cleanup');\r\n            }\r\n            clearTimeout(timeout);///\r\n        };\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [socket, io, connectionAwareList, updateRequested]);\r\n\r\n    useReactTooltip();\r\n\r\n    return (\r\n        <div\r\n            ref={bindRef}\r\n            className={classNames(\r\n                'socket',\r\n                type,\r\n                propKey && 'key-' + propKey,\r\n                relevant && 'relevant',\r\n                multiple && 'multiple',\r\n                reversed && 'reversed',\r\n                requested && 'requested',\r\n                !multiple && io.connections.length && 'occupied',\r\n                'category-' + socketType.data.category,\r\n            )}\r\n            // title={socket.name}\r\n            data-tip={`${socket.findLabel?.() || socket.name}`}>\r\n            <div className=\"requested-wrapper w-100 h-100\">\r\n                <div className=\"socket-color w-100 h-100\"/>\r\n            </div>\r\n        </div>\r\n    );\r\n}","import React, {useContext} from 'react';\r\nimport {bindNodeInput} from '../../../../utils/bindNodeInput';\r\nimport getBlockLabel from '../../../../utils/getBlockLabel';\r\nimport EventsContext, {ERROR_EVENT} from '../../../../contexts/EventsContext';\r\nimport useReactTooltip from '../../../../hooks/useReactTooltip';\r\nimport classNames from 'classnames';\r\nimport useLearningModeState from '../../../../hooks/persistent/useLearningModeState';\r\n\r\nexport default function ShortcutButton({editor, node, shortcut}) {\r\n    const {block} = shortcut;\r\n    const {category} = block;\r\n\r\n    const [learningMode] = useLearningModeState();\r\n\r\n    const events = useContext(EventsContext);\r\n\r\n    const onClick = async event => {\r\n        if(event.button !== 0) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            let component = editor.components.get(block.name);\r\n            if(!component) {\r\n                events.emit(ERROR_EVENT, `Component not found: ${block.name}`);\r\n                return;\r\n            }\r\n            let data = {};\r\n            if(node && shortcut.nodeKey) {\r\n                data[shortcut.nodeKey] = node.id;\r\n            }\r\n            let newNode = await editor.createNodeAtCursor(component, data);\r\n\r\n            // Start dragging node\r\n            let nodeView = editor.view.nodes.get(newNode);\r\n            nodeView._drag.down(event);\r\n\r\n            // Add shortcut-defined connections\r\n            if(shortcut.connections) {\r\n                for(let connection of shortcut.connections) {\r\n                    let {from, to, fromOutput} = connection;\r\n\r\n                    let fromIO = fromOutput ? node.outputs.get(from) : node.inputs.get(from);\r\n                    let toIO = (fromOutput ? newNode.inputs.get(to) : newNode.outputs.get(to));\r\n                    let [output, input] = fromOutput ? [fromIO, toIO] : [toIO, fromIO];\r\n                    if(output && input) {\r\n                        editor.connect(output, input);\r\n                    }\r\n                    else {\r\n                        console.warn('Could not connect', output, 'to', input);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        catch(err) {\r\n            events.emit(ERROR_EVENT, err);\r\n        }\r\n    };\r\n\r\n    useReactTooltip();\r\n\r\n    const label = getBlockLabel(block);\r\n\r\n    return (\r\n        <div\r\n            ref={bindNodeInput}\r\n            className={classNames('btn node-shortcut-button px-1 pt-0 pb-1', `shortcut-block-${block.name}`)}\r\n            data-tip={learningMode && block.info ? `${label} : ${block.info}` : label}\r\n            data-delay-show={100}\r\n            style={{\r\n                // background: 'none',\r\n                color: category.data.color,\r\n                borderColor: category.data.color,\r\n                cursor: 'grab',\r\n                // fontSize: '1em',\r\n            }}\r\n            onMouseDown={onClick}>\r\n            {block.icon\r\n                ? React.createElement(block.icon)\r\n                : getBlockLabel(block)}\r\n        </div>\r\n    );\r\n}","import {SocketHandle} from '../../sockets/SocketHandle';\r\nimport {Control} from 'rete-react-render-plugin';\r\nimport classNames from 'classnames';\r\nimport {paramCase} from 'change-case';\r\nimport getPropLabel from '../../../../utils/getPropLabel';\r\nimport React from 'react';\r\n\r\nexport default function PropField({prop, node, hideLeft, hideRight, bindSocket, bindControl}) {\r\n    // const [advanced] = useAdvancedPropsState();\r\n    const advanced = !!node.data['editor:advanced'];////\r\n    // const advanced = true; // Always show advanced props for now\r\n\r\n    let input = node.inputs.get(prop.key);\r\n    let output = node.outputs.get(prop.key);\r\n    let control = node.controls.get(prop.key) || (input?.showControl() && input.control);\r\n\r\n    if(prop.advanced && !advanced) {\r\n        if(\r\n            (!input || !input.connections.length) &&\r\n            (!output || !output.connections.length) &&\r\n            (!control || control.getValue() === control.getDefaultValue())\r\n        ) {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    let leftSocket = input && !hideLeft && (\r\n        <SocketHandle\r\n            type=\"input\"\r\n            socket={input.socket}\r\n            propKey={prop.key}\r\n            io={input}\r\n            innerRef={bindSocket}\r\n        />\r\n    );\r\n    let rightSocket = output && !hideRight && (\r\n        <SocketHandle\r\n            type=\"output\"\r\n            propKey={prop.key}\r\n            socket={output.socket}\r\n            io={output}\r\n            innerRef={bindSocket}\r\n        />\r\n    );\r\n    let controlField = control && (\r\n        <Control\r\n            className={input ? 'input-control' : 'control'}\r\n            control={control}\r\n            innerRef={bindControl}\r\n        />\r\n    );\r\n\r\n    return (\r\n        <div className={classNames('prop', 'key-' + paramCase(prop.key), !advanced && prop.advanced && 'advanced')}>\r\n            <div className=\"input\">\r\n                {leftSocket}\r\n                {controlField || (leftSocket && (\r\n                    <div className=\"input-title\">{getPropLabel(prop)}</div>\r\n                ))}\r\n            </div>\r\n            <div className=\"output\">\r\n                {!input && (rightSocket && (\r\n                    <div className=\"output-title\">{getPropLabel(prop)}</div>\r\n                ))}\r\n                {rightSocket}\r\n            </div>\r\n        </div>\r\n    );\r\n}","import React from 'react';\r\nimport getNodeLabel from '../../../../utils/getNodeLabel';\r\nimport DynamicTitle from '../parts/DynamicTitle';\r\nimport getPropLabel from '../../../../utils/getPropLabel';\r\nimport classNames from 'classnames';\r\nimport {SocketHandle} from '../../sockets/SocketHandle';\r\nimport {ButtonGroup} from 'react-bootstrap';\r\nimport ShortcutButton from '../parts/ShortcutButton';\r\nimport PropField from '../parts/PropField';\r\n\r\nexport default function DefaultNodeView({block, nodeHandle}) {\r\n    const {editor, node, bindSocket, bindControl} = nodeHandle.props;\r\n    const {selected} = nodeHandle.state;\r\n\r\n    // Properties for the top left/right corners\r\n    const topLeft = block.topLeft && node.inputs.get(block.topLeft);\r\n    const topRight = block.topRight && node.outputs.get(block.topRight);\r\n\r\n    let title = getNodeLabel(node, editor, true);\r\n    if(block.computeTitle) {\r\n        title = <DynamicTitle editor={editor} node={node} block={block} fallback={title}/>;\r\n    }\r\n\r\n    const getBindControl = prop => (ref, ...args) => {\r\n        const result = bindControl(ref, ...args);\r\n        if(ref) {\r\n            // Custom hover text\r\n            ref.title = getPropLabel(prop);\r\n        }\r\n        return result;\r\n    };\r\n\r\n    const filterProp = prop => {\r\n        if(prop.hidden) {\r\n            return false;\r\n        }\r\n        return prop.control || ((!topLeft || prop.key !== block.topLeft) && (!topRight || prop.key !== block.topRight));\r\n    };\r\n\r\n    const width = 32 * (node.data['editor:width'] || block.width || 6) - 3;\r\n\r\n    return (\r\n        <div style={{width}} className={classNames('node', `node-id-${node.id}`, selected, block.className)}>\r\n            <div className=\"header d-flex\">\r\n                {topLeft && (\r\n                    <div>\r\n                        <SocketHandle\r\n                            type=\"input\"\r\n                            propKey={block.topLeft}\r\n                            socket={topLeft.socket}\r\n                            io={topLeft}\r\n                            innerRef={bindSocket}\r\n                        />\r\n                    </div>\r\n                )}\r\n                <div\r\n                    className=\"title d-inline-block flex-grow-1 text-nowrap overflow-hidden\"\r\n                    style={{color: block.category.data.color}}>\r\n                    {block.icon && (\r\n                        // TODO: globally improve react-icons render logic\r\n                        <span className=\"d-inline-block pe-1\" style={{transform: 'translateY(-.2em)'}}>\r\n                            {React.createElement(block.icon)}\r\n                        </span>\r\n                    )}\r\n                    {title}\r\n                </div>\r\n                {topRight && (\r\n                    <div>\r\n                        <SocketHandle\r\n                            type=\"output\"\r\n                            propKey={block.topRight}\r\n                            socket={topRight.socket}\r\n                            io={topRight}\r\n                            innerRef={bindSocket}\r\n                        />\r\n                    </div>\r\n                )}\r\n            </div>\r\n            {block.shortcuts.length > 0 && (\r\n                <ButtonGroup className=\"px-4 py-1 w-100\" style={{background: '#0002'}}>\r\n                    {block.shortcuts.map((shortcut, i) => (\r\n                        <ShortcutButton key={i} editor={editor} node={node} shortcut={shortcut}/>\r\n                    ))}\r\n                </ButtonGroup>\r\n            )}\r\n            {Object.values(block.props)\r\n                .filter(filterProp)\r\n                .map(prop => (\r\n                    <PropField\r\n                        key={prop.key}\r\n                        prop={prop}\r\n                        node={node}\r\n                        hideLeft={prop.key === block.topLeft}\r\n                        hideRight={prop.key === block.topRight}\r\n                        bindSocket={bindSocket}\r\n                        bindControl={getBindControl(prop)}\r\n                    />\r\n                ))}\r\n        </div>\r\n    );\r\n}\r\n","import React from 'react';\r\nimport {Node} from 'rete-react-render-plugin';\r\nimport {getBlock} from '../../../editor/blocks';\r\nimport DefaultNodeView from './views/DefaultNodeView';\r\n\r\nexport default class NodeHandle extends Node {\r\n    render() {\r\n        const {node} = this.props;\r\n\r\n        const block = getBlock(node.name);\r\n\r\n        const NodeView = block.component || DefaultNodeView;\r\n        return <NodeView block={block} nodeHandle={this}/>;\r\n    }\r\n}","import React, {useCallback, useMemo} from 'react';\r\n\r\nexport default function ContextMenu({x, y, children, style: styleProp, handleCloseMenu, ...others}) {\r\n\r\n    const style = useMemo(() => ({\r\n        position: 'absolute',\r\n        left: x,\r\n        top: y,\r\n        ...styleProp,\r\n    }), [x, y, styleProp]);\r\n\r\n    const bindScreen = useCallback(el => {\r\n        if(!el) {\r\n            return;\r\n        }\r\n        const listener = event => event.stopPropagation();\r\n        el.addEventListener('pointermove', listener);\r\n        el.addEventListener('mousemove', listener);\r\n        el.addEventListener('wheel', listener);\r\n    }, []);\r\n\r\n    const bindContainer = useCallback(el => {\r\n        if(!el) {\r\n            return;\r\n        }\r\n        const moveIntoWindow = () => {\r\n            let offset = el.getBoundingClientRect().bottom - window.innerHeight;\r\n            if(offset > 0) {\r\n                el.style.top = `${y - offset}px`;\r\n            }\r\n        };\r\n        moveIntoWindow();\r\n        el.onresize = moveIntoWindow;\r\n    }, [y]);\r\n\r\n    return (\r\n        <div\r\n            className=\"context-menu-screen\"\r\n            style={{position: 'absolute', top: 0, left: 0, bottom: 0, right: 0, pointerEvents: 'all'}}\r\n            ref={bindScreen}\r\n            onKeyDown={e => e.keyCode === 27 /* escape */ && handleCloseMenu()}\r\n            onMouseDown={() => handleCloseMenu()}\r\n            {...others}>\r\n            <div className=\"context-menu-container\" style={style} ref={bindContainer}>\r\n                <div className=\"context-menu\">\r\n                    {children}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import React from 'react';\r\n\r\nexport const MenuContext = React.createContext(null);\r\n","export default function MenuIcon({children, color}) {\r\n    return (\r\n        <span className=\"context-menu-icon\" style={{color}}>{children}</span>\r\n    );\r\n}","import classNames from 'classnames';\r\nimport MenuIcon from './MenuIcon';\r\n\r\nexport default function MenuAction({icon, color, selected, onAction, children, style, className, ...others}) {\r\n    return (\r\n        <div\r\n            className={classNames(className, 'context-menu-action', selected && 'selected')}\r\n            style={{color, userSelect: 'none', ...style}}\r\n            onMouseDown={event => event.button === 0 && onAction?.(event)} {...others}>\r\n            {icon && <MenuIcon>{icon}</MenuIcon>}\r\n            {children}\r\n        </div>\r\n    );\r\n}","export default function jsonCopy(value) {\r\n    return JSON.parse(JSON.stringify(value));\r\n}","import React, {useContext} from 'react';\r\nimport MenuAction from '../MenuAction';\r\nimport {MenuContext} from '../../contexts/MenuContext';\r\nimport jsonCopy from '../../../../utils/jsonCopy';\r\n\r\nconst cloneSelected = async (editor) => {\r\n\r\n    const newNodeMap = {};\r\n\r\n    let results = await Promise.all(editor.selected.list.map(async node => {\r\n        const component = editor.getComponent(node.name);\r\n        const newNode = await component.createNode(jsonCopy(node.data));\r\n\r\n        newNode.meta = jsonCopy(node.meta);\r\n        [newNode.position[0], newNode.position[1]] = [node.position[0] + 25, node.position[1] + 25];\r\n\r\n        editor.addNode(newNode);\r\n\r\n        newNodeMap[node.id] = newNode;\r\n\r\n        return {\r\n            original: node,\r\n            clone: newNode,\r\n        };\r\n    }));\r\n\r\n    results.forEach(({original}) => {\r\n        // original.inputs.forEach((input) => {\r\n        //     input.connections.forEach((connection) => {\r\n        //         const newInputNode = newNodeMap[connection.input.node.id];\r\n        //         const newOutputNode = newNodeMap[connection.output.node.id];\r\n        //         if(!newInputNode || !newOutputNode) {\r\n        //             return;\r\n        //         }\r\n        //         const input = newInputNode.inputs.get(connection.input.key);\r\n        //         const output = newOutputNode.outputs.get(connection.output.key);\r\n        //         if(!input || !output) {\r\n        //             return;\r\n        //         }\r\n        //         editor.connect(output, input);\r\n        //     });\r\n        // });\r\n\r\n        editor.selected.remove(original);\r\n        original.update();\r\n    });\r\n\r\n    // TODO: select after clone (capture mouse click)\r\n    // results.forEach(({clone}) => {\r\n    //     editor.selected.add(clone);\r\n    //     clone.update();\r\n    // });\r\n};\r\n\r\nexport default function SelectionMenu() {\r\n\r\n    const {editor} = useContext(MenuContext);\r\n\r\n    return (\r\n        <>\r\n            <MenuAction onAction={() => cloneSelected(editor)}>Clone</MenuAction>\r\n            <MenuAction onAction={() => editor.selected.each(node => editor.removeNode(node))}>Delete</MenuAction>\r\n        </>\r\n    );\r\n}","import React from 'react';\r\nimport MenuAction from './MenuAction';\r\nimport {FaRegStickyNote} from 'react-icons/fa';\r\nimport getBlockLabel from '../../../utils/getBlockLabel';\r\nimport useReactTooltip from '../../../hooks/useReactTooltip';\r\nimport useLearningModeState from '../../../hooks/persistent/useLearningModeState';\r\n\r\n\r\nexport default function MenuComponent({component, specialTitle, ...others}) {\r\n    const block = component.block;\r\n    const category = block?.category;\r\n    const [learningMode] = useLearningModeState();\r\n\r\n    if(block?.info) {\r\n        let tooltip = block.info;\r\n        if(learningMode && block.useCases?.length) {\r\n            tooltip += `<br>Use cases: ${block.useCases.join(', ')}`;\r\n        }\r\n        others = {\r\n            'data-tip': tooltip,\r\n            'data-place': 'right',\r\n            ...others,\r\n        };\r\n    }\r\n\r\n    useReactTooltip();\r\n\r\n    const title = getBlockLabel(block) || component.name;\r\n\r\n    return (\r\n        <MenuAction\r\n            icon={React.createElement(block?.icon || category?.data.icon || FaRegStickyNote)}\r\n            color={category?.data.color}\r\n            className={`component-${component.name}`}\r\n            {...others}>\r\n            {specialTitle !== undefined ? <>{specialTitle} <span style={{opacity: .5}}>({title})</span></> : title}\r\n        </MenuAction>\r\n    );\r\n}","import {useCallback} from 'react';\r\n\r\nexport default function MenuSearch({value, onChange, onAction, onKeyDown, children, ...others}) {\r\n\r\n    const bindInput = useCallback(el => {\r\n        if(!el) {\r\n            return;\r\n        }\r\n        el.focus();\r\n        // el.select();\r\n    }, [{}/* Force redraw in order to refocus */]); /* eslint-disable-line react-hooks/exhaustive-deps */\r\n\r\n    const handleKeyDown = (onKeyDown || onAction) && (event => {\r\n        if(onKeyDown) {\r\n            onKeyDown(event);\r\n        }\r\n        if(onAction && event.key === 'Enter') {\r\n            onAction();\r\n        }\r\n    });\r\n\r\n    return (\r\n        <div onMouseDown={event => event.stopPropagation()}>\r\n            <input\r\n                type=\"text\"\r\n                className=\"context-menu-search\"\r\n                autoFocus\r\n                ref={bindInput}\r\n                autoComplete=\"blocks-search\"\r\n                value={value || ''}\r\n                onChange={onChange && (event => onChange(event.target.value))}\r\n                onKeyDown={handleKeyDown}\r\n                {...others}/>\r\n            <div className=\"context-menu-search-area\">\r\n                {children}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import React, {useCallback, useContext, useState} from 'react';\r\nimport MenuComponent from '../MenuComponent';\r\nimport {MenuContext} from '../../contexts/MenuContext';\r\nimport MenuSearch from '../MenuSearch';\r\nimport useEditorComponents from '../../hooks/useEditorComponents';\r\n\r\nfunction deepCopy(obj) {\r\n    return JSON.parse(JSON.stringify(obj));\r\n}\r\n\r\nexport async function createNode(component, {data, meta, position: {x, y} = {}}) {\r\n    const node = await component.createNode(data ? deepCopy(data) : {});\r\n    if(meta) {\r\n        node.meta = Object.assign(deepCopy(meta), node.meta);\r\n    }\r\n    [node.position[0], node.position[1]] = [x, y];\r\n    return node;\r\n}\r\n\r\nfunction findRelevantComponents(input, output, components) {\r\n    if(!input && !output) {\r\n        return components;\r\n    }\r\n    let [inputType, outputType] = [input?.socket.findType?.(), output?.socket.findType?.()];\r\n    if(inputType?.data.reversed || outputType?.data.reversed) {\r\n        [inputType, outputType] = [outputType, inputType];\r\n    }\r\n    // Permissive for outputs but not inputs\r\n    return components.filter(c =>\r\n        (!inputType || c.block.outputs.some((prop) =>\r\n            !prop.hidden && !prop.advanced/*****/ && inputType.isSubtype(prop.type))) &&\r\n        (!outputType || c.block.inputs.some((prop) =>\r\n            !prop.hidden && !prop.advanced/*****/ && (outputType.isSubtype(prop.type) || prop.type.isSubtype(outputType)))));\r\n}\r\n\r\nexport default function PlacementMenu() {\r\n    let [searchText, setSearchText] = useState('');\r\n    let [index, setIndex] = useState(0);\r\n\r\n    const menu = useContext(MenuContext);\r\n    const {editor, mouse, context} = menu;\r\n\r\n    let components = useEditorComponents(editor, c => [-(c.block?.category.data.priority || 0), c.block?.category.root.name || '', c.data.title || c.name]);\r\n    if(context) {\r\n        components = findRelevantComponents(context.input, context.output, components);\r\n    }\r\n    else {\r\n        components = components.filter(c => c.block.global);\r\n        searchText = '';\r\n    }\r\n\r\n    const options = [];\r\n    // Add custom search results from relevant components\r\n    components.forEach(component => {\r\n        try {\r\n            const block = component.block;\r\n            if(searchText && block.customSearch) {\r\n                const custom = block.customSearch(searchText, menu);\r\n                if(custom) {\r\n                    (Array.isArray(custom) ? custom : [custom]).forEach(option => {\r\n                        option.component = component;\r\n                        options.push(option);\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        catch(e) {\r\n            console.warn(`Error while adding custom search result for ${component.name}`);\r\n            console.warn(e);\r\n        }\r\n    });\r\n\r\n    // Filter components by search text\r\n    if(searchText) {\r\n        const lower = searchText.toLowerCase();\r\n        components = components.filter(c => c.keywords?.some(k => k.toLowerCase().startsWith(lower)) || c.name.toLowerCase().startsWith(lower));\r\n    }\r\n    options.push(...components.map(component => ({component})));\r\n\r\n    index = Math.min(options.length - 1, index);\r\n\r\n    // Arrow keys pressed\r\n    const handleSearchKeyDown = (event) => {\r\n        if(event.keyCode === 38 /* Up Arrow */) {\r\n            setIndex(Math.max(0, index - 1));\r\n        }\r\n        if(event.keyCode === 40 /* Down Arrow */) {\r\n            setIndex(index + 1);\r\n        }\r\n    };\r\n\r\n    // Enter key pressed\r\n    const handleSearchAction = async () => {\r\n        if(options.length) {\r\n            await handleCreateOption(options[index]);\r\n        }\r\n    };\r\n\r\n    // Create node from component\r\n    const handleCreateOption = useCallback(async ({component, data, meta}) => {\r\n        setSearchText('');\r\n        editor.trigger('hidecontextmenu');\r\n\r\n        const position = context?.input ? {\r\n            x: mouse.x - 200, // TODO: compute width of module\r\n            y: mouse.y,\r\n        } : mouse;\r\n\r\n        const node = await createNode(component, {data, meta, position});\r\n        editor.addNode(node);\r\n\r\n        if(context) {\r\n            try {\r\n                const {input, output} = context;\r\n                if(input) {\r\n                    const output = [...node.outputs.values()].find(output => input.socket.compatibleWith(output.socket));\r\n                    if(output) {\r\n                        editor.connect(output, input);\r\n                    }\r\n                }\r\n                if(output) {\r\n                    const input = [...node.inputs.values()].find(input => input.socket.compatibleWith(output.socket));\r\n                    if(input) {\r\n                        editor.connect(output, input);\r\n                    }\r\n                }\r\n            }\r\n            catch(err) {\r\n                console.error('Unable to connect relevant input/output');\r\n                console.error(err);\r\n            }\r\n        }\r\n    }, [editor, mouse, context]);\r\n\r\n    const menuItems = options.map((option, i) => (\r\n        <MenuComponent\r\n            key={`${option.title}${option.component.name}${i}`}\r\n            component={option.component}\r\n            specialTitle={option.title}\r\n            selected={index === i}\r\n            onAction={() => handleCreateOption(option)}\r\n        />\r\n    ));\r\n\r\n    return context ? (\r\n        <MenuSearch\r\n            value={searchText}\r\n            onChange={setSearchText}\r\n            onKeyDown={handleSearchKeyDown}\r\n            onAction={handleSearchAction}>\r\n            {menuItems}\r\n        </MenuSearch>\r\n    ) : (\r\n        <>\r\n            {/* Experimental global placement header */}\r\n            <div className=\"noselect p-2 text-light\" style={{opacity: .5, background: '#FFF2'}}>Place anywhere:</div>\r\n            {menuItems}\r\n        </>\r\n    );\r\n}","import {useMemo} from 'react';\r\n\r\nexport default function useEditorComponents(editor, sortFn) {\r\n    const hash = [...editor.components].map(c => c.name).join('##');\r\n\r\n    return useMemo(() => {\r\n        return [...editor.components.values()]\r\n            .filter(c => c && 'block' in c && !c.block?.hidden && !c.block?.deprecated)// TODO: refactor?\r\n            .map(v => [sortFn(v), v])\r\n            .sort(([a], [b]) => {\r\n                if(Array.isArray(a)) {\r\n                    for(let i = 0; i < a.length; i++) {\r\n                        let compare = typeof a[i] === 'number'\r\n                            ? a[i] - b[i]\r\n                            : a[i].localeCompare(b[i]);\r\n                        if(compare !== 0) {\r\n                            return compare;\r\n                        }\r\n                    }\r\n                    return 0;\r\n                }\r\n                else {\r\n                    return a.localeCompare(b);\r\n                }\r\n            })\r\n            .map(([, v]) => v);\r\n    }, [hash]); /* eslint-disable-line react-hooks/exhaustive-deps */\r\n}","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport ContextMenu from './components/ContextMenu';\r\nimport {MenuContext} from './contexts/MenuContext';\r\nimport SelectionMenu from './components/menus/SelectionMenu';\r\nimport PlacementMenu from './components/menus/PlacementMenu';\r\nimport Rete from 'rete';\r\nimport {CONTEXT_MENU_STORE} from '../../observables/contextMenuStore';\r\n\r\n// Adapted from https://github.com/michael-braun/rete-react-contextmenu-plugin\r\n\r\nfunction install(editor, config = {}) {\r\n    editor.bind('hidecontextmenu');\r\n    editor.bind('showcontextmenu');\r\n\r\n    let [offsetX, offsetY] = config.offset ? [config.offset.x, config.offset.y] : [-10, -10];\r\n\r\n    let menu = null;\r\n\r\n    editor.on('hidecontextmenu', () => {\r\n        CONTEXT_MENU_STORE.set(null);\r\n        if(menu) {\r\n            menu.style.display = 'none';\r\n        }\r\n    });\r\n\r\n    editor.on(['click', 'contextmenu'], () => {\r\n        editor.trigger('hidecontextmenu');\r\n    });\r\n\r\n    editor.on('contextmenu', ({e, node, context}) => {\r\n        e.preventDefault?.();\r\n        // if(e.button === 2) {\r\n        //     return;///\r\n        // }\r\n        e.stopPropagation?.();\r\n\r\n        if(!context && e.ctrlKey) {\r\n            context = {};////\r\n        }\r\n\r\n        if(!editor.trigger('showcontextmenu', {e, node, context})) {\r\n            return;\r\n        }\r\n\r\n        // Select node under cursor\r\n        if(node) {\r\n            if(!editor.selected.contains(node)) {\r\n                editor.selectNode(node);\r\n            }\r\n        }\r\n        else {\r\n            // editor.selected.clear();\r\n        }\r\n\r\n        const [x, y] = [e.clientX, e.clientY];\r\n\r\n        if(!menu) {\r\n            menu = document.createElement('div');\r\n            editor.view.container.appendChild(menu);\r\n        }\r\n        const menuContext = {editor, mouse, node, context};\r\n        CONTEXT_MENU_STORE.set(menuContext);\r\n\r\n        menu.style.display = 'block';\r\n        ReactDOM.render((\r\n            <ContextMenu\r\n                x={x + offsetX}\r\n                y={node ? y - 50 : y + offsetY} // TODO: magic number\r\n                handleCloseMenu={() => editor.trigger('hidecontextmenu')}>\r\n                <MenuContext.Provider value={menuContext}>\r\n                    {node ? (\r\n                        <SelectionMenu/>\r\n                    ) : (\r\n                        <PlacementMenu/>\r\n                    )}\r\n                </MenuContext.Provider>\r\n            </ContextMenu>\r\n        ), menu);\r\n    });\r\n\r\n    editor.on('destroy', () => {\r\n        editor.trigger('hidecontextmenu');\r\n        if(menu) {\r\n            menu.remove();\r\n            menu = null;\r\n        }\r\n    });\r\n\r\n    let mouse;\r\n    let mouseEvent;\r\n    let connectionMouseMoved = false;\r\n    let removingConnection = false;\r\n\r\n    editor.view.container.addEventListener('pointermove', e => mouseEvent = e);\r\n\r\n    // // Open context menu on left click\r\n    // editor.on('click', e => {\r\n    //     editor.trigger('contextmenu', {e});\r\n    // });\r\n\r\n    editor.on('mousemove', m => {\r\n        mouse = m;\r\n        connectionMouseMoved = true;\r\n    });\r\n\r\n    editor.on('connectionpick', io => {\r\n        connectionMouseMoved = false;\r\n        let prevConnections = [...io.connections];\r\n        setTimeout(() => {\r\n            if(io.connections.length < prevConnections.length) {\r\n                // Connection is being removed\r\n                removingConnection = true;\r\n            }\r\n        });\r\n    });\r\n\r\n    editor.on('connectiondrop', io => {\r\n        if(!connectionMouseMoved) {\r\n            return;\r\n        }\r\n        if(removingConnection) {\r\n            removingConnection = false;\r\n            return;\r\n        }\r\n        let prevConnections = [...io.connections];\r\n        setTimeout(() => {\r\n            // Prevent activating if connections changed\r\n            if(io.connections.length !== prevConnections.length || io.connections.some((conn, i) =>\r\n                (conn.input !== prevConnections[i].input) || (conn.output !== prevConnections[i].output))) {\r\n                return;\r\n            }\r\n            editor.trigger('contextmenu', {\r\n                e: mouseEvent,\r\n                context: {\r\n                    input: io instanceof Rete.Input ? io : null,\r\n                    output: io instanceof Rete.Output ? io : null,\r\n                },\r\n            });\r\n        });\r\n    });\r\n}\r\n\r\nconst ContextMenuPlugin = {\r\n    name: 'blocks-contextmenu',\r\n    install,\r\n};\r\nexport default ContextMenuPlugin;\r\n","function install(editor, config = {}) {\r\n\r\n    // let currentIO = null;\r\n    //\r\n    // editor.on('connectionpick', (io) => {\r\n    //     currentIO = io;\r\n    // });\r\n    // editor.on('connectiondrop', (io) => {\r\n    //     currentIO = null;\r\n    // });\r\n\r\n    const onKeyDown = (event) => {\r\n        if(event.code === 'Escape') {\r\n            // TODO: implement drop connection without context menu\r\n\r\n            // if(currentIO) {\r\n            //     editor.trigger('connectiondrop', currentIO);\r\n            // }\r\n            // setTimeout(() => editor.trigger('hidecontextmenu'));\r\n        }\r\n    };\r\n\r\n    document.addEventListener('keydown', onKeyDown);\r\n    editor.on('destroy', () => document.removeEventListener('keydown', onKeyDown));\r\n}\r\n\r\nconst ConnectionDropPlugin = {\r\n    name: 'connection-drop',\r\n    install,\r\n};\r\nexport default ConnectionDropPlugin;","function install(editor, config = {}) {\r\n\r\n    const {minDistance = 500, opacityFalloff = 200} = config;\r\n\r\n    // Fade out distant connections\r\n    editor.on(['renderconnection', 'updateconnection', 'zoom'], () => {\r\n        setTimeout(() => {\r\n            for(let pathElement of editor.view.container.querySelectorAll('.connection .main-path')) {\r\n                let bounds = pathElement.getBoundingClientRect();\r\n                let distance = bounds.width;\r\n                pathElement.style.opacity = 1 / (1 + Math.sqrt(Math.max(distance - minDistance, 0) / opacityFalloff));\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\nconst ConnectionOpacityPlugin = {\r\n    name: 'connection-opacity',\r\n    install,\r\n};\r\nexport default ConnectionOpacityPlugin;","import Rete from 'rete';\r\n\r\nfunction sortConnections(io) {\r\n    let key = io instanceof Rete.Input ? 'output' : 'input';\r\n    io.connections.sort((a, b) => a[key].node.position[1] - b[key].node.position[1]);\r\n}\r\n\r\nfunction install(editor, config = {}) {\r\n    editor.on('connectioncreated', connection => {\r\n        sortConnections(connection.input);\r\n        sortConnections(connection.output);\r\n    });\r\n    editor.on('nodedragged', (node) => {\r\n        for(let [ioMap, key] of [[node.inputs, 'output'], [node.outputs, 'input']]) {\r\n            for(let io of ioMap.values()) {\r\n                for(let connection of io.connections) {\r\n                    sortConnections(connection[key]);\r\n                }\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nconst VerticalSortPlugin = {\r\n    name: 'vertical-sort',\r\n    install,\r\n};\r\nexport default VerticalSortPlugin;","\r\nfunction install(editor, config = {}) {\r\n\r\n    // TODO: implement properly\r\n\r\n    // if(config.editorButton !== undefined) {\r\n    //     let drag = editor.view.area._drag;\r\n    //     drag.button = config.editorButton;\r\n    // }\r\n}\r\n\r\nconst DragButtonPlugin = {\r\n    name: 'drag-button',\r\n    install,\r\n};\r\nexport default DragButtonPlugin;","import makeObservable from '../utils/makeObservable';\r\n\r\nexport const CREATE_NODE_STORE = makeObservable(null);","export class UndoRedoHistory {\r\n    constructor(maxLength, delay = 500) {\r\n        this.maxLength = maxLength;\r\n        this.delay = delay;\r\n\r\n        this.undoHistory = [];\r\n        this.redoHistory = [];\r\n\r\n        this.current = undefined;\r\n        this._timeout = undefined;\r\n    }\r\n\r\n    clear() {\r\n        this.undoHistory.length = 0;\r\n        this.redoHistory.length = 0;\r\n        this._resetCurrent();\r\n    }\r\n\r\n    _resetCurrent() {\r\n        this.current = undefined;\r\n        clearTimeout(this._timeout);\r\n        this._timeout = undefined;\r\n    }\r\n\r\n    _applyCurrent() {\r\n        this.redoHistory.length = 0;\r\n        this.undoHistory.push(this.current);\r\n        while(this.undoHistory.length > this.maxLength) {\r\n            this.undoHistory.shift();\r\n        }\r\n        // console.log('Current:', this.current);////\r\n    }\r\n\r\n    add(state) {\r\n        this.current = state;\r\n        clearTimeout(this._timeout);\r\n        this._timeout = setTimeout(() => {\r\n            this._applyCurrent();\r\n        }, this.delay);\r\n    }\r\n\r\n    undo() {\r\n        if(this.undoHistory.length) {\r\n            const state = this.undoHistory.pop();\r\n            this.redoHistory.push(state);\r\n            return state;\r\n        }\r\n    }\r\n\r\n    redo() {\r\n        if(this.redoHistory.length) {\r\n            const state = this.redoHistory.pop();\r\n            this.undoHistory.push(state);\r\n            return state;\r\n        }\r\n    }\r\n}\r\n\r\nfunction install(editor, {history} = {}) {\r\n    editor.bind('history');\r\n    editor.bind('undo');\r\n    editor.bind('redo');\r\n\r\n    if(!history || typeof history === 'number') {\r\n        history = new UndoRedoHistory(history);\r\n    }\r\n\r\n    editor.on('history', (state) => {\r\n        history.add(state);\r\n    });\r\n    editor.on('undo', () => {\r\n        // const state = history.undo();\r\n        // editor.fromJSON(state);\r\n    });\r\n    editor.on('redo', () => {\r\n        // const state = history.redo();\r\n        // editor.fromJSON(state);\r\n    });\r\n\r\n    const onKeyDown = (event) => {\r\n        const key = event.key;\r\n\r\n        if(event.ctrlKey || event.metaKey) {\r\n            if(key === 'z') {\r\n                editor.trigger(event.shiftKey ? 'redo' : 'undo');\r\n            }\r\n            if(key === 'y') {\r\n                editor.trigger('redo');\r\n            }\r\n        }\r\n    };\r\n    document.addEventListener('keydown', onKeyDown);\r\n    editor.on('destroy', () => document.removeEventListener('keydown', onKeyDown));\r\n}\r\n\r\nconst HistoryPlugin = {\r\n    name: 'history',\r\n    install,\r\n};\r\nexport default HistoryPlugin;","// noinspection JSCheckFunctionSignatures\r\n\r\nimport BlocksNodeEditor from './BlocksNodeEditor';\r\nimport ReactRenderPlugin from 'rete-react-render-plugin';\r\nimport NodeHandle from '../components/rete/nodes/NodeHandle';\r\nimport ConnectionPlugin from 'rete-connection-plugin';\r\nimport AutoArrangePlugin from 'rete-auto-arrange-plugin';\r\nimport AreaPlugin from 'rete-area-plugin';\r\nimport ContextMenuPlugin from '../plugins/rete-blocks-contextmenu-plugin';\r\nimport ConnectionDropPlugin from '../plugins/rete-connection-drop-plugin';\r\nimport ConnectionOpacityPlugin from '../plugins/rete-connection-opacity-plugin';\r\nimport VerticalSortPlugin from '../plugins/rete-vertical-sort-plugin';\r\nimport DragButtonPlugin from '../plugins/rete-drag-button-plugin';\r\nimport {CREATE_NODE_STORE} from '../observables/createNodeStore';\r\nimport HistoryPlugin from '../plugins/rete-blocks-history-plugin';\r\nimport {EDITOR_SELECTION_STORE} from '../observables/editorSelectionStore';\r\n\r\n\r\nconst editorName = process.env.REACT_APP_EDITOR_NAME;\r\nconst editorVersion = process.env.REACT_APP_EDITOR_VERSION;\r\n\r\nfunction findCategory(socket) {\r\n    return socket.type?./*findType?.()*/data.category ?? socket.data.category ?? 'none';\r\n}\r\n\r\nexport default function createEditor(element, {history} = {}) {\r\n\r\n    const editor = new BlocksNodeEditor(editorName + '@' + editorVersion, element);\r\n    editor.use(ReactRenderPlugin, {\r\n        component: NodeHandle,\r\n    });\r\n    editor.use(HistoryPlugin, {history});\r\n    editor.use(ConnectionPlugin);\r\n    // editor.use(SelectionPlugin, {\r\n    //     enabled: true,\r\n    // });\r\n    editor.use(AutoArrangePlugin);\r\n    editor.use(AreaPlugin, {\r\n        background: (() => {\r\n            const background = document.createElement('div');\r\n            background.classList.add('grid');\r\n            background.style.pointerEvents = 'none';\r\n            if(!window.chrome) {\r\n                editor.on('zoom', ({zoom}) => {\r\n                    // Fix flickering grid on non-Chrome browsers\r\n                    background.classList.toggle('far', zoom <= 1);\r\n                    background.classList.toggle('d-none', zoom <= .5);\r\n                });\r\n            }\r\n            editor.on('destroy', () => background.remove());\r\n            return background;\r\n        })(),\r\n        snap: {size: 16, dynamic: true},\r\n    });\r\n    editor.use(ContextMenuPlugin);\r\n    editor.use(ConnectionDropPlugin);\r\n    editor.use(ConnectionOpacityPlugin);\r\n    editor.use(VerticalSortPlugin);\r\n    editor.use(DragButtonPlugin, {editorButton: 2});\r\n\r\n    // Notify selection changed\r\n    const updateSelection = () => setTimeout(() => {\r\n        const previous = EDITOR_SELECTION_STORE.get();\r\n        const current = editor.selected.list;\r\n        if(previous.length !== current.length || previous.some((x, i) => x !== current[i])) {\r\n            EDITOR_SELECTION_STORE.set([...current]);\r\n        }\r\n    });\r\n\r\n    let mouseMoved = false;\r\n    editor.view.container.addEventListener('mousedown', (e) => {\r\n        mouseMoved = false;\r\n    });\r\n    editor.on('mousemove', (e) => {\r\n        mouseMoved = true;\r\n    });\r\n    editor.on('click', ({e}) => {\r\n        // Deselect nodes when clicking background\r\n        if(!mouseMoved) {\r\n            editor.selected.clear();\r\n            editor.nodes.forEach(node => node.update());\r\n        }\r\n        updateSelection();\r\n    });\r\n\r\n    editor.on('zoom', ({source}) => source !== 'dblclick'); // Prevent double-click zoom\r\n    editor.on('nodeselect', node => !editor.selected.contains(node)); // Allow dragging multiple nodes\r\n    editor.on('nodeselected', () => updateSelection());\r\n    editor.on('renderconnection', ({el, connection}) => {\r\n        const category = findCategory((connection.input.socket.data.reversed ? connection.input : connection.output).socket);\r\n        el.querySelector('.connection').classList.add(\r\n            `socket-output-category-${category}`,\r\n        );\r\n    });\r\n\r\n    editor.on('nodecreated', node => {\r\n        CREATE_NODE_STORE.set(node);\r\n    });\r\n\r\n    return editor;\r\n}","import React, {useContext} from 'react';\r\nimport AreaPlugin from 'rete-area-plugin';\r\nimport EventsContext, {EDITOR_CHANGE_EVENT, EDITOR_SAVE_EVENT, ERROR_EVENT} from '../../contexts/EventsContext';\r\nimport BlockComponent from '../../editor/components/BlockComponent';\r\nimport {BLOCK_MAP} from '../../editor/blocks';\r\nimport useListener from '../../hooks/utils/useListener';\r\nimport {SHORTCUT_KEYS} from '../../editor/shortcutKeys';\r\nimport ConnectionAwareListContext from '../../contexts/ConnectionAwareListContext';\r\nimport useAutosaveState from '../../hooks/persistent/useAutosaveState';\r\nimport createEditor from '../../editor/createEditor';\r\nimport ReactTooltip from 'react-tooltip';\r\n\r\nconst inputTags = ['input', 'textarea'];\r\n\r\n\r\nexport default function EditorWrapper({observable, onSetup, onChange, onSave, history}) {\r\n    const [autosave] = useAutosaveState();\r\n\r\n    const events = useContext(EventsContext);\r\n    const connectionAwareList = useContext(ConnectionAwareListContext);\r\n\r\n    let editor;\r\n\r\n    useListener(events, EDITOR_CHANGE_EVENT, (_editor) => {\r\n        if(_editor === editor) {\r\n            onChange?.(editor);\r\n            if(autosave) {\r\n                events.emit(EDITOR_SAVE_EVENT, editor);\r\n            }\r\n        }\r\n    });\r\n    useListener(events, EDITOR_SAVE_EVENT, (_editor) => {\r\n        if(_editor === editor) {\r\n            onSave?.(editor.toJSON(), editor);\r\n        }\r\n    });\r\n\r\n    const bindElement = (container) => {\r\n        if(editor) {\r\n            editor.silent = true;\r\n            editor.clear();\r\n            editor.components.clear();\r\n            editor.destroy();\r\n            editor = null;\r\n        }\r\n        if(!container) {\r\n            return;\r\n        }\r\n\r\n        editor = createEditor(container, {\r\n            history,\r\n        });\r\n\r\n        window.EDITOR = editor; // Browser debugging\r\n\r\n        const onKeyDown = (event) => {\r\n            const key = event.key;\r\n\r\n            if(event.ctrlKey || event.metaKey) {\r\n                // if(key === 'q') {\r\n                //     editor.trigger('arrange');\r\n                // }\r\n                if(key === 's') {\r\n                    event.preventDefault();\r\n                    events.emit(EDITOR_SAVE_EVENT, editor);\r\n                    console.log('Saved successfully');\r\n                }\r\n                if(key === 'z') {\r\n                    editor.trigger(event.shiftKey ? 'redo' : 'undo');\r\n                }\r\n                if(key === 'y') {\r\n                    editor.trigger('redo');\r\n                }\r\n            }\r\n            else if(!document.activeElement || !inputTags.includes(document.activeElement.nodeName.toLowerCase())) {\r\n                if(key === 'Delete') {\r\n                    editor.selected.each(n => editor.removeNode(n));\r\n                    ReactTooltip.hide();\r\n                }\r\n                else {\r\n                    const block = SHORTCUT_KEYS.get(key);\r\n                    if(block) {\r\n                        editor.createNodeAtCursor(editor.getComponent(block.name))\r\n                            .catch(err => events.emit('error', err));\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        document.addEventListener('keydown', onKeyDown);\r\n        editor.on('destroy', () => document.removeEventListener('keydown', onKeyDown));\r\n\r\n        for(const block of BLOCK_MAP.values()) {\r\n            const node = new BlockComponent(block);\r\n            editor.register(node);\r\n        }\r\n\r\n        let timeout;\r\n        editor.on(['nodecreated', 'noderemoved', 'nodedragged', 'connectioncreated', 'connectionremoved'], async () => {\r\n            if(!editor.silent) {\r\n                // Debounce change events\r\n                clearTimeout(timeout);\r\n                timeout = setTimeout(() => {\r\n                    events.emit(EDITOR_CHANGE_EVENT, editor);\r\n                });\r\n            }\r\n        });\r\n        editor.on('error', err => events.emit(ERROR_EVENT, err));\r\n\r\n        async function loadState(state) {\r\n            if(!state) {\r\n                return false;\r\n            }\r\n            const result = await editor.fromJSON(state);\r\n            if(result) {\r\n                editor.view.resize();\r\n                AreaPlugin.zoomAt(editor);\r\n                events.emit(EDITOR_CHANGE_EVENT, editor);\r\n                editor.nodes.forEach(node => node.update()); // Redraw nodes\r\n            }\r\n            return result;\r\n        }\r\n\r\n        // TODO: dry with rete-blocks-contextmenu-plugin\r\n        const handleConnectionEnd = (startIO, endIO) => {\r\n            currentIO = null;\r\n            for(const listener of connectionAwareList) {\r\n                listener(false, startIO, endIO);\r\n            }\r\n        };\r\n        let currentIO = null;\r\n        let connectionMouseMoved = false;\r\n        editor.on('mousemove', () => {\r\n            connectionMouseMoved = true;\r\n        });\r\n        editor.on('connectionpick', io => {\r\n            // noinspection JSUnresolvedVariable\r\n            if(window.event.button !== 0) {\r\n                return; // Rete.js hotfix\r\n            }\r\n\r\n            // Remove connection on ctrl+click\r\n            const connection = io.connections[0];\r\n            // noinspection JSDeprecatedSymbols, JSUnresolvedVariable\r\n            if(window.event.ctrlKey) {\r\n                if(connection) {\r\n                    editor.removeConnection(connection);\r\n                }\r\n                return false;\r\n            }\r\n\r\n            connectionMouseMoved = false;\r\n            if(currentIO) {\r\n                handleConnectionEnd(currentIO, io);\r\n                return;\r\n            }\r\n            const prevConnections = [...io.connections];\r\n            setTimeout(() => {\r\n                if(io.connections.length < prevConnections.length) {\r\n                    // Connection is being removed\r\n                    const connection = prevConnections.find(c => !io.connections.includes(c));\r\n                    currentIO = (io === connection.input ? connection.output : connection.input);\r\n                }\r\n                else {\r\n                    currentIO = io;\r\n                }\r\n                for(const listener of connectionAwareList) {\r\n                    listener(true, currentIO);\r\n                }\r\n            });\r\n        });\r\n        editor.on('connectiondrop', io => {\r\n            if(!connectionMouseMoved) {\r\n                return;\r\n            }\r\n            const prevConnections = [...io.connections];\r\n            setTimeout(() => {\r\n                // Prevent activating if connections changed\r\n                if(io.connections.length !== prevConnections.length || io.connections.some((conn, i) =>\r\n                    (conn.input !== prevConnections[i].input) || (conn.output !== prevConnections[i].output))) {\r\n                    return;\r\n                }\r\n                handleConnectionEnd(io);\r\n            });\r\n        });\r\n        editor.on(['nodecreated', 'noderemoved', 'connectionremoved'], () => {\r\n            handleConnectionEnd();\r\n        });\r\n\r\n        // const onMouseUp = event => {\r\n        //     if(currentIO) {\r\n        //         handleConnectionEnd(currentIO);\r\n        //     }\r\n        // };\r\n        // document.addEventListener('mouseup', onMouseUp);\r\n        // editor.on('destroy', () => document.removeEventListener('mouseup', onMouseUp));\r\n\r\n        setTimeout(() => (async () => {\r\n            await onSetup?.(loadState, editor);\r\n            observable.set(editor);\r\n        })().catch(err => events.emit(ERROR_EVENT, err)));\r\n    };\r\n\r\n    // // Workaround for initialization order\r\n    // useTimeout(() => {\r\n    //   EDITOR_STORE.set(editor)\r\n    // });\r\n\r\n    return (\r\n        <div className=\"h-100\" ref={bindElement}/>\r\n    );\r\n}","import React, {useContext} from 'react';\r\nimport EventsContext, {ERROR_EVENT, PROJECT_LOAD_EVENT} from '../../contexts/EventsContext';\r\nimport classNames from 'classnames';\r\nimport styled from 'styled-components';\r\nimport EditorMenu from './EditorMenu';\r\nimport FileDropZone from '../common/FileDropZone';\r\nimport OutputPanel from './OutputPanel';\r\nimport EditorWrapper from '../rete/EditorWrapper';\r\nimport useObservableState from '../../hooks/utils/useObservableState';\r\nimport LoadBlocksFileContext from '../../contexts/LoadFileContext';\r\n\r\nexport const DROP_ZONE_EXTENSIONS = ['.blocks', '.blocks.json'];\r\n\r\nconst EditorContainer = styled.div`\r\n    width: 100%;\r\n    height: 100vh;\r\n`;\r\n\r\nfunction EditorControls({observable, hideMenu}) {\r\n    const [editor] = useObservableState(observable);\r\n\r\n    if(!editor) {\r\n        return null;\r\n    }\r\n    return (\r\n        <>\r\n            {!hideMenu && (\r\n                <EditorMenu editor={editor}/>\r\n            )}\r\n            <OutputPanel editor={editor}/>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default function Editor({observable, hideMenu, onSetup, onChange, onSave, history, className, ...others}) {\r\n\r\n    const events = useContext(EventsContext);\r\n\r\n    const loadBlocksFile = content => {\r\n        try {\r\n            const project = JSON.parse(content);\r\n            events.emit(PROJECT_LOAD_EVENT, project);\r\n        }\r\n        catch(err) {\r\n            events.emit(ERROR_EVENT, err);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <LoadBlocksFileContext.Provider value={loadBlocksFile}>\r\n            <FileDropZone\r\n                options={{noClick: true, accept: DROP_ZONE_EXTENSIONS.join(',')}}\r\n                onFileContent={loadBlocksFile}>\r\n                <EditorContainer\r\n                    className={classNames('node-editor d-flex flex-grow-1 flex-column', className)}\r\n                    {...others}>\r\n                    <EditorControls observable={observable} hideMenu={hideMenu}/>\r\n                    <EditorWrapper\r\n                        observable={observable}\r\n                        onSetup={onSetup}\r\n                        onChange={onChange}\r\n                        onSave={onSave}\r\n                        history={history}\r\n                    />\r\n                </EditorContainer>\r\n            </FileDropZone>\r\n        </LoadBlocksFileContext.Provider>\r\n    );\r\n}\r\n","import Editor from './Editor';\r\nimport React, {useCallback, useContext} from 'react';\r\nimport useListener from '../../hooks/utils/useListener';\r\nimport EventsContext, {\r\n    PROJECT_CLEAR_EVENT,\r\n    PROJECT_EXPORT_EVENT,\r\n    PROJECT_LOAD_EVENT,\r\n} from '../../contexts/EventsContext';\r\nimport FileSaver from 'file-saver';\r\nimport {pascalCase} from 'change-case';\r\nimport useRedraw from '../../hooks/utils/useRedraw';\r\nimport isEmbedded from '../../utils/isEmbedded';\r\nimport {EDITOR_STORE} from '../../observables/editorStore';\r\nimport {EDITOR_STATE_STORE} from '../../observables/editorStateStore';\r\nimport {UndoRedoHistory} from '../../plugins/rete-blocks-history-plugin';\r\nimport getEmbedConfig from '../../utils/getEmbedConfig';\r\n\r\nconst STORAGE_EDITOR_STATE = 'blocks.editorState';\r\n\r\nconst DEFAULT_STATE = require('../../examples/files/DefaultProject.json');\r\n\r\nconst embedded = isEmbedded();\r\nconst storage = embedded ? {} : localStorage; // TODO: convert to `useLocalStorage()`\r\n\r\nif(embedded) {\r\n    console.log('Blocks: using embedded mode.');\r\n}\r\n\r\nconst history = new UndoRedoHistory(50);\r\n\r\nlet nextEditorState;\r\n\r\nexport default function EditorPage() {\r\n    const redraw = useRedraw();\r\n\r\n    const menuParam = getEmbedConfig('menu');\r\n\r\n    const events = useContext(EventsContext);\r\n\r\n    useListener(events, PROJECT_CLEAR_EVENT, () => {\r\n        // TODO: confirmation modal\r\n        // delete storage[STORAGE_EDITOR_STATE];\r\n        nextEditorState = DEFAULT_STATE;\r\n        redraw();\r\n    });\r\n\r\n    useListener(events, PROJECT_LOAD_EVENT, state => {\r\n        // storage[STORAGE_EDITOR_STATE] = JSON.stringify(state);\r\n        nextEditorState = state;///\r\n        redraw();\r\n    });\r\n\r\n    useListener(events, PROJECT_EXPORT_EVENT, state => {\r\n        const data = JSON.stringify(state);\r\n        FileSaver.saveAs(new Blob([data]), `${pascalCase(state.name || 'project')}.blocks`);\r\n    });\r\n\r\n    useListener(window, 'message', ({source, data}) => {\r\n        if(embedded && source === window.parent) {\r\n            if(typeof data === 'string' && data.startsWith('{')) {\r\n                console.log('Received message:', data);\r\n                data = JSON.parse(data);\r\n                if(data?.type === 'load') {\r\n                    nextEditorState = data.state ? JSON.parse(JSON.stringify(data.state)) : DEFAULT_STATE;\r\n                    redraw();\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    const sendMessage = (message) => {\r\n        if(embedded) {\r\n            console.log('Sending message:', message);\r\n            const targetOrigin = '*'; // TODO: restrict target origin\r\n            window.parent.postMessage(message, targetOrigin);\r\n        }\r\n    };\r\n\r\n    const onEditorSetup = useCallback(async (loadState, editor) => {\r\n        const stateString = nextEditorState ? JSON.stringify(nextEditorState) : storage[STORAGE_EDITOR_STATE];\r\n        nextEditorState = null;\r\n\r\n        let state;\r\n        if(stateString) {\r\n            state = JSON.parse(stateString);\r\n        }\r\n        else if(!embedded) {\r\n            state = DEFAULT_STATE;\r\n        }\r\n\r\n        if(state && !await loadState(state)) {\r\n            console.warn('Load error');\r\n        }\r\n    }, []);\r\n\r\n    // let previousState = {};\r\n    const onEditorChange = useCallback((editor) => {\r\n        const state = editor.toJSON();\r\n        // const patch = compare(previousState, state);\r\n        // previousState = state;\r\n        // console.log('Patch:', patch);///\r\n\r\n        editor.trigger('history', state);\r\n\r\n        EDITOR_STATE_STORE.set(state);\r\n        // UNSAVED_CHANGES_STORE.set(true);\r\n    }, []);\r\n\r\n    const onEditorSave = useCallback((state, editor) => {\r\n        // console.log('Saving:', state);\r\n        const stateString = JSON.stringify(state);\r\n        storage[STORAGE_EDITOR_STATE] = stateString;\r\n        sendMessage({\r\n            type: 'save',\r\n            state: stateString,\r\n        });\r\n        // UNSAVED_CHANGES_STORE.set(false);\r\n    }, []);\r\n\r\n    return (\r\n        <Editor\r\n            observable={EDITOR_STORE}\r\n            hideMenu={menuParam === 'hidden'}\r\n            onSetup={onEditorSetup}\r\n            onChange={onEditorChange}\r\n            onSave={onEditorSave}\r\n            history={history}\r\n        />\r\n    );\r\n}\r\n","import {useState} from 'react';\r\n\r\nexport default function useRedraw() {\r\n    const redraw = useState({})[1];\r\n    return () => redraw({});\r\n}\r\n","import React from 'react';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport EditorPage from './editor/EditorPage';\r\n// import {Layout, Model} from 'flexlayout-react';\r\n// import 'flexlayout-react/style/dark.scss';\r\n\r\n// const editorLayoutStorageKey = 'blocks.editorLayout';\r\n\r\n// const defaultConfig = {\r\n//     global: {},\r\n//     borders: [],\r\n//     layout: {\r\n//         type: 'row',\r\n//         weight: 100,\r\n//         children: [{\r\n//             type: 'tabset',\r\n//             weight: 50,\r\n//             children: [{\r\n//                 type: 'tab',\r\n//                 name: 'Editor',\r\n//                 component: 'editor',\r\n//                 config: {},\r\n//             }],\r\n//         }],\r\n//     },\r\n// };\r\n\r\n// TODO: rewrite for a different layout library\r\n\r\nexport default function TabLayout() {\r\n    // const model = Model.fromJson(defaultConfig);\r\n    //\r\n    // const factory = node => {\r\n    //     const component = node.getComponent();\r\n    //     const props = node.getConfig() || {};\r\n    //     if(component === 'editor') {\r\n    //         return <EditorPage {...props}/>;\r\n    //     }\r\n    // };\r\n    //\r\n    // return (\r\n    //     <Layout model={model} factory={factory}/>\r\n    // );\r\n\r\n    return (\r\n        <EditorPage/>\r\n    );\r\n}\r\n","import useThemeState from '../../hooks/persistent/useThemeState';\r\nimport {useEffect} from 'react';\r\nimport {ThemeProvider} from 'styled-components';\r\nimport useThemePartsState from '../../hooks/persistent/useThemePartsState';\r\n\r\nexport default function GlobalTheme({children}) {\r\n\r\n    const [theme] = useThemeState();\r\n    const [themeParts] = useThemePartsState();\r\n\r\n    const classNames = [`theme-${theme.id}`, ...theme.parts\r\n        .filter(part => themeParts[part])\r\n        .map(part => `theme-part-${part}`)];\r\n\r\n    useEffect(() => {\r\n        document.body.classList.add(...classNames);\r\n        return () => document.body.classList.remove(...classNames);\r\n    });\r\n\r\n    return (\r\n        <ThemeProvider theme={theme.styledComponents}>\r\n            {children}\r\n        </ThemeProvider>\r\n    );\r\n}","import makeObservable from '../utils/makeObservable';\r\n\r\nexport const KEY_DOWN_STORE = makeObservable(null);","import makeObservable from '../utils/makeObservable';\r\n\r\nexport const KEY_UP_STORE = makeObservable(null);","import useListener from '../../hooks/utils/useListener';\r\nimport {KEY_DOWN_STORE} from '../../observables/keyDownStore';\r\nimport {KEY_UP_STORE} from '../../observables/keyUpStore';\r\n\r\n// Misc. global observable state manager\r\n\r\nexport default function GlobalObservables() {\r\n\r\n    useListener(document, 'keydown', event => {\r\n        KEY_DOWN_STORE.set(event.key);\r\n    });\r\n    useListener(document, 'keyup', event => {\r\n        KEY_UP_STORE.set(event.key);\r\n    });\r\n\r\n    return null;\r\n}","import React from 'react';\r\nimport styled from 'styled-components';\r\n\r\nconst MobilePanel = styled.div`\r\n    width: 100%;\r\n    height: 90vh;\r\n`;\r\n\r\nexport default function MobilePage() {\r\n    return (\r\n        <MobilePanel className=\"d-flex flex-column align-items-center justify-content-center\">\r\n            <span className=\"display-3 pb-5\">Hey there!</span>\r\n            <span className=\"text-muted px-5\">\r\n                If you are interested in using Blocks on a mobile device,\r\n                please check out <a className=\"text-nowrap\" href=\"https://github.com/Blocks-Editor/blocks/issues/78\">this GitHub discussion</a>.\r\n            </span>\r\n        </MobilePanel>\r\n    );\r\n}","import React, {useContext} from 'react';\r\nimport {toast, ToastContainer} from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport EventsContext, {ERROR_EVENT} from '../contexts/EventsContext';\r\nimport useListener from '../hooks/utils/useListener';\r\nimport GlobalTooltip from './global/GlobalTooltip';\r\nimport {BrowserRouter} from 'react-router-dom';\r\nimport TabLayout from './TabLayout';\r\nimport GlobalTheme from './global/GlobalTheme';\r\nimport GlobalObservables from './global/GlobalObservables';\r\nimport MobilePage from './MobilePage';\r\n\r\nexport default function App() {\r\n    const events = useContext(EventsContext);\r\n\r\n    useListener(events, ERROR_EVENT, err => {\r\n        toast(err, {\r\n            type: 'error',\r\n            // closeOnClick: true,\r\n        });\r\n    });\r\n\r\n    return (\r\n        <React.StrictMode>\r\n            <GlobalObservables/>\r\n            <GlobalTooltip/>\r\n            <BrowserRouter>\r\n                <GlobalTheme>\r\n                    <ToastContainer style={{marginTop: '5rem'}}/>\r\n                    <div className=\"d-block d-sm-none w-100 h-100\">\r\n                        <MobilePage/>\r\n                    </div>\r\n                    <div className=\"d-none d-sm-block w-100 h-100\">\r\n                        <TabLayout/>\r\n                    </div>\r\n                    {/*<Switch>*/}\r\n                    {/*    <Route path=\"/editor\">*/}\r\n                    {/*        <EditorPage/>*/}\r\n                    {/*    </Route>*/}\r\n                    {/*    <Route path=\"/\">*/}\r\n                    {/*        <HomePage/>*/}\r\n                    {/*    </Route>*/}\r\n                    {/*</Switch>*/}\r\n                </GlobalTheme>\r\n            </BrowserRouter>\r\n        </React.StrictMode>\r\n    );\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './style/index.scss';\r\nimport App from './components/App';\r\n\r\nReactDOM.render(\r\n    <React.StrictMode>\r\n        <App/>\r\n    </React.StrictMode>,\r\n    document.getElementById('root'),\r\n);\r\n\r\n// reportWebVitals((...args) => {\r\n//     console.log('WebVitals:', ...args);\r\n// });\r\n","import React from 'react';\r\nimport TextareaAutosize from 'react-textarea-autosize';\r\nimport styled from 'styled-components';\r\nimport {bindNodeInput} from '../../../../utils/bindNodeInput';\r\nimport useControlValue from '../../../../hooks/utils/useControlValue';\r\n\r\nconst Container = styled.div`\r\n    cursor: pointer;\r\n    color: black;\r\n    background: ${({selected}) => selected ? '#fffa' : '#fff8'};\r\n`;\r\n\r\nconst StyledTextArea = styled(TextareaAutosize)`\r\n    font-weight: 500;\r\n    resize: horizontal;\r\n    background: #fff8;\r\n`;\r\n\r\nexport default function CommentNodeView({block, nodeHandle}) {\r\n    const {/*editor,*/ node/*, bindControl*/} = nodeHandle.props;\r\n    const {selected} = nodeHandle.state;\r\n\r\n    let textArea;\r\n\r\n    const [text, setText] = useControlValue(node.controls.get('text'));\r\n    const [width, setWidth] = useControlValue(node.controls.get('widthPixels'));\r\n\r\n    return (\r\n        <Container\r\n            className=\"pt-2 ps-2 pe-4 rounded-3\"\r\n            selected={selected}\r\n            onMouseUp={() => textArea && setWidth(textArea.offsetWidth)}>\r\n            <StyledTextArea\r\n                style={{width: width || 300}}\r\n                rows={1}\r\n                maxRows={100}\r\n                ref={el => bindNodeInput(el) & (textArea = el)}\r\n                value={text || ''}\r\n                placeholder=\"Comment\"\r\n                onChange={e => setText(e.target.value)}\r\n            />\r\n        </Container>\r\n    );\r\n}\r\n","import {floatType, textType} from '../block-types/types';\r\nimport {commentCategory} from '../block-categories/categories';\r\nimport CommentNodeView from '../components/rete/nodes/views/CommentNodeView';\r\nimport {FOR_DOCUMENTATION} from '../editor/useCases';\r\n\r\nconst block = {\r\n    info: 'A text comment',\r\n    useCases: [FOR_DOCUMENTATION],\r\n    category: commentCategory,\r\n    global: true,\r\n    component: CommentNodeView,\r\n    controls: [{\r\n        key: 'text',\r\n        type: textType,\r\n    }, {\r\n        key: 'widthPixels',\r\n        type: floatType,\r\n    }],\r\n};\r\nexport default block;","import React from 'react';\r\nimport styled from 'styled-components';\r\nimport useControlValue from '../../../../hooks/utils/useControlValue';\r\nimport {bindNodeInput} from '../../../../utils/bindNodeInput';\r\n\r\nconst Container = styled.div`\r\n  cursor: pointer;\r\n    // background: ${({selected}) => selected ? '#fff8' : '#fff3'};\r\n  border: 2px solid ${({selected}) => selected ? '#fffa' : '#fff8'};\r\n`;\r\n\r\nconst ResizeArea = styled.div`\r\n  pointer-events: none;\r\n  //cursor: default;\r\n  background: #fff1;\r\n  resize: both;\r\n  overflow: hidden;\r\n`;\r\n\r\nexport default function RegionNodeView({block, nodeHandle}) {\r\n    const {/*editor,*/ node/*, bindControl*/} = nodeHandle.props;\r\n    const {selected} = nodeHandle.state;\r\n\r\n    const [width, setWidth] = useControlValue(node.controls.get('widthPixels'));\r\n    const [height, setHeight] = useControlValue(node.controls.get('heightPixels'));\r\n\r\n    const bindContainer = (el) => {\r\n        if(!el) {\r\n            return;\r\n        }\r\n        // Render behind other nodes\r\n        el.parentElement.style.zIndex = '-1';\r\n    };\r\n\r\n    return (\r\n        <Container ref={bindContainer} className=\"p-2 rounded-3\" selected={selected}>\r\n            <ResizeArea\r\n                ref={bindNodeInput}\r\n                style={{width: width || 300, height: height || 100}}\r\n                onMouseUp={event => setWidth(event.target.clientWidth) & setHeight(event.target.clientHeight)}\r\n            />\r\n        </Container>\r\n    );\r\n}\r\n","import {floatType, textType} from '../block-types/types';\r\nimport {commentCategory} from '../block-categories/categories';\r\nimport CommentRegionNodeView from '../components/rete/nodes/views/RegionNodeView';\r\nimport {FaSquareFull} from 'react-icons/fa';\r\nimport {FOR_ORGANIZATION} from '../editor/useCases';\r\n\r\nconst block = {\r\n    title: 'Region',\r\n    info: 'A background region',\r\n    useCases: [FOR_ORGANIZATION],\r\n    category: commentCategory,\r\n    icon: FaSquareFull,\r\n    global: true,\r\n    component: CommentRegionNodeView,\r\n    controls: [{\r\n        key: 'text',\r\n        type: textType,\r\n    }, {\r\n        key: 'widthPixels',\r\n        type: floatType,\r\n    }, {\r\n        key: 'heightPixels',\r\n        type: floatType,\r\n    }],\r\n};\r\nexport default block;\r\n"],"sourceRoot":""}