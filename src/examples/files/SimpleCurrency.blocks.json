{"name":"Simple Currency","description":"Mint and transfer fungible tokens.","version":"blocks-webapp@0.1.0","language":"motoko","output":"import HashMap \"mo:base/HashMap\";\nimport Principal \"mo:base/Principal\";\nimport Option \"mo:base/Option\";\n\nactor class SimpleCurrency(mintSupply : Nat, mintAddress : Principal) {\n\tlet balanceMap : HashMap.HashMap<Principal, Nat> = HashMap.HashMap<Principal, Nat>(0, Principal.equal, Principal.hash);\n\tbalanceMap.put(mintAddress, mintSupply);\n\t\n\tpublic query func getBalance(user : Principal) : async Nat {\n\t\treturn Option.get(balanceMap.get(user), 0);\n\t};\n\t\n\tpublic shared (send__install) func send(amount : Nat, receiver : Principal) : async Bool {\n\t\tvar callerBalance = (await getBalance(send__install.caller));\n\t\tif (callerBalance < amount) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\tbalanceMap.put(send__install.caller, (callerBalance - amount));\n\t\t\tbalanceMap.put(receiver, (amount + (await getBalance(receiver))));\n\t\t\treturn true;\n\t\t};\n\t};\n}","nodes":{"740":{"id":740,"data":{"visibility":"public","name":"getBalance","editor:advanced":false,"query":true},"inputs":{"name":{"connections":[]},"member":{"connections":[]}},"outputs":{"params":{"connections":[{"node":1032,"input":"param","data":{}}]},"body":{"connections":[{"node":1025,"input":"statement","data":{}}]},"caller":{"connections":[]},"function":{"connections":[]}},"position":[-32,-96],"name":"Function"},"1025":{"id":1025,"data":{},"inputs":{"value":{"connections":[{"node":1180,"output":"value","data":{}}]},"statement":{"connections":[{"node":740,"output":"body","data":{}}]}},"outputs":{},"position":[896,-96],"name":"Return"},"1030":{"id":1030,"data":{"name":"balanceMap","editor:advanced":true,"readonly":true,"stable":false},"inputs":{"name":{"connections":[]},"initialValue":{"connections":[{"node":1031,"output":"value","data":{}}]},"member":{"connections":[]}},"outputs":{"setup":{"connections":[{"node":1558,"input":"before","data":{}}]},"value":{"connections":[{"node":1558,"input":"map","data":{}}]}},"position":[576,-672],"name":"State"},"1031":{"id":1031,"data":{"keyType":{"name":"Principal","generics":[]},"valueType":{"name":"Nat","generics":[]}},"inputs":{"keyType":{"connections":[]},"valueType":{"connections":[]}},"outputs":{"value":{"connections":[{"node":1030,"input":"initialValue","data":{}}]}},"position":[352,-672],"name":"NewHashMap"},"1032":{"id":1032,"data":{"name":"user","type":{"name":"Principal","generics":[]}},"inputs":{"name":{"connections":[]},"type":{"connections":[]},"param":{"connections":[{"node":740,"output":"params","data":{}}]}},"outputs":{"value":{"connections":[{"node":1033,"input":"key","data":{}}]}},"position":[224,64],"name":"Parameter"},"1033":{"id":1033,"data":{},"inputs":{"map":{"connections":[{"node":1182,"output":"value","data":{}}]},"key":{"connections":[{"node":1032,"output":"value","data":{}}]}},"outputs":{"value":{"connections":[{"node":1180,"input":"input","data":{}}]}},"position":[448,-32],"name":"MapGet"},"1034":{"id":1034,"data":{"name":"send","editor:advanced":true},"inputs":{"name":{"connections":[]},"member":{"connections":[]}},"outputs":{"params":{"connections":[{"node":1035,"input":"param","data":{}},{"node":1345,"input":"param","data":{}}]},"body":{"connections":[{"node":1215,"input":"before","data":{}}]},"caller":{"connections":[{"node":1217,"input":"args","data":{}},{"node":1310,"input":"key","data":{}}]},"function":{"connections":[]}},"position":[-32,352],"name":"Function"},"1035":{"id":1035,"data":{"name":"amount","type":{"name":"Nat","generics":[]}},"inputs":{"name":{"connections":[]},"type":{"connections":[]},"param":{"connections":[{"node":1034,"output":"params","data":{}}]}},"outputs":{"value":{"connections":[{"node":1346,"input":"right","data":{}},{"node":1333,"input":"right","data":{}},{"node":1337,"input":"left","data":{}}]}},"position":[224,608],"name":"Parameter"},"1180":{"id":1180,"data":{},"inputs":{"input":{"connections":[{"node":1033,"output":"value","data":{}}]},"defaultValue":{"connections":[{"node":1181,"output":"value","data":{}}]}},"outputs":{"value":{"connections":[{"node":1025,"input":"value","data":{}}]}},"position":[672,-32],"name":"OptionalOrDefault"},"1181":{"id":1181,"data":{"value":0},"inputs":{},"outputs":{"value":{"connections":[{"node":1180,"input":"defaultValue","data":{}}]}},"position":[448,96],"name":"LiteralNat"},"1182":{"id":1182,"data":{"stateNode":1030},"inputs":{},"outputs":{"value":{"connections":[{"node":1033,"input":"map","data":{}}]}},"position":[224,-32],"name":"StateRead"},"1184":{"id":1184,"data":{"name":"mintSupply","type":{"name":"Nat","generics":[]}},"inputs":{"name":{"connections":[]},"type":{"connections":[]}},"outputs":{"value":{"connections":[{"node":1558,"input":"value","data":{}}]}},"position":[-32,-416],"name":"MainParameter"},"1215":{"id":1215,"data":{"name":"callerBalance"},"inputs":{"name":{"connections":[]},"initialValue":{"connections":[{"node":1234,"output":"result","data":{}}]},"before":{"connections":[{"node":1034,"output":"body","data":{}}]}},"outputs":{"after":{"connections":[{"node":1237,"input":"before","data":{}}]},"value":{"connections":[{"node":1346,"input":"left","data":{}},{"node":1333,"input":"left","data":{}}]}},"position":[672,352],"name":"Variable"},"1217":{"id":1217,"data":{"functionNode":740},"inputs":{"args":{"connections":[{"node":1034,"output":"caller","data":{}}]},"before":{"connections":[]}},"outputs":{"after":{"connections":[]},"value":{"connections":[{"node":1234,"input":"input","data":{}}]}},"position":[224,416],"name":"FunctionCall"},"1234":{"id":1234,"data":{},"inputs":{"input":{"connections":[{"node":1217,"output":"value","data":{}}]}},"outputs":{"result":{"connections":[{"node":1215,"input":"initialValue","data":{}}]}},"position":[448,416],"name":"Await"},"1237":{"id":1237,"data":{},"inputs":{"condition":{"connections":[{"node":1346,"output":"result","data":{}}]},"before":{"connections":[{"node":1215,"output":"after","data":{}}]}},"outputs":{"trueCase":{"connections":[{"node":1341,"input":"statement","data":{}}]},"falseCase":{"connections":[{"node":1310,"input":"before","data":{}}]},"after":{"connections":[]}},"position":[1152,352],"name":"Conditional"},"1310":{"id":1310,"data":{},"inputs":{"map":{"connections":[{"node":1311,"output":"value","data":{}}]},"key":{"connections":[{"node":1034,"output":"caller","data":{}}]},"value":{"connections":[{"node":1333,"output":"result","data":{}}]},"before":{"connections":[{"node":1237,"output":"falseCase","data":{}}]}},"outputs":{"after":{"connections":[{"node":1334,"input":"before","data":{}}]}},"position":[1376,544],"name":"MapPut"},"1311":{"id":1311,"data":{"stateNode":1030},"inputs":{},"outputs":{"value":{"connections":[{"node":1310,"input":"map","data":{}},{"node":1334,"input":"map","data":{}}]}},"position":[1152,576],"name":"StateRead"},"1333":{"id":1333,"data":{},"inputs":{"left":{"connections":[{"node":1215,"output":"value","data":{}}]},"right":{"connections":[{"node":1035,"output":"value","data":{}}]}},"outputs":{"result":{"connections":[{"node":1310,"input":"value","data":{}}]}},"position":[1152,672],"name":"Subtract"},"1334":{"id":1334,"data":{},"inputs":{"map":{"connections":[{"node":1311,"output":"value","data":{}}]},"key":{"connections":[{"node":1345,"output":"value","data":{}}]},"value":{"connections":[{"node":1337,"output":"result","data":{}}]},"before":{"connections":[{"node":1310,"output":"after","data":{}}]}},"outputs":{"after":{"connections":[{"node":1343,"input":"statement","data":{}}]}},"position":[1376,736],"name":"MapPut"},"1335":{"id":1335,"data":{"type":{"name":"Principal","generics":[]},"name":"mintAddress"},"inputs":{"name":{"connections":[]},"type":{"connections":[]}},"outputs":{"value":{"connections":[{"node":1558,"input":"key","data":{}}]}},"position":[-32,-608],"name":"MainParameter"},"1337":{"id":1337,"data":{},"inputs":{"left":{"connections":[{"node":1035,"output":"value","data":{}}]},"right":{"connections":[{"node":1340,"output":"result","data":{}}]}},"outputs":{"result":{"connections":[{"node":1334,"input":"value","data":{}}]}},"position":[1152,848],"name":"Add"},"1338":{"id":1338,"data":{"functionNode":740},"inputs":{"args":{"connections":[{"node":1345,"output":"value","data":{}}]},"before":{"connections":[]}},"outputs":{"after":{"connections":[]},"value":{"connections":[{"node":1340,"input":"input","data":{}}]}},"position":[448,896],"name":"FunctionCall"},"1340":{"id":1340,"data":{},"inputs":{"input":{"connections":[{"node":1338,"output":"value","data":{}}]}},"outputs":{"result":{"connections":[{"node":1337,"input":"right","data":{}}]}},"position":[672,896],"name":"Await"},"1341":{"id":1341,"data":{},"inputs":{"value":{"connections":[{"node":1342,"output":"value","data":{}}]},"statement":{"connections":[{"node":1237,"output":"trueCase","data":{}}]}},"outputs":{},"position":[1600,352],"name":"Return"},"1342":{"id":1342,"data":{"value":false},"inputs":{},"outputs":{"value":{"connections":[{"node":1341,"input":"value","data":{}}]}},"position":[1600,448],"name":"LiteralBool"},"1343":{"id":1343,"data":{},"inputs":{"value":{"connections":[{"node":1344,"output":"value","data":{}}]},"statement":{"connections":[{"node":1334,"output":"after","data":{}}]}},"outputs":{},"position":[1600,736],"name":"Return"},"1344":{"id":1344,"data":{"value":true},"inputs":{},"outputs":{"value":{"connections":[{"node":1343,"input":"value","data":{}}]}},"position":[1600,832],"name":"LiteralBool"},"1345":{"id":1345,"data":{"name":"receiver","type":{"name":"Principal","generics":[]}},"inputs":{"name":{"connections":[]},"type":{"connections":[]},"param":{"connections":[{"node":1034,"output":"params","data":{}}]}},"outputs":{"value":{"connections":[{"node":1334,"input":"key","data":{}},{"node":1338,"input":"args","data":{}}]}},"position":[224,736],"name":"Parameter"},"1346":{"id":1346,"data":{},"inputs":{"left":{"connections":[{"node":1215,"output":"value","data":{}}]},"right":{"connections":[{"node":1035,"output":"value","data":{}}]}},"outputs":{"result":{"connections":[{"node":1237,"input":"condition","data":{}}]}},"position":[928,384],"name":"CompareLess"},"1378":{"id":1378,"data":{"widthPixels":1868,"heightPixels":745},"inputs":{},"outputs":{},"position":[-64,320],"name":"CommentRegion"},"1379":{"id":1379,"data":{"widthPixels":1176,"heightPixels":333},"inputs":{},"outputs":{},"position":[-64,-128],"name":"CommentRegion"},"1380":{"id":1380,"data":{"widthPixels":242,"heightPixels":398},"inputs":{},"outputs":{},"position":[-64,-640],"name":"CommentRegion"},"1381":{"id":1381,"data":{"widthPixels":768,"heightPixels":447},"inputs":{},"outputs":{},"position":[304,-688],"name":"CommentRegion"},"1558":{"id":1558,"data":{},"inputs":{"map":{"connections":[{"node":1030,"output":"value","data":{}}]},"key":{"connections":[{"node":1335,"output":"value","data":{}}]},"value":{"connections":[{"node":1184,"output":"value","data":{}}]},"before":{"connections":[{"node":1030,"output":"setup","data":{}}]}},"outputs":{"after":{"connections":[]}},"position":[832,-416],"name":"MapPut"},"1704":{"id":1704,"data":{"widthPixels":795,"text":"Create a HashMap to store token balances, and mint based on the smart contract configuration."},"inputs":{},"outputs":{},"position":[304,-736],"name":"Comment"},"1779":{"id":1779,"data":{"widthPixels":257,"text":"Smart contract configuration"},"inputs":{},"outputs":{},"position":[-64,-688],"name":"Comment"},"1780":{"id":1780,"data":{"widthPixels":300,"text":"Return the balance of a given user."},"inputs":{},"outputs":{},"position":[-64,-176],"name":"Comment"},"1781":{"id":1781,"data":{"widthPixels":291,"text":"Send tokens to the specified user."},"inputs":{},"outputs":{},"position":[-64,272],"name":"Comment"},"1782":{"id":1782,"data":{"widthPixels":300,"text":"Get the receiver's current balance"},"inputs":{},"outputs":{},"position":[448,848],"name":"Comment"},"1783":{"id":1783,"data":{"widthPixels":278,"text":"Get the caller's current balance"},"inputs":{},"outputs":{},"position":[224,368],"name":"Comment"}}}